"git add" the result.
(e.g. const modifier)
/ASSEMBLYLINKRESOURCE
A C++ class template.
A C++ using directive
A continue statement.
Cleaning up resources
Convenience Functions
Custom Nuclide fields
Default parsing mode.
Detach/Kill inferior.
Execute the API dumps
Fixup path as in (1).
Get cert, key and ca.
Get rid of '.ca.key'.
Make file executable.
No quoting necessary.
Output nodes by file.
Parenthesized operand
Positional arguments.
Resolve dynamic type.
Return the file path.
Run a specific CI job
Run specified CI jobs
Same for environment.
Something went wrong.
Start Nuclide server.
Targets that matched.
Test on valid dbPath.
That's probably fine.
URLs can be long too.
Unmatched parenthesis
Update pp_stack first
Used with /Yc and /Yu
Variables and fields.
We have a sub-filter.
Write out rules file.
add_dependent_modules
cross-reference text.
different indentation
endif is not allowed.
exclude function body
name() returned None.
rest of operator name
see chan.c chanbuf().
strip trailing spaces
/ASSEMBLYDEBUG:DISABLE
/CLRUNMANAGEDCODECHECK
/FORCE /FORCE:MULTIPLE
1 means line-buffered.
Add -F / -I arguments.
Add disabled warnings.
C++'s catch statement.
CMakeList multi-source
Check for those first.
Collect the submodules
Configure the options.
Convert it to a string
Create a source entry.
Create sources target.
GYP generated outputs.
Generate each project.
Generate the .xml file
Give everything an ID.
Look for dependencies.
Module class and name.
No server on port 9092
Scan the previous line
Some more style checks
Some unused variables.
Tests for a bug in PHP
The rest of the tokens
The short X.Y version.
Unnecessary semicolon.
a ( used for a fn call
already did old bucket
broken on ubuntu 12.04
endif is non-standard.
generic parameter list
if not a blank line...
int(pc) will not work.
must be brace after if
now try public headers
php coderz are so l33t
search_bucket(key, b).
/CLRTHREADATTRIBUTE:MTA
/CLRTHREADATTRIBUTE:STA
A C++ using declaration
Add it to the makefile.
Add to new_target_list.
An enumerator constant.
Bucket targets by file.
CMakeList single-source
Cache values for speed.
Call these "gyp paths".
Chrome lines start at 0
Default encoding UTF-8.
Determine if different.
Dump upto max_keys rows
GUIDs for project types
Get the current vmfp().
Hierarchical recursion.
No member of that name.
Non-relational operator
Only need HKLM for now.
ProductGroup is strong.
Pull the function name.
Return the diagnostics.
Set configuration type.
So, instead of doing...
Sort the groups nicely.
SortGroup is recursive.
Split into (path,file).
Suppress nohup logging.
There currently aren't.
Try matching cases 2-3.
Try matching cases 4-6.
backpointer for logging
dicts are never strong.
different indentation')
function parameter list
/CLRTHREADATTRIBUTE:NONE
A C++ function template.
Add precompile if needed
Add to new_target_dicts.
Avoid preprocessor lines
Clean up old core dumps.
Create folder hierarchy.
Don't include extension.
First, some definitions:
Got some other operator.
Here are the categories.
It has changed, write it
Object output directory.
Only use xcrun on Darwin
Pop the stack for these.
Pull in the Swift lexers
Remove duplicate entries
Skip if visited already.
The cheap and easy case.
The link already exists.
The log directory exists
The paths were the same.
Unparenthesized operand.
Update the dependencies.
Warn of ignored settings
Write workspace to file.
main.swift run functions
print(self) print(other)
the number of processors
try to do relative paths
Add the path to the dict.
An unknown error occurred
Change strings into bits.
Configurations (variants)
Continue scanning forward
Detect the C++ extension.
Don't leave turds behind.
Dump the top-level module
Enable v3_req extensions.
Extensions to the recipe.
Filter out empty strings.
Find opening parenthesis.
Flatten lists to strings.
Let's just warn the user.
Logical and/or operators.
Match start of namespace.
Or changing the location.
Others, too many to sort.
Output name and location.
Populate all the folders.
Query for the line table.
Regular expression match.
Resume and hit next stop.
Set the bounds of the TC.
Set up the root symlinks.
Take N+1 and reduce to 1.
Tell IDE server is ready.
That list is stored here.
The multiprocessing pool.
The name of the builddir.
Throw something if False.
Weird, but matches Xcode.
Write the actual command.
a new process can crop up
flaky for various reasons
lldb.eTypeClassReference,
size is itself an uintptr
skip irrelevant protocols
within class or namespace
.csr file is intermediate.
/SUBSYSTEM:EFI_APPLICATION
A C++ conversion function.
A Objective-C dynamic decl
Actual conversion gives ''
Add extra rules as in (2).
Add in this configuration.
Add in tool files (rules).
Add rules file to project.
Continue scanning backward
Copyright 2013 Google Inc.
Dump the async stacktrace.
Expanding in list context.
Find the previous operator
Generate other file names.
Ignore control structures.
In 2.6, md5 is deprecated.
In 2.6, sha is deprecated.
No copy is necessary here.
On success, return stdout.
Open file and print header
Pack bits into an integer.
Prefer arm64 if available.
Pull out the relevnt data.
Queue of targets to visit.
Read stdout from inferior.
Set up the ownership link.
Skip if previously visted.
So put it in LOCAL_CFLAGS.
The source can't be found.
The source directory tree.
Try matching case 1 first.
Try to find an instance of
Turn off WinRT compilation
Visual Studio 2010 has TR1
We convert to a dict here.
not implemented extensions
perhaps from os.urandom(4)
A subset of target_outputs.
An indirect goto statement.
Build up a list of outputs.
Cache the libclang version.
Default debug modes for GYP
Delete the old filter file.
Don't setup_env every time.
First filter out pipelines.
If port is given, match it.
Ignore non-stopping events.
Look at this configuration.
Normalize paths everywhere.
Port is an optional filter.
Prefer arguments from JSON.
Prepare the actual command.
See XCObject._EncodeString.
Set up the Current version.
Some use of built-in names.
Split up the double braces.
The base command is python.
These are incorrect values:
This is set by --root flag.
Verify the new common name.
We don't know how to merge.
We don't know this setting.
first check private headers
include line for all source
non-existing column family.
same file, in between lines
spews files until they work
wait for logs to be written
17.6.1.2 C++ library headers
A C++ access specifier decl.
Add "mac_framework_headers".
Add header and write it out.
Add run_as and test targets.
Add the filter to the group.
An Objective-C class method.
An array of BMP data blocks.
An imaginary number literal.
Assign that to 'comm' field.
C++'s for (* : *) statement.
Check matching closing brace
Comma not followed by space.
Doesn't generate .o.d files.
Ex: BUILD_STATIC_LIBRARY vs.
Expanding in string context.
Explicitly absolutify these.
FIXME Support slice objects.
Find the most recent join().
Find the test targets first.
Force app to exit on Ctrl-C.
Found matching angle bracket
Get the number of attributes
Group the processes by port.
Header of toplevel Makefile.
I'm just scared for my life.
Ignore unhandled extensions.
Include the optional message
Indent and print the output.
Inside inline assembly block
Instead just save them up...
Match a list of code points.
Merge in the included files.
Not entering assembly block.
Objective-c Boolean Literal.
See LICENSE.TXT for details.
Self references are ignored.
Set up the dependency links.
Skip over nonexistent types.
Solution build configuration
Standard package.json fields
They are ignored by default.
check how the old one exited
old bucket not evacuated yet
utils/profdata_merge/main.py
/LIBPATH /MANIFESTDEPENDENCY:
/SUBSYSTEM:EFI_RUNTIME_DRIVER
A C++ template type parameter
A Objective-C synthesize decl
Access to a protected member.
Add gyp/gypi files to project
Add or get a PBXVariantGroup.
An array of supp data blocks.
Cannot find a pretty printer.
Collapse settings with lists.
Determine the default target.
Do not parse function bodies.
Example: "main.cc in Sources"
Find reference to base class.
Force ninja to use rsp files.
Function/method cursor kinds.
Generator-specific gyp specs.
Get rid of the leading colon.
If asked to recurse, recurse.
Include template information.
Left over Closure class names
Libs can have multiple words.
List processes for all users.
Make Windows paths like Unix.
Merge it into the new config.
Names of function parameters.
Names of template parameters.
Not exception type specified.
Raw string ended on same line
Recurse into subdictionaries.
Set Subject Alternative Name.
Stop existing Nuclide server.
TODO: make this configurable.
Tell parent channel is ready.
The encoding of source files.
This doesn't catch all cases.
This gets expanded by Python.
This is just here to clarify.
Try to find a direct subclass
Try to get the function name.
Validate build_file extension
We want to fix up these paths
hex has invalid boolean value
segfaults on contbuild in opt
- _NamespaceInfo: a namespace.
A minimal memoizing decorator.
Add all the files to the queue
Add attributes to root element
Add or get a PBXFileReference.
Both spellings are acceptable:
CompletionChunk.Kind("Colon"),
CompletionChunk.Kind("Equal"),
Copyright (c) 2009 Google Inc.
Copyright (c) 2011 Google Inc.
Copyright (c) 2012 Google Inc.
Copyright (c) 2013 Google Inc.
Detect variable-length arrays.
Emulate this behavior for mac.
Grab make settings for CC/CXX.
It depends on the copy target.
It does, however, keep a name.
List processes from all users.
Make sure it's not a function.
Mode 0 covers all kill points.
Must be one of the open ports.
No need to generate a .o file.
None is a synonym for 'store'.
Parse JSON into python object.
Red links are a bit too garish
Represents a unary expression.
Return a list of process info.
Root targets across all files.
See -h output for instructions
See comment a few lines above.
Should be coupled with do_cmd.
Skip if not a nuclide package.
Skip symbols from other files.
Stack for tracking all braces.
Structures and Utility Classes
Test Subject Alternative Name.
That means this has two tasks:
The path of last found header.
Then yield the thing we found.
They're implemented on demand.
They're products, not sources.
o expose code completion APIs.
segfaults also print on stderr
this should start a new server
time to stabilize after a kill
"ls" sometimes prints on stderr
3) They are part of "make all".
A function or method parameter.
A line describing a dependency.
Add the config to the file node
Also pop these stack for these.
An Objective-C instance method.
Call these paths "ninja paths".
Collapse into a single command.
Convert to folders recursively.
Convert to proper windows form.
Create object for this project.
Decide the guid of the project.
Default to Win32 for platforms.
Determine the output idirectory
Do the same kind of validation.
Dump and load with WAL disabled
Else returns whether x is in l.
Expand the rules into a matrix.
Expecting closing angle bracket
Expecting opening angle bracket
Find standard gyp include dirs.
Find the starting native frame.
Generate certificate authority.
Grab the existing certificates.
Make a target to run something.
Make supports multiple toolsets
Make sure we order by priority.
Now drop all the abstract ones.
Populated lazily by _SdkPath().
Recurse and add its dependents.
Return version if it is cached.
Save last 100 logs into buffer.
Suffix rules for source folder.
TODO: really support workspace.
That's why the double () below.
The suffix of source filenames.
This has bitten us in the past.
This test passes "by accident".
Verify workspace gets resolved.
Wait from response from client.
Whitelist "lib" subdirectories.
get rid of comments and strings
gypd supports multiple toolsets
ifndef header guard is present.
python3 / newer versions of gdb
target is the qualified target.
these all write to temp3.txt.gz
"/' Used when a value is quoted.
A floating point number literal.
A set of all intra-cluster edges
Add a folder for excluded files.
Add makefile to list of sources.
Allow comparison of these types.
Always add 'executable' targets.
Bump up the version for upgrade.
Client is initiating connection.
Find the upper bound for our PC.
Gather a list here to use later.
Gather list of unique platforms.
Include both possible locations.
Invoke the translation function.
Looks like an unnamed parameter.
Maps from target name to Target.
Mark object sources as linkable.
Matches multi-line C++ comments.
Need to add proper argument here
Not exactly the same as disable.
Note that Python sort is stable.
Outside of inline assembly block
Pattern to expect from SST dump.
Pattern to expect from WAL dump.
Pick where to stick this action.
Process conditions in this dict.
See explanation in WriteActions.
Sort results for fast filtering.
Split the paths into components.
Start of a multi-line raw string
The LLVM Compiler Infrastructure
The database could not be loaded
The name of the current section.
The numbers are Apple radar IDs.
Then filter out specific passes.
This list is expanded on demand.
Unpack the line table structure.
cause of failure uninvestigated:
duplicate of a test in test/slow
include "hphp/zend/html-table.h"
start_pattern not found in text.
str is treated as UTF-8-encoded.
works in interp but fails in JIT
* Neither the name of Google Inc.
Add in dependency-tracking rules.
An Objective-C instance variable.
AsioContexts are numbered from 1.
Bring such projects up one level.
Build and start the HTTP response
Builtins don't have source files.
But don't append empty tool node.
By convention, it's called "all".
Check if the // may be in quotes.
Clean up by restoring the backup.
Collapsing reduces this to m + n.
Collect all the run test targets.
Compute predepends for all rules.
Don't merge the 'Name' attribute.
Emit failure tag, and keep going.
Fix the filenames to be absolute.
Generators might not expect ints.
Get directory project file is in.
Get the name of the current node.
Load and normalize the manifests.
Missing in many other places too.
Note: OpenBSD has sysutils/flock.
Octal-encode to work around that.
Otherwise, skip version checking.
Prepare configuration attributes.
Print out the file paths in JSON.
Rehash required, so just give up.
Rules must be early like actions.
Run all postbuilds in a subshell.
Run kill mode 0, 1 and 2 by turn.
SLOW: check every pointer in town
Start a fresh server and monitor.
Stop once we receive the sentinel
TODO(tvl): Remove the below hack.
TODO: pass environment variables.
The allowed line length of files.
This is set by --linelength flag.
Try to find the end of the class.
Try to print out literal strings.
Used by SourceTreeAndPathFromPath
Wraps cindex.CodeCompletionResult
Write out a link step, if needed.
means no copyright line was found
missing undefined variable notice
see comment for identify-function
these tests use each other's data
this allows one level of nesting.
/SUBSYSTEM:EFI_BOOT_SERVICE_DRIVER
A C++ namespace alias declaration.
A C++ non-type template paramater.
A C++ template template parameter.
A reference to a type declaration.
ASM-ATT does not support .S files.
Add in the outputs from this rule.
BMP code points are 16-bit values.
Collect all of the framework names
CompletionChunk.Kind("LeftAngle"),
CompletionChunk.Kind("LeftBrace"),
CompletionChunk.Kind("LeftParen"),
CompletionChunk.Kind("SemiColon"),
Copyright (c) 2014, Facebook, Inc.
Copyright (c) 2015, Facebook, Inc.
Copyright (c) 2016, Facebook, Inc.
Count non-blank/non-comment lines.
Declarations and trivial functions
Default is the same as html_title.
Do not write out dependency files.
Dump the API for the given module.
Find all of the submodule imports.
Find the max width for each column
Frame opcodes defined in the spec.
Grab 'new' operator, if it's there
Gyp source paths are always posix.
Initialize random number generator
Keep this legacy behavior for now.
Last line of inline assembly block
MSBuild options not found in MSVS.
MSVS options not found in MSBuild.
Map from platform to architecture.
Objective-C's protocol expression.
Open the vcproj and parse the xml.
Prepare the set of configurations.
Random other files that zend wants
Remove "// XFAIL: whatever" lines.
See nuclide_server.py for details.
Select a name for the output file.
Treat as primitive build-in types.
Try to start Nuclide server again.
Using PHP7 versions of these tests
We don't need this filter anymore.
We first sort by name, if present.
don't use the internet in tests...
max_keys is not applicable for put
variable expansion may lead to //.
with WorkingDirectory('/tmp'): ...
A labelled statement in a function.
A reference to a labeled statement.
Actions cd into the base directory.
Add in 'action' inputs and outputs.
Add in 'copies' inputs and outputs.
Add tool nodes and their attributes
Adds the link flags for extensions.
Collect the output dirs we'll need.
CompletionChunk.Kind("RightAngle"),
CompletionChunk.Kind("RightBrace"),
CompletionChunk.Kind("RightParen"),
Condensed ISO-8601 date/time format
Create the name of that sub-filter.
First create XML content definition
Fully qualify all dependency links.
Generate version file for the mock.
Look for beginning of a raw string.
MSVS and MBuild names of the tools.
PHP puts a newline in that we don't
Put it into a dict for easy access.
Recurse, making a copy of the list.
Remove the oldest core dumps first.
Represents a C11 generic selection.
Stack of _PreprocessorInfo objects.
TODO(mark): I don't love this name.
The last line of a dependency list.
The last segment looks like a path.
The same, but for run_test_targets.
This class manages Nuclide servers.
Used to keep flaky tests in flaky/.
We swallow that output with a pipe.
Wraps cindex.CodeCompletionResults.
`SBError.success` denotes no error.
control frames cannot be fragmented
int(V('folly::kMaxVarintLength64'))
lockf seems to be FreeBSD specific.
offset between Unix and LLVM epochs
operator++(int) and operator--(int)
read source, stripping all comments
A dictionary of settings converters.
Add a build action to call makefile.
Add in user specified msvs_settings.
All projects, their clsid and paths.
An expression that calls a function.
Attempting to unpack a non-sequence.
C++ apps need to be linked with g++.
Check if the line is a header guard.
CompletionChunk.Kind("LeftBracket"),
Define how each output is generated.
Dictionaries of settings validators.
Don't even pull these into the repo.
Dump only a portion of the key range
For marking tests as always failing.
If it's already a list, make a copy.
Include the inputs from any actions.
Pick a random version to start with.
Pluck out the default configuration.
Scan for includes and merge them in.
Set of non-empty short target names.
TODO: This should not be hard coded.
TODO: log the error to analytics db.
Tests that work but not in repo mode
Tests use banned reflection features
That is, it doesn't merge the trees.
The first line of a dependency list.
The make generator does this always.
This check duplicates that behavior.
Try a bit harder to catch this case.
VS recognized '' for this value too.
Weird output rules for PBXBuildFile.
Wrong length resets everything, too.
does not wait for process to launch.
don't replace single quotes in attrs
sentinel node for doubly linked list
/u MSBuild options not found in MSVS.
A text node does not have properties.
Cast to string from possible unicode.
Clean up bad processes and old files.
CompletionChunk.Kind("RightBracket"),
Concatenate back into a single string
Consider (const char * const)"hello".
Convert into a tree of dicts on path.
Copyright (c) 2009 Raymond Hettinger.
Count the number of queued runnables.
Each WaitHandle has its own states...
Expand macros in all_system_includes.
Find compiler's default include dirs.
For each dependencies in this project
For now we do not warn for this case.
From SCons, not done in google style.
Hack is 1-indexed, py lists 0-indexed
If it's a string, append a text node.
Ignore pointers/references to arrays.
Inside a raw string, look for the end
Matched closing parenthesis (case 1).
Otherwise, the standard x86 compiler.
Overwrite the existing value, if any.
Pattern to expect from manifest_dump.
Populated lazily by GetIOSPostbuilds.
Prepare for the next match iteration.
Print the server port on lldb import.
Put sources_to_index in it's own gyp.
So we need to produce 2n backslashes.
The Products group is a special case.
The attribute exist in the main node.
The child was relative to its parent.
The unique kind objects, index by id.
There is no Express edition for 2015.
This is filed as Apple radar 6588391.
This is not infinite-recursion proof.
This is the sort order used by Xcode.
This method is a little bit esoteric.
Verify same cert files after restart.
We'll say it should occur by line 10.
Write out actions, rules, and copies.
Xcode uses variants for localization.
check if we have exactly 1 parameter.
conscious decision not to match these
hh should should work with 0 retries.
(Also in the printed Python Cookbook.)
Accept unicode where str is specified.
An error code has been sent, just exit
An inherited dict maps keys to values.
Assume to be Facebook linux devserver.
Checks passed, perform the assignment.
Commands for precompiled header files.
Copyright 2015-present, Facebook, Inc.
Determine which targets need shimming.
Do expansions on the condition itself.
Dump anything with action 0 (exclude).
Extra functions from the libclang API.
FIXME: Document this assertion in API.
First write out a rule for the action.
Functions strictly alphabetical order.
General information about the project.
Get defines declared in the gyp files.
Get the protocol version of the build.
Insert the nodes in the correct order.
Instantiate the various generic types.
Mark uncompiled sources as uncompiled.
Move the test over to the fixed suite.
Needed by test/mac/gyptest-rebuild.py.
Number of bits in the biggest int type
Print invalid JSON requests to stderr.
Processes toolsets in all the targets.
Search python binding with heuristics.
See PBXTargetDependency._schema above.
Send the test certs files to temp dir.
Set the module definition file if any.
Support a mode for using cmd directly.
TODO: Client common name is 'nuclide'.
TODO: More general variable expansion.
The Nuclide server process is running.
The last line of a project definition.
The main benchmark emits its own line.
The remaining methods are order-aware.
Then write out an edge using the rule.
There is nothing we can do about this.
Write logs to file using file handler.
Write out the sorted list of includes.
extra random files needed for tests...
it references a whole directory with *
must have clang, clang++, and llvm-cov
see if we need to inject a line marker
time for one db_stress instance to run
x and y are PBXReferenceProxy objects.
- _BlockInfo: some other type of block.
A GNU-style inline assembler statement.
A parenthesized expression, e.g. "(1)".
Add the run target to the project file.
An array of second-level lookup tables.
Copyright (c) 2011 The LevelDB Authors.
Count sleep and external thread events.
Describes an C or C++ initializer list.
Do not check those function parameters.
Exclude anything in BUILT_PRODUCTS_DIR.
For the next half, try different modes.
Found an operator, update nesting stack
If false, no module index is generated.
If new operator, then this isn't a cast
Link as 'C' if there are no other files
NOTE: gyp paths are always posix style.
Nothing to add Write out the user file.
Objective-C's for collection statement.
Only "grammars" are allowed to be cson.
Otherwise just show executable targets.
Passed all filters, issue warning here.
Prepare the command line for this rule.
Read the source Info.plist into memory.
Represents the "this" expression in C++
Set the variable to the supplied value.
Should also be removed once upstreamed.
So we need to produce 2n+1 backslashes.
TODO: This is a workaround for testing.
The cwd is the current build directory.
The first line of a project definition.
The unique kind objects, indexed by id.
Tool name mapping from MSVS to MSBuild.
Turn on import libraries if appropriate
Use source file name to set breakpoint.
Verify against the test process itself.
Xcode seems to choose based on content.
build_file_dir may be None (see above).
kill the parent process we forked from.
line number where we started tokenizing
regex pattern for matching common name.
use '.' in case relative_path is empty.
"noqa" is used to suppress this warning.
(period), and _ (underscore) is present.
A map of Domain names to HandlerDomains.
Add all concrete outputs to the project.
Add excluded items to the excluded list.
Complain if this target is already used.
Does not apply to projects, only folders
Don't just insert everything at index 0.
From http://stackoverflow.com/a/1160227.
Gather stuff needed to emit all: target.
Get Nuclide server process info from ps.
Hence, some targets use copies for this.
Here, we will look at possible includes.
I wish Xcode handled this automatically.
Ignore errors if the file doesn't exist.
Ignore pointers/references to functions.
It can be run with either Python 2 or 3.
It will raise an exception if not valid.
List of precompiled header related keys.
Make sure the property is in the schema.
Modify all files after the primary file.
Notify all children of their new parent.
ObjCEncodeExpr, used for in Objective-C.
Operator not preceded/followed by space.
Python library objects follow this rule.
Register all the *Printer classes above.
Relative path from build dir to gyp dir.
Relative path from build dir to top dir.
Rule sources are direct inputs to rules.
Store DEPTH for later use in generators.
Suffix rules for generated source files.
That would be considered invalid anyway.
Then when it gets merged kill your hack.
They are meaningless for type mh_bundle.
Try building from generated source, too.
Update global list of link dependencies.
We only want to warn on the latter case.
Weird output rules for PBXFileReference.
Write a short name to build this target.
Write out the compilation steps, if any.
get commands for the CI job determinator
operator definition up to the open brace
stylistic only - omitting the "./" works
the gcov report follows certain pattern.
A MS inline assembly statement extension.
Absolute paths are in dstSubfolderSpec 0.
Add configuration node and its attributes
After the framework is built, package it.
Android NDK requires a strict link order.
Be consistent with the main Nuclide logs.
Compilation flags often contain symlinks.
Convert to folders and the right slashes.
Copy passed lists (or set to empty lists)
Delegate everything else to self.tmp_file
Directory all our build output goes into.
Display types for variables and typedefs.
FIXME: redeclaring qux.php is unnecessary
Find cygwin style versions of some paths.
First yield any literal we've accumulated
Flags to make gcc output dependency info.
Handle external rules (non-native rules).
Indicates that an unknown error occurred.
It is specific to each build environment.
It's going to be created below if needed.
Make a fake frame for our `fp' and `rip'.
Make sources relative to root build file.
ObjCSelectorExpr used for in Objective-C.
Only create PkgInfo for executable types.
Populated lazily by GetExtraPlistItems().
Prepare a key like 'path/to:target_name'.
Relative path from base dir to build dir.
Results must be pre-sorted by typed_name.
Reuse global functions from make backend.
Save __children__ from the local bindings
Server may take some time to kill itself.
Skip a rule with no action and no inputs.
Specify the filter it is part of, if any.
TODO: Verify test_name and iters_computed
Take the output of lit as standard input.
The code point value is split as follows:
The default state of the category filter.
These are filled in on a as-needed basis.
absorb one trailing newline Substitutions
allow to manually reload while developing
hack: retrieve underlying results pointer
literals and symbols get batched together
look inside the parens for function calls
normal run with universal compaction mode
special options for all files in this dir
this sometimes happens and retrying helps
we don't care about nonzero exit codes...
we expect zero retncode if no kill option
/l arg must be in hex without leading '0x'
/robust MSBuild options not found in MSVS.
/verbose Options that have moved location.
@lint-avoid-python-3-compatibility-imports
Adds the appropriate environment variable.
Alternative tokens and their replacements.
Atom 1.5.3 for sure, maybe later ones too:
Check the map using a lowercase extension.
Copyright (c) 2011-present, Facebook, Inc.
Copyright (c) 2015-present, Facebook, Inc.
Done if not processing outputs as sources.
Exclude excluded sources from being built.
Find the end of the conditional expression
G will be non-null if any postbuild fails.
Get the information for this configuration
Handle rules that use a native rules file.
If no existing servers, find an open port.
Make sure the actions and rules run first.
Many tests include modules they don't use.
Most callers probably want GetChildByPath.
Objective-C's autorealease pool statement.
Order only rule: Just write a simple rule.
Prepare the list of tools as a dictionary.
Push a new block onto the stack otherwise.
Redirect stdout to a stream for capturing.
Rename the new file to the permanent name.
Set project toolset if any (MS build only)
Shared libraries are already fully linked.
TODO(mark): This isn't completely correct.
TODO: handle other breakpoint event types.
Tell Xcode to look everywhere for headers.
The Nuclide server is healthy and running.
The Totals line would be parsed like this.
The msvs specific sections that hold paths
The name for this set of Sphinx documents.
Turn it back into a string and we're done.
Update target_dicts for iOS device builds.
Use FORCE_DO_CMD to force a target to run.
Use project filename if name not specified
We can't access `mcg' for whatever reason.
We categorize each error message we print.
We don't add the "_excluded_files" filter.
Write out per-gyp (sub-project) Makefiles.
Xcode is weird about remoteGlobalIDString.
add output line after this line to fix bug
aix and solaris just need flock emulation.
force each merge worker to gracefully exit
http://python3porting.com/differences.html
line number of the token in the whole text
make sure 'i' is set if when 'ba' is empty
should have been checked for in SetFilter.
substitute local variables into the string
to resolve to and empty list if undefined.
yield until we get the first header's byte
(Possibly external) members of CLASS_KINDS.
A few keys that we don't want to propagate.
A file must be specified when using --list.
A linkage specification, e.g. 'extern "C"'.
Add the information to the appropriate tool
Cache code completion information on parse.
Calculate the population standard deviation
Compiled XIB files are referred to by .nib.
Compute an rpath for this output if needed.
Converts a Clang `SourceRange` into a dict.
Don't write postbuilds for target's output.
Find cl.exe location for this architecture.
Find the position to start extracting text.
Finds occurrences of NOLINT or NOLINT(...).
First write out a rule for the rule action.
For static libraries, no dSYMs are created.
Get default compiler defines (if possible).
Handle dependent settings of various types.
If this is a folder, check its entries too.
Leave output alone if it's a list of lists.
Look through all the nodes to find a match.
Make sure our dependencies are built first.
Make sure rule_sources isn't already there.
Only write the lists if they are non-empty.
Our root_makefile lives at the source root.
Preserve current xml.dom.minidom functions.
Python generators must be initialized once.
Recompute target "dependencies" properties.
Recurse to expand variables in the contents
Redefine the type of the "target" property.
Set up the logging early on in the process.
Similarly, this type of code causes issues:
Swift_Programming_Language/Expressions.html
TODO: Keep track of the line number as well
These are always matched on separate lines.
This is intended to be used very sparingly.
Turn on precompiled headers if appropriate.
We don't want such lists to be stringified.
We'll only move things we want into 'good'.
Write out the file with variables replaced.
Yield until we get the second header's byte
check_ouput is not available in Python 2.6.
delayed import to break circular dependency
line is a bytes string literal in Python 3.
we shouldn't include a file more than once.
A C++ class template partial specialization.
Add dependency from bundle to bundle binary.
Also ignore things that look like operators.
Bundle all of the above together, if needed.
CFLAGS et al overrides must be target-local.
Collect the set of frameworks we should dump
Default to 2005 if we couldn't find anything
Don't declare any inputPaths or outputPaths.
Don't warn on function pointer declarations.
Dump command fails because of typo in params
FIXME: Expose iteration from CIndex, PR6125.
Grab the clusters with more than one member.
Group multiple nodes together in a subgraph.
Grouping the document tree into LaTeX files.
If the common names don't match, we restart.
If we were given an explicit name, use that.
If x is hashable, returns whether x is in s.
It's best when the caller provides the path.
It's handled in LoadTargetBuildFileCallback.
Many unit tests use cout, so we exempt them.
Map from qualified target to path to output.
Merge with stdout if stderr isn't specified.
Minor version is the server protocol version
Ninja prefers paths to be known at gyp time.
Not very inspired, but it's what Xcode uses.
Only the original parent has a path, use it.
Otherwise recurse over that child definition
Pass in proc for an existing Nuclide server.
Path to the output of the link step, if any.
Prepare a flat lookup table for fast access.
Print out the command we're about to execute
Python doesn't like os.open('.'): no fchdir.
Read version from version file if it exists.
Record any of the cursor types listed above.
Register callback types in common container.
Rely on exception handling to report errors.
Resume tokenizing after the end of the code.
TODO: Remove it after migration is complete.
Test with multiple manifest files in dbPath.
The Xcode-specific sections that hold paths.
The only differences are the last two parts.
The paper size ('letterpaper' or 'a4paper').
This is typically used when parsing headers.
Try to import, perhaps the paths are set up.
Verify workspace gets resolved to real path.
Xcode adds the product directory by default.
argv will contain the path to the executable
o API support for invalid translation units.
re objects used by EncodePOSIXShellArgument.
run with kill_random_test, with three modes.
total time for this script to test db_stress
17.6.1.2 C++ headers for C library facilities
A list of types that are treated as linkable.
Add prefix "user.nuclide" to avoid collision.
Add the custom build step for one input file.
Also skip checks if we are on the first line.
Client is not yet ready to process next token
Create a DependencyGraphNode for each target.
Currently, only 'pymod_do_main' is supported.
Default core dump location on Linux machines.
Define a dir function that can handle spaces.
Detects errors in Nuclide pacakge.json files.
Directives for converting VCMIDLTool to Midl.
Don't warn on any kind of template arguments.
FIXME: There should just be an isNull method.
FIXME: sil-opt does not have the '-F' option.
However they are found in CL and other tools.
If the variable is already set, don't set it.
If we get no tokens, no memory was allocated.
Installable target aliases are created below.
LOCAL_CFLAGS is applied to both of C and C++.
Let the later compile() call report the error
Look for the project name matching this cldis
Make does not supports '.xcassets' emulation.
Map of android build system variables to set.
Mapping from Xcode product-types to settings.
Next, deduplicate second-level lookup tables.
Now split the path into (prefix,maybe.lproj).
Parse the JSON to extract the commands to run
Prepare list of sources and excluded sources.
Print logs to stdout if verbose is specified.
Process the input specific to this generator.
Project build config for that solution config
Reduces the cpu time usage by skipping lines.
Split on newlines and filter out empty lines.
Stop in a line with all expressions in scope.
Swift documentation build configuration file.
TODO fix quoting for qualified variable names
TODO(hansonw): remove when this is upstreamed
TODO(jeanluc) File a bug to get rid of runas.
TODO: In this case, it depends on the target.
The mapping is 0: default, 1: false, 2: true.
This list is not exhaustive, but that's okay.
This must check the unexpanded includes list:
This needs to be overridden in child classes.
Those codes are reserved or plainly forbidden
We write the file in the base_path directory.
WriteDoCmd() will escape spaces for .d files.
add an output line after this line to fix bug
dSYMs need to build before stripping happens.
ibtool sometimes crashes with relative paths.
line number is inconsistent on stack overflow
msbuild does not accept an empty folder_name.
noqa (N802 function name should be lowercase)
A reference to a namespace or namepsace alias.
Always include targets matching target_extras.
An expression that represents a block literal.
Another process can be created in the meantime
Capture these now so we can adjust them later.
Change all dependencies clsid to name instead.
Clang indexes for line and column are 1-based.
Combine the rest tokens into the full command.
Converts a Clang `SourceLocation` into a dict.
Create an intermediate file based on the path.
Do nothing if there was no precompiled source.
Don't see a whitelisted function on this line.
Dump resources to files and set up mock files.
Enable core dump by change ulimit to infinity.
Enable project in this solution configuration.
Execute swift-ide-test to print the interface.
Expand dependencies specified as build_file:*.
Generate a list that has all the include dirs.
I'm not quite sure what :standardizepath does.
If this entry has been visited, nothing to do.
Let gyp-time envvars win over global settings.
Let make it concurrent for others to tag along
Let's avoid unmasking when there is no payload
Look for matching comment at end of namespace.
Make sure the property conforms to the schema.
Note: This is n_resources * n_outputs_in_rule.
Once chrome is fixed, we can remove this flag.
Otherwise, derive a name from the target name.
Otherwise, sort groups before everything else.
Reset the visited status for _GetBuildTargets.
Returns len(results) if no such result exists.
Section: customized api to get logs in buffer.
Something could be on sending on that UDP port
TODO(mark): Map Xcode variable names to these.
Test with the default manifest file in dbPath.
The attribute does nto exist in the main node.
The low bit of the unpacked value is the sign.
These are only designed to work for gcc-4.8.1.
They're pretty large, so don't hog disk space.
This happens in the case of the root PBXGroup.
This is an action that doesn't make any sense.
Update the main output of the compilation job.
Warn for any unimplemented signing xcode keys.
We want to know which chunks are placeholders.
Where the hhi files, socket, etc get extracted
could be multi-line if find the ( after the if
if we get here without errors, delete the tree
index now identifies the next item to examine.
linux-armv6* is canonicalized to 'linux-armv6'
linux-armv7* is canonicalized to 'linux-armv7'
register the client once the handshake is done
tests are really inconsistent about whitespace
trouble looking up, print something reasonable
A .gyp file is allowed to refer back to itself.
Add all inputs to sources and excluded sources.
Add the custom build action for one input file.
Check for None, corresponding to the root node.
Determine the set of extra arguments we'll use.
Directives for converting VCManifestTool to Mt.
Don't forget there's a dummy line at the front.
Emulates the frontend of an -embed-bitcode job.
Execute the code with our __children__ in scope
Extract environment variables for subprocesses.
Find the file node with the right relative path
Haven't found the end yet, append a blank line.
If one but not all certificate files are given.
If we have selected clang-cl, use that instead.
Last ditch effort to avoid multi-line comments.
Map gyp target types to Android module classes.
Merge buckets until everything is a root entry.
NOTE: Python 2's `map` function returns a list.
Only support setting breakpoints in real files.
See the AUTHORS file for names of contributors.
Skip abstract configurations (saves work only).
Some of them may now belong in in_degree_zeros.
Split it the same way sh would split arguments.
TODO: Supporting fat binaries will be annoying.
The full version, including alpha/beta/rc tags.
There shouldn't be space around unary operators
These groups should appear in the listed order.
This function works closely with _EncodeString.
Update the map now that the config is complete.
Verify non-existing workspace resolved to None.
We have to fixup the deps output in a few ways.
_configs is the default list of configurations.
targets is full list of targets in the project.
toolset is the default toolset for that target.
we skip basic code as they are added explicitly
- Make .INTERMEDIATE depend on the intermediate.
Add children that the schema doesn't know about.
Add sections only found in the MSBuild settings.
At least one of "name" and "target" is required.
Calculate a MD5 signature for the seed and name.
Check that rhs do not contain logical operators.
Checking stat of ' ' races with mkdir_variation1
Create the sets of arguments to dump_module_api.
Did not find endchar before end of file, give up
Don't mutate the caller's copy of the arguments.
Expecting closing parenthesis or closing bracket
Expecting opening parenthesis or opening bracket
Extra rule inputs also go into the project file.
Find the config, and add it if it doesn't exist.
Get the unique output directories for this rule.
Given non-default column family to single CF DB.
Helper for running hphp/test in fbconfig builds.
If no column specified, we will get all columns.
If xcodebuild fails, there will be no valid SDKs
Includes and excludes override previous actions.
Insert the test runner after the related target.
It gets emptied out every time the script is run
Keep reference to original results object alive.
Make sure every dependency appears at most once.
No additions to the schema relative to PBXGroup.
Now comes the plumbing to hook up the C library.
Obviously, we don't want that chunk in spelling.
One can supply multiple SDKs, written as a list.
Pop native frames until we hit our caller's rip.
Querying the same location should hit the cache.
Regular expressions that matches the SLN format.
Relative path from build output dir to base dir.
Remove the final output if any postbuild failed.
Return an instantiation of the printer if found.
Sadly there is no way to make the switch atomic.
Section: implementation of BufferingHandler api.
Start a Nuclide server using default parameters.
String has no effect (docstring in wrong place).
Support wrappers from environment variables too.
TODO(sky): I don't like hanging this off Target.
TODO: These return booleans to indicate success.
The following appears to be as-yet undocumented.
Unhook the includes list, it's no longer needed.
Use clang-cl to cross-compile for x86 or x86_64.
We still perform lint checks on these lines, but
We want running the bad tests to still complete.
Xcode seems to sort this list case-insensitively
include lines in CheckLanguage must be put here.
our build machines have no members in group 0...
A list of dependencies associated with a project.
And count them later, when we see something real.
Any changes to these affect the resulting output.
Check that access keywords are indented +1 space.
Clean up multiple Nuclide processes on same port.
Construct the set of API dumps we should perform.
DB should have atleast one value for scan to work
Dump and load with lots of extra params specified
Dump sleep and external thread event stacktraces.
Each of the child benchmarks emit their own line.
Excluded files can also go into the project file.
Fallback to reg.exe if we fail to import _winreg.
First half of the duration, keep doing kill test.
For now the behavior chrome needs is the default.
Gather the targets to shard, and how many pieces.
Get either the last message in the queue or None.
Gyp type ("static_library", etc.) of this target.
If no specific override, use the configuration's.
If true, show URL addresses after external links.
Keep a dict keyed on filename to speed up access.
Make a copy of the list for descending this node.
Map from qualified target to any linkable output.
Munge and print the code location if we have one.
New in Clang 3.8: not in the Python bindings yet.
Next we will look for issues with function calls.
Note that prefix should already be all lowercase.
Note: std::hash is their hash, ::hash is our hash
Only consider the ones with .d (dependency) info:
Relative includes may go outside the source tree.
Remove the .swift file we fed into swift-ide-test
Retrieve the default value of 'SHARED_LIB_SUFFIX'
Same as above, but for supp_lookup1/supp_lookup2.
Set up the child's back-reference to this object.
Snip out an extra 'lib' from libs if appropriate.
TODO(scottmg): This is ugly, but needed for goma.
TODO:  search for the first non-'Default' target.
Technically a valid construct, but against style.
The language for content autogenerated by Sphinx.
The ldflags config key is not used on mac or win.
The original parent had a sourceTree set, use it.
There should be no more than one on a given port.
This python script runs db_stress multiple times.
We may want to validate that they are consistent.
add an output line after this line to fix the bug
common case: else not followed by a multi-line if
mac and win use more complicated support scripts.
, then it's likely to be owned by the target file.
Add the DebugSettings onto the appropriate config.
Both the original parent and child have paths set.
Check if some verboten C functions are being used.
Create an XCTarget subclass object for the target.
Documents to append as an appendix to all manuals.
Escape codes should already be removed by ESCAPES.
Event loop terminates, shutdown chrome server app.
FIXME: doesn't respect strings or comment nesting)
First element that is found is copied to clipboard
Fix up command with platform specific workarounds.
Given ca path, get client cert and key file paths.
If it's a wrapper (bundle), set WRAPPER_EXTENSION.
Indicates that the translation unit is incomplete.
Initialize this here to speed up MakePathRelative.
Invalidating the cache should trigger a new fetch.
Mapping from a parent protocol to set of children.
Point the target alias to the final binary output.
Possible unbalanced tuple unpacking with sequence.
Python is dumb: http://bugs.python.org/issue16333.
Remember initial indentation level for this class.
Remember the whole nesting stack up to this point.
Replace the dependencies file with the input file.
Represents the "self" expression in a ObjC method.
Set project-level attributes from multiple options
Skip if not on Windows or Python Win32 setup issue
TODO(scottmg): Implement this for other platforms.
TODO: See if any of these should work in repo mode
Tell LLDB to print CKComponentAction as a c-string
The "whatever/" list is no longer needed, dump it.
This will compute the actual application data size
Unhook the conditions list, it's no longer needed.
Update the compiler directives in the shim target.
Wait for a sec and then ping endpoint for version.
XSL: 'include "prepare.inc"' makes repo mode fail.
must be killed on another thread, or else deadlock
non-space, non-identifier: begins an operator name
noqa (E402 module level import not at top of file)
replace object ids in var_dumps with the string ID
wait for Hack to catch up with file system changes
Add excluded sources into sources for good measure.
Add outputs generated by each rule (if applicable).
Add special-case rules for our installable targets.
Block bodies should not be followed by a semicolon.
But it's still good enough for CheckSectionSpacing.
Check how many lines is enclosed in this namespace.
Check pointer casts for other than string constants
Collect the set of submodules for the given module.
Exclude excluded sources coming into the generator.
First element of included_files is the file itself.
Get projects in the solution, and their dependents.
If the file itself is a symlink, always resolve it.
Import md5 otherwise, preserving 2.4 compatibility.
Import sha otherwise, preserving 2.4 compatibility.
In principle this could be extended to more nesting
Inject system includes from gyp files into INCLUDE.
Make progressively weaker assumptions about "other"
NOTE: sources goes from being a set to a list here.
Nothing in the variable, default based on platform.
Only generate Makefiles for gyp files with targets.
Options that have the same name in MSVS and MSBuild
Patterns for matching call-by-reference parameters.
Regexps would need twice the time of this function.
Register all convenience functions and CLI commands
Regular rule, one output: Just write a simple rule.
Relative path from source root to our output files.
Reset include state across preprocessor directives.
Return previously calculated value, if there is one
Run the process silently without stdout and stderr.
See the documentation for a list of builtin themes.
Some test end up using sockets, files on disk, etc.
Stop the server, ensuring that its logs get flushed
StringIO import path differs across Python 2 and 3.
Subsequent lines are continuations, so indent them.
Support the UNIX convention of using "-" for stdin.
TODO(rspangler): Need a way to configure this stuff
The actual number of bits are just trie parameters.
The following problems with Xcode rules were found.
The library module classes fail if the stem is set.
The missing spaces will be flagged by CheckSpacing.
This is done to make it easy to build source paths.
Try a bit harder to check for brace initialization.
Use KILL signal to force the process group to quit.
Verify it returns with same port that is passed in.
e.reference contains the correctly formatted option
'all' is special cased to mean all the root targets.
* load from the data block applying the data offset.
A list of ignored prefixes for module index sorting.
A parent of an XCTarget must be a PBXProject object.
Also use quotation marks to represent empty strings.
AsyncFunction, AwaitAll, and Condition wait handles.
Check for use of unnamed namespaces in header files.
Clang's API expects a list of (src, contents) pairs.
Compute the list of variables we'll need to provide.
Count the number of contexts, and print the topmost.
Create a .swift file we can feed into swift-ide-test
Default defines already processed in the loop above.
Gather a list of precompiled header related sources.
Generate suffix rules for all compilable extensions.
Helper that executes all postbuilds until one fails.
In that case, the expansion should result in a list.
LLDB will not emit any stopping event during attach.
Match first brace, semicolon, or closed parenthesis.
Merge in configuration (with all its parents first).
No additions to the schema relative to XCBuildPhase.
No value supplied, treat it as a boolean and set it.
Options that have the same name in MSVS and MSBuild.
Regex to remove comments when we're counting braces.
Return existing server port if the protocol matches.
Set GUID from path TODO(rspangler): This is fragile.
Some path relies on target-specific variables, bail.
TODO(mark): There's a possibilty for collision here.
Take a copy of the node and remove it from the list.
The Unicode 7.0.0 draft does not change these rules.
This is the dict for the PDB generating shim target.
This project file isn't yet linked to the other one.
This script runs and kills db_stress multiple times.
This tests the find open port feature and uses http.
Try a bit harder to find the beginning of the class.
Where Python 3's `map` function returns an iterator.
we expect negative retncode if kill option was given
Accept any year number from 2009 to the current year.
Also validate actions and run_as elements in targets.
Attempt to make the file writable before deleting it.
Based on http://code.activestate.com/recipes/576694/.
CHROMIUM_STRIP_SAVE_FILE is a chromium-specific hack.
Check if people are using the verboten C basic types.
Convert to normalized (and therefore absolute paths).
Determine how much of the prefix the two paths share.
Don't bother creating the extra targets in that case.
Don't traverse 'none' targets if explicitly excluded.
Dump and load without any additional params specified
FIXME(adonovan): "NOLINT(" is misparsed as NOLINT(*).
Fail: did not receive proper initialization sequence.
Hack to remove icu because the diff is too different.
Helper that is non-empty when a prerequisite changes.
If that's why, make it writable and try the op again.
If the original parent had a name set, keep using it.
If you need more, speak up at http://crbug.com/122592
It's important to get the "All" target first, though.
Listen for process events (Start/Stop/Interrupt/etc).
Name should be fully qualified if outside the parent.
Optionally, a third item, false_dict, may be present.
Reparsing isn't cheap, so skip it if nothing changed.
Replace originals with files generated from templates
Running it with the copy we just created should pass.
Setup params to pass to and attempt to launch reg.exe
That means we have to handle -emit-bc and -c actions.
The following drawing explains how it is implemented:
The rule action script would need to touch the dummy.
The version that we will be importing the tests from.
These tests use eval(), which is banned in repo mode.
This file invokes the runner after parsing arguments.
This typically indicates that I/O failed during save.
Try to avoid setting global variables where possible.
Update access control if we are inside a class/struct
Update the translation unit with the latest contents.
We can only insert the line directive at a line break
We make an exception for nested parens ( (a+b) + c ).
Write the project file to a temporary location first.
atomic_impl representation since version 4.1 Update 2
copytree() will fail if the directory already exists.
map of all files that we cannot convert at the moment
noqa (I100 Import statements are in the wrong order.)
use large ops per thread since we will kill it anyway
(1) the file output should mention the proper .o file.
/CLRSupportLastError:NO /CLRSupportLastError:SYSTEMDLL
2) An explanation to insert into each "fixme" comment.
Add a new PBXBuildFile to get file_ref into the phase.
Add custom shell script phases for "actions" sections.
Add to new_target_list, new_target_dicts and new_data.
Associate the frame pointer with the un-inlined frame.
Assume the child's properties, including its children.
Check for non-const references in function parameters.
Conversion to opposite signedness is never truncating.
Create reference to TU so it isn't GC'd before Cursor.
Even if strip_save_file is empty, explicitly write it.
Generate a key pair and a certificate signing request.
If we get a reply, it's the place to resume tokenizing
In auto mode, check environment variable for override.
Initialize the specifications of the various sections.
It supports https if key_file and cert_file are given.
Look for the pattern that gets expanded into variables
Note that this does /not/ update the translation unit.
OK, we have a blank line at the start of a code block.
Redirect them to show up in one of those other groups.
Regular expression for validating Visual Studio GUIDs.
Search for loop keywords at the beginning of the line.
Setup params to pass to and attempt to launch reg.exe.
TODO(nsylvain): Find a better way to navigate the xml.
This doesn't support per-configuration prefix headers.
Try to convert, this will raise ValueError if invalid.
Use the absolute path so that matching works properly.
Version file in the same directory as the mock script.
We create a huge list of all the elements of the file.
What matters here is that the key is in include_state.
Windows Structured Exception Handling's try statement.
fail.py - Just exits with an error code -*- python -*-
fetch the file name from the first line of the report.
this file is probably generated while running tests :(
- The multi-output rule will have an do-nothing recipe.
-- the following methods are only used in Python 2.7 --
A list of sections that contain links to other targets.
Add to the properties of primary input for each config.
Admittedly not the best name, but it's what Xcode uses.
As a workaround, manually expand variables at gyp time.
At this point, all that should be left is actual casts.
Collect the names of the directories that are required.
Didn't find a known root, just return the original path
Filter junk out of stdout, and write filtered versions.
Get commands for a given job from the determinator file
GetChildAtIndex(idx, use_dynamic, can_create_synthetic)
However it's still important to strip trailing slashes.
However, that would make this class harder to subclass.
I don't know if VS2010 is sensitive to the exact names.
If 2nd arg is zero, snprintf is used to calculate size.
In the same way, a do/while should never be on one line
Inject replacement versions of a function and a method.
It should have one dependency, the parent xcode target.
Iterate over rules in the order of increasing priority.
Like /bin/touch, but takes a time using the LLVM epoch.
Look at dependents of the node just added to flat_list.
Prefix of the string returned by clang_getClangVersion.
Put build-time support tools next to the root Makefile.
Remove any keys with values that haven't been replaced.
Set up additional defaults not expressed in the schema.
Start with the default variables from the command line.
The PCH is only built once by a particular source file.
The cygwin case handles this inside the bash sub-shell.
The target's sources contain one of the supplied paths.
The unquoted segments are at the even-numbered indices.
There are no reparse options available in libclang yet.
This handles 'throw' and 'throw' assignment-expression.
This is done to avoid some false positives with shifts.
This recurses into lists so that it can look for dicts.
Write configuration-specific variables for CFLAGS, etc.
fails because timstamp's length is greater than value's
i.e either we compare files, or directories of depth 1.
include lines are NOT removed from elided line, to make
self._section will move monotonically through this set.
the provisioning profile whose pattern is the longest).
2) They get shortcuts for building (e.g. "make chrome").
Add an alias for each target (if there are any outputs).
Already been well guarded, no need for further checking.
Assure that the rule name is only characters and numbers
At least one of the operands must be a constant literal.
Attach actions to the gyp file if nothing else is there.
Capture stderr output such as 'tar: Failed to open ...'.
Change program database directory to prevent collisions.
Check for potential format string bugs like printf(foo).
Create a bogus validator that looks for '0', '1', or '2'
Destructors should still be visible, so add two of them.
Determine ninja top level build dir (e.g. /path/to/out).
Did not find startchar before beginning of file, give up
Extracts the build file from the fully qualified target.
Figure out what the contents of the variable parens are.
Find the path to a CMake executable on the host machine.
For each node, take a copy, and remove it from the list.
If port_filter is given, only list servers in that list.
Indicates that the translation unit was somehow invalid.
It is based on make.py, the standard makefile generator.
It will get a default common name like user.nuclide.host
Mark it with note: so Xcode picks it up in build output.
Match group 1 is "DIR", match group 3 is "path" or None.
Must be a valid, released version from php download site
Next, we complain if there's a comment too near the text
No suffixes provided, default to using empty suffix only
Normalize the path so trailing slashes don't confuse us.
Now that we have all the vsprops, we need to merge them.
Open pipe for anything else so Popen works on python2.4.
Otherwise, if there are any spaces, quote the whole arg.
PBXReferenceProxy is also an XCFileLikeElement subclass.
Pattern to recognize a (possibly-generic) operator decl.
Prune unwanted targets from each build_file's data dict.
Resolve it by interpreting it as relative to build_file.
See the comment in WriteCopies about expanding env vars.
Strings that match this pattern may be printed unquoted.
TODO(mark): A stronger verification mechanism is needed.
The dependent one or more dependencies not in flat_list.
Therefore, the port is not available for Nuclide server.
These constants define the current inline assembly state
This adds time to parsing but speeds up code completion.
This may be unrecognized because it's an exclusion list.
Tricky point: Make has no string-equality test function.
Update the original target to depend on the shim target.
Update the output file mtime, or create it if necessary.
Use regex_filter to look for regex pattern in ps output.
We got a text frame before we completed the previous one
We instead explicitly write all the rules we care about.
hack to import SwiftBuildSupport and swift_build_support
if there's no control flow construct, look at whole line
let subclasses override update without breaking __init__
map/filter on lambda could be replaced by comprehension.
/oldtlb Directives for converting VCLibrarianTool to Lib.
Add a dependency to a target in a different project file.
Assume it's a dict, otherwise a callable to do the remap.
CMAKE_CURRENT_LIST_DIR is where the CMakeLists.txt lives.
Consider target "t" rule "A_r" and target "t_A" rule "r".
Consume braces or semicolons from what's left of the line
Define an escape_quotes function to escape single quotes.
Determine the SDK root and collect the set of frameworks.
Do an extra check to avoid work when we're not debugging.
Escape all quotes so that they are interpreted literally.
Folder mappings Omit this section if there are no folders
Gather files into the final result, excluded, or folders.
Include the standard JRE container and a dummy out folder
Make the output of this target referenceable as a source.
Normalize the node, and remove all extranous whitespaces.
On mac, products are created in install_path immediately.
Other targets just get built into their intermediate dir.
Prevent default library inheritance from the environment.
Produces an empty string (false) when the commands match.
Provide a single configuration by default if none exists.
Python wrappers for invoking `xcrun` on the command-line.
Refer to documentation for a list of supported languages.
Replace "not --crash" with "not", and remove XFAIL lines.
Retrieve a row that corresponds to this first code point.
Search for the function arguments or an initializer list.
See comment at cc_command for why there's two .pdb files.
Skip "variables", which was already processed if present.
Sort config guids for easier diffing of solution changes.
Sort the targets based on how they appeared in the input.
Special variables that may be used by gyp 'rule' targets.
String is special -- it is a non-templatized type in STL.
TODO(scottmg): Handle OutputDirectory without OutputFile.
TODO: Handle subprocess.CalledProcessError for this call:
Tests from Unicode spec have isolated surrogates in them.
The script wrapper of the library is for testing purpose.
These are mostly intermediate files for the build system.
These tests use create_function, which is basically eval.
This class represents a Nuclide server process on a port.
This is a low-prioroty problem and is not a show-stopper.
This is not expected to be much of a problem in practice.
Verify Nuclide server can get correct certificates paths.
We may want to generate unique common name and verify it.
We simply find the first C++ file and use that extension.
Windows Structured Exception Handling's except statement.
add a trailing newline so that its easier to see the diff
amalgamate.py creates an amalgamation from a unity build.
config will be None for packages such as sample packages.
gyp-mac-tool is written next to the root Makefile by gyp.
'mac_framework_dirs', input already handles _dirs endings.
1) They need to install to the build dir or "product" dir.
A dictionary mapping supported target types to extensions.
A naive reimplementation of shutil.which() for Python 2.7.
Append and prepend are the only policies that can coexist.
Apply globals so that the worker process behaves the same.
AsyncFunctionWaitHandles have a slightly different layout.
Check to see if they're using an conversion function cast.
Compiled storyboard files are referred to by .storyboardc.
Create an intermediate file to store preprocessed results.
Don't insert a msvs_system_include_dirs key if not needed.
Everything else needs to be relative to an Xcode variable.
Exclude lines with sizeof, since sizeof looks like a cast.
Find end of the boolean expression by matching parentheses
Flag to indicate if there was an error in a child process.
For the rest, work with both comments and strings removed.
If it is false, this method returns a path to the symlink.
If path is already just a leaf name, name will not be set.
Indicates that errors during translation prevented saving.
It's hard to tell, though, so we punt on this one for now.
Keys that do not belong inside a configuration dictionary.
LocalPathify() calls normpath, stripping trailing slashes.
Loop to take over the innermost only-child group possible.
NOTE: here are the conditions rob pike used for his tests.
Note that the first argument is assumed to be the command.
Now that everything is merged, we need to cleanup the xml.
Regex to remove quoted strings when we're counting braces.
Run through the list and handle variable expansions in it.
Separators must be specified to avoid trailing whitespace.
Set a variable so conditions can be based on msvs_version.
Sort by name then guid (so things are in order on vs2008).
TODO(unknown): check that 1-arg constructors are explicit.
TODO: Remove once bots are on 2.7, http://crbug.com/241769
The variable name is the key name in the "variables" dict.
This object retains its existing id and parent attributes.
Turn the list into a string that can be passed to a shell.
Version check verifies it runs and has a working endpoint.
When assignment-expression isn't present, Op will be null.
Windows Structured Exception Handling's finally statement.
You should always have whitespace around binary operators.
and can get confused if more then one test runs at a time.
http://www.cmake.org/pipermail/cmake/2010-July/038461.html
i.e., the internet is attempted to be used and that is bad
now that all workers have completed, merge all their files
remove trailing newlines, and trailing spaces on each line
A map of header name to linenumber and the template entity.
A trie with one lookup table consists of two memory blocks:
All the lines have been processed, report the errors found.
Automatically adapt CIndex/ctype pointers to python objects
By default, it only gets you your Nuclide server processes.
Consume namespace declaration at the beginning of the line.
Create new server objects to rebind and check states again.
Don't do this for ones that are precompiled header related.
For now, we don't do any special validation on these types:
GDB doesn't add the script's dir to sys.path when sourcing.
Get the property sheets associated with this configuration.
If the NXCOMPAT flag has not been specified, default to on.
If the name attribute seems unnecessary now, get rid of it.
It checks consistency in case of unsafe crashes in RocksDB.
It needs every file separate, not a string else ./run barfs
LOCAL_CXXFLAGS is obsolete and LOCAL_CPPFLAGS is preferred.
Like actions, but implicitly depend on the target's output.
Monkeypatch pygments so it will know about the Swift lexers
NOTE: there is no need to update the translation unit here.
Now recurse into subdicts and lists that may contain dicts.
Open 'stdlib.swift' in this directory if no path specified.
Perhaps it should update various properties if they change.
ProjectRef is weak (it's owned by the mainGroup hierarchy).
Proxy all of these through to the build configuration list.
Python 2.6.1 and below don't parse ws or wss urls properly.
Return whether the user is the owner of the server process.
See docstring of msvs_emulation.GenerateEnvironmentFiles().
Separate out 'path/to', 'file.gyp' from 'path/to/file.gyp'.
Show packages being linted when --verbose flag is specified
So can "inputs" and "outputs" sections of "actions" groups.
TODO(unknwon): Doesn't account for preprocessor directives.
TODO: Take excluded sources into consideration if possible.
Take the first line, as that's the first found in the PATH.
The individual targets need to be merged into the defaults.
The maximum value of the first level index for supp tables.
These are not replaceable with CHECK_LE, so bail out early.
This is meant to silence warnings for conditional includes.
This means we will not check single-line class definitions.
Usage of PCH must only be for the same language (i.e. C vs.
We can't use displayname as it also includes the arguments.
Work around this by marshalling object arguments as void**.
gyp dictates that commands are run from the base directory.
loadable_modules have a 'Contents' folder like executables.
path just provides a new variant that belongs to the group.
-- Second line of the file report (with coverage percentage)
/FAu Defines a setting that needs very customized processing
/WX Options found in MSVS that have been renamed in MSBuild.
A closing punctuation without matching opening punctuations.
Add a dependency to another target in the same project file.
CMake gets upset when executable targets provide no sources.
Command-line --include files come after the default include.
Concrete outputs were already added when they were computed.
Directives for converting MSVS VCLinkerTool to MSBuild Link.
Find the ending paren, and re-evaluate the contained string.
First, see if the compiler is configured in make's settings.
Here and below 'supp' stands for 'supplementary characters'.
However, the specific kind of the statement is not reported.
If true, "Created using Sphinx" is shown in the HTML footer.
Load into an existing db, create_if_missing is not specified
Make sure that the product is already in the products group.
Make sure this 'toolsets' definition is only processed once.
NOTE: excluded_sources goes from being a set to a list here.
New flag required in 2013 to maintain previous PDB behavior.
Only return this marker if the comment goes beyond this line
Rely on system service configuration being a particular way.
Remove comments from the line, but leave in strings for now.
Replacement macros for CHECK/DCHECK/EXPECT_TRUE/EXPECT_FALSE
Should be first for LLDB package to be added to search path.
Some boolean settings went from numerical values to boolean.
Sometimes tokenizer errors report a line beyond the last one
TODO(mark): This is wrong for build settings that are lists.
TODO(mark): make additional choices based on file extension.
TODO:  not duplicate this mapping from pylib/gyp/__init__.py
TODO: Check if MSVC allows this for loadable_module targets.
The android backend only supports the default configuration.
The bitwidth of data depends on the application of the trie.
The name of the Pygments (syntax highlighting) style to use.
The remaining bits point to the next blockable in the chain.
The value formatting is cute, but not really used right now.
These can be valid for both frameworks and static libraries.
They will be fully expanded by recursion in ExpandVariables.
This validation should not be applied to MSVC2010 and later.
include ' + required_header_unstripped + ' for ' + template)
make a backup in case something goes wrong and we pass dirty
make will build the first target in the makefile by default.
'pointsize': '10pt', Additional stuff for the LaTeX preamble.
- The intermediate recipe will 'touch' the intermediate file.
A context manager for changing the current working directory.
A mapping from BMP first-level index to BMP data block index.
Add our outputs to the list of targets we read depfiles from.
All of the dependent's dependencies are already in flat_list.
Allow the template to import .py files from its own directory
An array of tuples (start_code_point, end_code_point, value).
Check the configurations to see if they contain invalid keys.
Convert most of the signature to GUID form (discard the rest)
Currently, all tests appear to be able to be run in parallel.
Decide the set of replacement macros that should be suggested
Default filters always have less priority than the flag ones.
Delete the lists that are known to be unneeded at this point.
Determine and output the C++ extension used by these sources.
Functions calls through the python interface are rather slow.
However, the specific kind of the expression is not reported.
If it's disabled in any config, turn it off in the reference.
If the line's pattern doesn't fall into the above categories.
In addition, we look for people taking the address of a cast.
Make sure all files we write out end with a trailing newline.
Mimic Xcode's behavior here by using an empty string for sep.
No need to explore subdirectories once package.json is found.
Status when it should be assumed that everything has changed.
The first item in a specification is the name of the element.
There should always be a space between the // and the comment
These are defined in base/logging.h and testing/base/gunit.h.
This is intentional, as we do not want to block autocomplete.
This source file is part of the Swift.org open source project
Use the param name, but fall back to the raw type if unnamed.
Visual C++ 2008 generator doesn't support this configuration.
Walk the entry tree and collect all the folders and projects.
We ignored case earlier, but use it as a final ranking basis.
build_file is the file relative to which 'target' is defined.
connect requires the address in tuple format (address, port).
noqa (E402) FIXME: This doesn't work on non-Darwin platforms.
plists can contain envvars and substitute them into the file.
/Wall Options found in MSVS that have been renamed in MSBuild.
All such debugger tests live under something/debugger/foo.php.
C++), so only include the pch flags when the language matches.
Force a re-parse, in case the user e.g. changed a header file.
Function signature specialization of a generic specialization.
Gyp traditionally names the object resulting from foo.c foo.o.
However, the specific kind of the declaration is not reported.
If braces come on one side of an else, they should be on both.
If path is set and name is not, name may have a default value.
If port not specified, skip port check and add to result list.
If the GUID contains lowercase hex letters, MSVS will be fine.
If we can make it an int, use that, otherwise, use the string.
Insert synthesized key/value pairs (e.g. BuildMachineOSBuild).
It's stupid to replace and append simultaneously, for example.
Make sure we can pack one row of the matrix into a 'uint16_t'.
NOTE: there may be overlap between this an empty_target_names.
On newer releases of FreeBSD, the default Clang is sufficient.
Only create files for ninja files that actually have contents.
Only emit LOCAL_MODULE_STEM if it's different to LOCAL_MODULE.
Opening punctuations left without matching close-punctuations.
Parse expression so that we can take parentheses into account.
Pass through an attempt to update IDs to the real root object.
Remove system includes shared by all targets from the targets.
So we substitute in 2* what we match, +1 more, plus the quote.
Stuff the outputs in a variable so we can refer to them later.
TODO(mark): Optimization: only reload if no changes were made.
TOOD(hansonw): Remove this when these bindings are upstreamed.
The "data" dict that was passed to LoadTargetBuildFileParallel
The constructor and destructor will not have those qualifiers.
The list of targets upon which the 'all' target should depend.
The old method above does not work when only SDK is installed.
The regular expression we use to match compiler-crasher lines.
This (target include directories) is what requires CMake 2.8.8
This is to avoid adding struct arguments to the nesting stack.
Use consistent guids for folders (so things don't regenerate).
Variable expansion may have resulted in changes to automatics.
We only want to shim targets that have msvs_large_pdb enabled.
We remove "_gyp" from the names because it helps to diff them.
We will check again that the class does actually exist anyway.
build_dir: relative path from source root to our output files.
the first match has to be in a try incase there is bad unicode
update-dependencies-bad.py - Fails on bad.swift -*- python -*-
- We wish to explicitly set the owner and group of the archive.
8859-15, CP866, and ROMAN all cause issues with this generator.
Add to the set of targets which represent the gyp 'all' target.
Allow 8Gb per link on Linux because Gold is quite memory hungry
Apply "latelate" variable expansions and condition evaluations.
Below is the logic to compute the dependency graph and sort it.
Build a dict to access each target's subdict by qualified name.
But if the new text contains any line breaks, we can create one
Check if we need to display coverage info for interested files.
Compile regular expression that matches all the above keywords.
Compile targets are found by searching up from changed targets.
Currently the only local property we support is PlatformToolset
Don't define a truncating conversion between a type and itself.
Drop last 2 NULs, one for list terminator, one for trailing vs.
For this we need to check what came before the "(type)" string.
Further (to handle cases like ../cwd), make it relative to cwd)
If the groups aren't in the listed order, do a name comparison.
Keep a dict going from 'subdirectory:target_name' to 'foo.gyp'.
Make some replacements in the signature to limit the graph size
Only apply checks if we got all parts of the boolean expression
Optionally shard targets marked with 'msvs_shard': SHARD_COUNT.
Our only solution here is to convert our string to a bytearray.
SBFrame.GetVariables(arguments, locals, statics, in_scope_only)
Sections that must exist inside targets and not configurations.
See also clang_defaultEditingTranslationUnitOptions in Index.h.
See: https://github.com/Lawouach/WebSocket-for-Python/issues/59
Subclasses must override this by returning a two-element tuple.
TODO(williamsc) - Support add support for pausing on exceptions
The CLT has no build information, so we return an empty string.
The root directory used for deriving header guard CPP variable.
Third argument, if non-zero, makes it do POSTBUILDS processing.
This means that all variables in .mk-files clobber one another.
This value will be replaced dynamically for each configuration.
cmpcodesize.py - Compare sizes of built products -*- python -*-
next line is where we'd have expect a configuration key somehow
touch.py - /bin/touch that writes the LLVM epoch -*- python -*-
Absolutify() may call normpath, and will strip trailing slashes.
Add a trailing '/' so that _AddSources() can easily build paths.
Add the hashables of the remote PBXProject that it's related to.
Check that closing brace is aligned with beginning of the class.
Copy a reference to the TranslationUnit to prevent premature GC.
Don't excluded sources with actions attached, or they won't run.
Else a postbuild might pick up an export from an earlier target.
Everything else in this function operates on class declarations.
Exhausted all earlier lines and still no matching angle bracket.
Gyp separates the sheep from the goats based on file extensions.
If both groups are in the listed order, go by the defined order.
If the string already contains a "*/", it is turned into "(*)/".
If we have a colon indented 4 spaces, it is an initializer list.
Initialize the list_actions list, which is parallel to the_list.
It just removes the monitor so that we can kill them on upgrade.
Let CMake know if the 'all' target should depend on this target.
Look for any include dirs that were explicitly added via cflags.
Mapping from protocol to associated type / operator requirements
Move into the framework directory to set the symlinks correctly.
Optionally in second position is a dictionary of the attributes.
Pass a copy of the variables dict to avoid having it be tainted.
Property data for BMP code points is stored as a one-stage trie.
Remove all files in test_dir leaving directory structure intact.
Remove escaped backslashes before looking for undefined escapes.
Remove this when we have ParamCoerceMode working for PHP methods
Same as passing sys.stderr, except python2.4 doesn't fail on it.
Same as passing sys.stdout, except python2.4 doesn't fail on it.
Set user-specified project-wide build settings and config files.
Simple demo that shows files that most contribute to total size.
Skip this check if the keywords are not preceded by whitespaces.
String ends while still quoted according to VCProj's convention.
The second argument is an addition that causes a pylint warning.
The target is linkable, add it to the list of link dependencies.
There may be other processes with this particular pattern in it.
There's two levels of architecture/platform specification in VS.
This caches the preamble (included files at top of source file).
This does not stop existing Nuclide server processes themselves.
We want to let any rules apply to files that are resources also.
do_cmd: run a command via the above cmd_foo names, if necessary.
stylistic only - (like an import/require) adding the ".js" works
test_toolchain.py - Unit tests for swift_build_support.toolchain
2) simple files like libraries and stamps have a simple filename.
A pet peeve of mine: no spaces after an if, while, switch, or for
Add an alias from the gyp target name to the Android module name.
Add the library's directory to LIBRARY_SEARCH_PATHS if necessary.
Add them to the dependencies list if they're not already present.
Also check if we are starting or ending an inline assembly block.
Benchmarks that are run as part of other benchmarks are excluded.
BufferingHandler is old styled class, so we can't use super here.
Check for potential memset bugs like memset(buf, sizeof(buf), 0).
Check for templated parameter that is split across multiple lines
Check if multiple architectures are supported by the object file.
Controls whether or not the generator supports multiple toolsets.
Don't add actions if we are using an external builder like ninja.
Don't use restart() here, so that we regenerate the certificates.
Don't waste time here if line doesn't contain 'CHECK' or 'EXPECT'
FIXME: self.assertRaises context manager is not py2.6 compatible.
File representing the completion of actions/rules/copies, if any.
Give opening punctuations to get the matching close-punctuations.
Grab the path of the .gyp file as the base to relativize against.
If given port is being used by somebody else, you shall not pass.
If the dependencies list is empty, it's not needed, so unhook it.
If the expression didn't yield anything then it's likely a class.
If these are present, then we check the second character instead.
List of HandlerDomainSets for the server to respond to reqs with.
Look for any of the stream classes that are part of standard C++.
Matches the first component of a filename delimited by -s and _s.
NOTE: Xcode generator DOES NOT take 'verbose-build' into account.
Now compute number of samples we can take in the given time limit
See "Target-specific Variable Values" in the GNU Make manual.""")
Since this is for MSVS only settings, no translation will happen.
TODO(mark): Should verify that at most one of these is specified.
TODO(quote):  regularize quoting path names throughout the module
TODO(williamsc) Add support for sending watchpoint change events.
TODO: It would be nice to be able to tell CMake all dependencies.
The variable name is the key name with a "_" character prepended.
This allows us to avoid the need to do two passes during linking.
This can happen two ways: - We are at the beginning of the class.
Use the hashables of the weak objects that this object refers to.
Write out all: target, including mkdir for each output directory.
completions may still be None if there was a clang parsing error.
'cmake -E copy src dst' will create the 'dst' directory if needed.
(using findall here would return strings instead of MatchObjects).
-- Print body template for printing coverage report for each file.
A statement whose specific kind is not exposed via this interface.
Apply "pre"/"early" variable expansions and condition evaluations.
Braces are also used for brace initializers inside function calls.
Continue right now without falling into the index increment below.
Convert any paths to native form (first element is used directly).
Detach() might be closer to what Chrome Dev Tools is trying to do.
Emulates the frontend of a -whole-module-optimization compilation.
Exhausted all remaining lines and still no matching angle bracket.
Figure out all the projects that will be generated and their guids
Find the excluded ones, minus the precompiled header related ones.
Format upgrade_check_project_version with leading zeros as needed.
Get the entire list of matches as a list of MatchObject instances.
I wanted to name the parameter "from" but it's a Python keyword...
If appending a singleton that's already in the list, don't append.
If it's equal, we leave it untouched, otherwise we concatenate it.
If previous line was _END_ASM, we will now shift to _NO_ASM state.
If the list contains any descendant dicts, path fixing will occur.
If the two objects are of the same sort rank, compare their names.
Ignore toolset specification in the dependency if it is specified.
It's ok to have many commands in a switch case that fits in 1 line
Linux lldb has a bug of not emitting stopping event during launch.
List of "official" debug modes, but you can use anything you like.
Look for single-argument constructors that aren't marked explicit.
NOTE: there may be overlap between this an non_empty_target_names.
NOTE: this stanza must appear after all actions have been decided.
Only do this if the closing brace is indented by only whitespaces.
Return False, becuase we don't support changing source at runtime.
Runs `hh_client check` asserting the stdout is equal the expected.
Some actions/rules output 'sources' that are already object files.
Split the size using space and arithmetic operators as delimiters.
Tail 1-indexes line numbers and starts emitting from the nth line.
The built host binaries may not be suitable, and can cause errors.
These additional inputs are used for dependency tracking purposes.
This gets serialized and sent back to the main process via a pipe.
Update global list of target outputs, used in dependency tracking.
Update the associated dependencies file, in case anything changed.
We can then reverse the result of the topological sort at the end.
We set LOCAL_PATH just once, here, to the top of the project tree.
When snprintf is used, the second argument shouldn't be a literal.
`tar` complains about absolute paths, so use a relative path here.
-- the following methods do not depend on the internal structure --
6584839 I need a way to declare additional inputs to a custom rule.
A full separation is done here because of flag handing (see below).
Add custom shell script phases driving "make" for "rules" sections.
Boolean to declare that this target does not want its name mangled.
Call MergeLists, which will make copies of objects that require it.
Check that no two targets in the same directory have the same name.
Create a DependencyGraphNode for each gyp file containing a target.
Create variables for the output, as 'local' variable will be unset.
Don't add quotes around it because then built-ins like 'echo', etc.
Extend the Clang C bindings with the additional required functions.
For each source file, write an edge that generates all the outputs.
Get all the inputs and outputs for this rule for this trigger file.
Get the address and value of `mcg', the global MCGenerator pointer.
If we got a result, the code was an expression, so append its value
It'll blow up if the args aren't immutable, among other "problems".
Make a copy of the dictionary, continuing to look for paths to fix.
Make sure that no two objects in the project file have the same ID.
Make sure that there's no conflict among rule names and extensions.
Monkeypatch pygments.lexers.get_lexer_by_name to return our lexers.
Needs to happen before postbuilds, since postbuilds depend on this.
No body for the function (or evidence of a non-function) was found.
Not using urlparse here as it does not handle unknown schemes well.
ObjCStringLiteral, used for Objective-C string literals i.e. "foo".
Optimization: only do copies if more than one toolset is specified.
Products Directory Other types that can be chosen via the Xcode UI.
Skip emitting anything if told to with msvs_existing_vcproj option.
Starting accessibility server is different for simulator and device
The last segment looks like an environment setting or cli argument.
The new file is different from the old one, or there is no old one.
These mappings are contained in the class' _encode_transforms list.
This function ported from the logic in Homebrew's CLT version check
This represents the unary-expression's (except sizeof and alignof).
This will break if 'src' or 'java' exists in the package structure.
Used by _AdjustLibrary to match .a and .dylib entries in libraries.
Write phony targets for any empty targets that weren't written yet.
WriteNewNinjaRule uses unique_name for creating an rsp file on win.
`obj` is not a view, make sure recursive bordering is not requested
buildPhases is overridden in the schema to be able to set defaults.
fake-ld.py - Fake Darwin linker to test driver-produced -filelists.
false_dict is merged into the_dict if cond_expr evaluates to false.
not in quotes Allow one space for new scopes, two spaces otherwise:
o When all files are compiled, the harness begins to run the tests.
since we will be killing anyway, use large value for ops_per_thread
we need to clean up after ourselves -- only do this on test success
we want to upstream this to atom, so do not require nuclide- prefix
/arch:IA32 (vs2012+) This one only exists in the new msbuild format.
A trie with two-stage lookup tables consists of three memory blocks.
Converts a python source from stdin to JSON formatted AST on stdout.
Copy out only the edges we're interested in from the full edge list.
Copy test_dir and its contents to backup so we can restore it later.
Directives for converting VCResourceCompilerTool to ResourceCompile.
Don't generate rules if we are using an external builder like ninja.
For migration, stop the forever monitor processes of Nuclide server.
If any non-native rules use 'idl' as an extension exclude idl files.
Keys are names of packages and values are the corresponding configs.
Keys with these suffixes should be treated the same as keys without.
Known issues: - pretty printing only works for the 'native' strings.
Let msbuild-only properties get translated as-is from msvs_settings.
Let's handle IPv4 and IPv6 addresses Simplified from CherryPy's code
Likewise, an else should never have the else clause on the same line
Maps every compilable file extension to the do_cmd that compiles it.
Note: This flag is a no-op for clang, it only has an effect for gcc.
Notice that evaluateExpression doesn't work with variable arguments.
Nuclide can't open these remotely, so resolve them to the real path.
Optionally configure each spec to use ninja as the external builder.
Otherwise, raise CalledProcessError with combined stdout and stderr.
Should always run for a given target to handle command-line changes.
So do as other gyp generators and use --start-group and --end-group.
So far only the first token in command is assigned to command field.
TODO(mark): Remove this option when http://crbug.com/35878 is fixed.
TODO: Avoid code duplication with _ValidateSourcesForOSX in make.py.
The following function is just a speed up, no semantics are changed.
The operation failed, possibly because the file is set to read-only.
The spec explicitly defined an external builder, so don't change it.
These variables should just be spit back out as variable references.
This ensures that the earliest occurrence of the item will stay put.
This item matches an exclude regex, so set its value to 0 (exclude).
This item matches an include regex, so set its value to 1 (include).
This mimics Xcode behavior by wrapping the comment in "/*" and "*/".
This structure allows a fairly standard loop do the normal printing.
fake-build-for-whole-module.py - Optimized fake build -*- python -*-
for instance, type errors cause hh_single_type_check to produce them
output_dir: relative path from generator_dir to the build directory.
Add dependencies to visit as well as updating back pointers for deps.
Always NO, because we generate a manifest file that has what we want.
An expression that sends a message to an Objective-C object or class.
As a result, link_directories must come before the target definition.
CMake by default names the object resulting from foo.c to be foo.c.o.
E.g. "foo/bar" when we're constructing targets for "foo/bar/baz.gyp".
Flags with values 16 and 32 are deprecated and intentionally omitted.
GYP rules/actions express being no-ops by not touching their outputs.
Generates a BFS of the views tree starting at the given view as root.
Got a comma after a bracket, this is most likely a template argument.
If invoked in non-primary-file mode, it only creates the output file.
Including the input file as an argument causes index.parse() to fail.
It is no longer incredibly sucky, but this list needs to be extended.
Listen for breakpoint/watchpoint events (Added/Removed/Disabled/etc).
Move everything that can go into a "configurations" section into one.
Note, not Iterable because we don't want to handle strings like that.
Recurse, guaranteeing copies will be made of objects that require it.
Require there to be at least one input (call sites will ensure this).
Returns True if all configurations have a unique 'SYMROOT' attribute.
See the corresponding comment in the posix section above for details.
Sets up this PBXGroup object's dicts to reference the child properly.
Shared by all XcodeSettings, so cached at class-level for efficiency.
Splits a qualified target into a build file, target name and toolset.
TODO(piman): when everything is cross-compile safe, remove lib.target
TODO: investigate why we need os._exit() to terminate python process.
That module has a much better description of what's going on and why.
The XPC service cannot run via the bindings due to permissions issue.
The errors should be available via the TranslationUnit's diagnostics.
This breaks incremental linking, and is generally overly complicated.
This item matches the exclude_item, so set its action to 0 (exclude).
We constrain the pattern not to pick things like DocidForPrintf(foo).
We run the tests in Nuclide/spec in a separate integration test step.
You shouldn't have a space before a semicolon at the end of the line.
`obj` is not a view, make sure recursive unbordering is not requested
`xcrun --find` prints to stderr when it fails to find the given tool.
generator_dir: relative path from pwd to where make puts build files.
o implement additional SourceLocation, SourceRange, and File methods.
send stderr to /dev/null to ignore messages when linking directories.
"include" should use the new style "foo/bar.h" instead of just "bar.h"
A list of dependency build file paths that haven't been scheduled yet.
Adaptor class for mixing declarations with statements and expressions.
Add any paths that contain templates here, relative to this directory.
Before nixing comments, check if the line is blank for no good reason.
But XCTarget is defined below, so it can't be put into the schema yet.
Check for people declaring static/global STL strings at the top level.
Check to see if the compiler was specified as an environment variable.
CompletionChunk.Kind("Comma"), 15: CompletionChunk.Kind("ResultType"),
Compute the relative path from there to the output_file for including.
Files that have no dependencies are treated as dependent on root_node.
Find the list of targets that derive from the gyp file(s) being built.
Find the name of the binary based on the part before the ".framework".
For a list of options available for each theme, see the documentation.
Got a comma before a bracket, this is most likely a template argument.
Gyp does not retain or enforce specifying enough information to do so.
If a 'none' target has rules or actions we assume it requires a build.
If the resource lives in a .lproj bundle, add that to the destination.
If you have a type that spans more than 2 lines, please use a typedef.
Import hashlib if available, avoiding a deprecation warning under 2.6.
Only 3 types of objects are possible: - _ClassInfo: a class or struct.
Passes Python2.7's test suite and incorporates all the latest updates.
Please profile carefully if you would like to add CachedProperty back.
Putting a directory inside a variant group is not currently supported.
Represents an expression that computes the length of a parameter pack.
Self reference is used in a few places to append to the default value.
Simulates a Swift compilation for the purposes of dependency analysis.
Skip checks if the class is small, where small means 25 lines or less.
TODO(evanm): just make order_only a list of deps instead of this hack.
TODO(thakis): It would be nice to have some general mechanism instead.
The new file is identical to the old one, just get rid of the new one.
There's no compelling reason for Xcode's linker invocations to differ.
This occurs when rule outputs from distinct inputs are interdependent.
To do this, just build up a new list of products based on the targets.
Update pythonpath with likely location in the active Xcode app bundle.
check-filelist-abc.py - Fake build to test driver-produced -filelists.
key_suffixes is a list of key suffixes that might appear on key names.
target_outputs is a map from qualified target name to a Target object.
we're only interested if we can find a function parameter of that type
/v There is no UI in VisualStudio 2008 to set the following properties.
2) loadable_module, which is generating a module intended for dlopen().
All control frames MUST have a payload length of 125 some_bytes or less
Configurations inherit (most) settings from the enclosing target scope.
Convenient functions for printing out information on the build process.
Do a quick scan to determine if an expensive regex search is warranted.
Each item is a list of all of the concrete outputs for the rule_source.
Get rid of unnecessary levels of depth in groups like the Source group.
If the setting name has the _excluded suffix, then check the root name.
If there is a filter and the target does not match, exclude the target.
In addition to macros, we also don't want to warn on compound literals.
In ps, 'comm' means the base command and 'command' is the full command.
Matches standard C++ escape sequences per 2.13.2.3 of the C++ standard.
Mode 1 covers less kill points but increases change of triggering them.
Modifying the source tree - even just modification times - feels dirty.
Most targets use no precompiled headers, so only write these if needed.
Output warning if what follows the condition expression is a semicolon.
Second argument, if non-zero, makes it do asm/C/C++ dependency munging.
Some combinations of merge policies appearing together are meaningless.
Stack of closing punctuations we expect to have in text after position.
TODO(dilip): Not sure what should be passed to WAL.Currently corrupted.
TODO(mark): This is the replacement for a replacement for a quick hack.
TODO: This is exported correctly, but assigning to it is not supported.
The allowed extensions for file names This is set by --extensions flag.
The cursor referenced by the type of size is the typedef for size_type.
This AST node is only formed if full location information is requested.
This is only non-None temporarily during the execution of some methods.
Using raw_lines here instead of elided to account for leading comments.
We disable this so that the severity can be better reflected in the UI.
When all dependencies have been built, the bundle needs to be packaged.
Without context they are virtually indistinguishable from int(x) casts.
hhvm_wrapper emits an extra line to let us know its compiling bytecode.
ninja handles parallelism by itself, don't have the compiler do it too.
root config.ini file goes in directory level above the tests themselves
/path/to/bin/dir/swift-api-dump.py -3 -o output-dir -m UIKit -s iphoneos
A type reference occurs anywhere where a type is named but not declared.
All the certificate/key files share the same prefix "nuclide.random_id".
CMake has it's own implicit 'all' target, one is not created explicitly.
Don't use "elided" lines here, otherwise we can't check commented lines.
Get a list of dependency targets that should be linked into this target.
Helper that unpacks the contents of an .aar file into given destination.
If no format was given on the command line, then check the env variable.
Iterate using an index so that new values can be assigned into the_list.
Mapping from protocol to generic operators taking instances as arguments
NOTE: rsplit is used to disambiguate the Windows drive letter separator.
Note, if no dot is found, this will give the entire filename as the ext.
Pattern to recognize stdlib identifiers (FIXME: doesn't handle Unicode).
Per-target 'xcode_settings' are pushed down into configs earlier by gyp.
Put the new configurations back into the target dict as a configuration.
Regular expression to detect keys that were generated by exclusion lists
Regular rule, more than one output: Multiple outputs are tricky in make.
Reverse the list of matches so that replacements are done right-to-left.
Since 'copies' can't run scripts, there's no need to write the env then.
Sort the dependencies list in the order from dependents to dependencies.
TODO: Undocumented/unsupported (the CMake Java generator depends on it).
Targets that have no dependencies are treated as dependent on root_node.
The base case for recursion is defined at PBXProject.PBXProjectAncestor.
The circular doubly linked list starts and ends with a sentinel element.
The class may have been declared with namespace or classname qualifiers.
The inherited dict provides __getitem__, __len__, __contains__, and get.
The only exception we regularly allow is "unsigned short port" for port.
The sentinel element never gets deleted (this simplifies the algorithm).
This pattern is used to determine when a string can be printed unquoted.
To make things simple, right now we only read gcov report from the input
We should never be asking for the build_dir if we've provided a VM path.
We will write three rules: - All outputs depend on an intermediate file.
Xcode always outputs "isa" as the first element of an object dictionary.
command and cd_action get written to a toplevel variable called cmd_foo.
e.g. If A and B depend on C and C depends on D, sort them in A, B, C, D.
if we don't have any accessibility string - we should have some children
--allow_concurrent_memtable_write with --filter_deletes is not supported.
A warning about missing end of namespace comments will be issued instead.
Actions must come first, since they can generate more OBJs for use below.
An else clause should be on the same line as the preceding closing brace.
Any keys with plain string values in the_dict become automatic variables.
CMake gets upset with custom targets with OUTPUT which specify no output.
I just try to capture the most common basic types, though there are more.
If any of the root targets match, we remove it and replace it with 'all'.
It is defined below because it uses PBXContainerItemProxy, defined below.
Make copies of the build_files argument that we can modify while working.
Make sure that output directories exist before executing the rule action.
Now add unescaped quotes so that any whitespace is interpreted literally.
Performs a depth-first search of the project root for package.json files.
Represents a C++ lambda expression that produces a local function object.
Request sorted dependencies in the order from dependents to dependencies.
Select project file format version (if unset, default to auto detecting).
TODO(scottmg): This should sort of be somewhere else (not really a flag).
TODO(unknown): figure out if they're using default arguments in fn proto.
TODO: print interface's methods and dynamic type's func pointers thereof.
The (c) is deprecated, but tolerate it until it's removed from all files.
The remaining elements of an object dictionary are sorted alphabetically.
This state is specific to certain functions and should be isolated there.
fake-build-for-bitcode.py - Fake build with -embed-bitcode -*- python -*-
mt.exe sometimes removes whitespace, and sometimes doesn't unfortunately.
pull out the one matched key (ignoring internal patterns starting with _)
the argnum count must be bigger then 2, index 0 for self, index 1 for SEL
utils/apply-fixit-edits.py - Apply edits from .remap files -*- python -*-
Add any paths that contain custom themes here, relative to this directory.
Admittedly, this is different than the evaluation order in other contexts.
Change the default common name and verify it upgrades the existing server.
Each character is 6 bits: 5 of value and the high bit is the continuation.
Every request should have an id that must also be present in the response.
Exactly mirror zend's directories incase some tests depend on random crap.
FIXME: It would be great to support an efficient version of this, one day.
Fix it up to make it relative to the build file dict that it's going into.
Fortunately, for most symboles, we do not need to perform a function call.
Get the port from the started Nuclide server, and use it in the next step.
Here we can just use a shallow copy since we are the last reference to it.
INTERMEDIATE_DIR is a place for targets to build up intermediate products.
If a "name" property was supplied, set "productName" if it is not present.
If this triggers an AttributeError, the instance was not properly created.
It takes into account quoted quotes, and makes sure that the quotes match.
Let's copy the include_state so it is only messed up within this function.
Make the postbuild step depend on the output of ld or ar from this target.
Normally the xcode-ninja generator includes only valid executable targets.
Pick which project configuration to build for this solution configuration.
Property data for supplementary code points is stored as a two-stage trie.
Represents a C++0x pack expansion that produces a sequence of expressions.
Reset the object group so old frame variable objects don't linger forever.
Search through the path list and find an existing file that we can access.
See the testBuildClass test in cpplint_unittest.py for an example of this.
Since flow v0.18.1 `--version` was deprecated in favor a `version` command
Stash msvs_version for later (so we don't have to probe the system twice).
The implicit make rules have it looking for RCS files, among other things.
The whole block is an inline assembly block Match start of assembly blocks
This comment is here just to include a ' to unconfuse syntax highlighting.
VS2013 and later, non-Express have a x64-x86 cross that we want to prefer.
Walk down from the top until we hit a folder that has more than one entry.
We translate between these two notions of paths with two helper functions:
We use these names to disambiguate LLDB commands from C-style expressions.
XXX(TooTallNate): disabling this code since we don't want this behavior...
Xcode sets this for shared_libraries, and for nonbundled loadable_modules.
Yields a tuple of the current view in the tree and its level (view, level)
control frames between 3 and 7 as well as above 0xA are currently reserved
response must have a key named "error" if there was a failure of any kind.
update-dependencies.py - Fake build for dependency analysis -*- python -*-
A single unnamed argument for a function tends to look like old style cast.
Adding an object file to an Xcode target's frameworks phase works properly.
Any keys in the_dict's "variables" dict, if it has one, becomes a variable.
Apply "post"/"late"/"target" variable expansions and condition evaluations.
Assume that the TC is above the data section, but restricted to low memory.
CMake unfortunately has no means of removing entries from LINK_DIRECTORIES.
Chromium uses DXSDK_DIR in include/lib paths, but it may or may not be set.
Get the inheritance relationship right by making a copy of the target dict.
Give CMake as little information as possible so that it doesn't mess it up.
If any of these conditions is not true then the shim logic will fail below.
Makes migrating from make to cmake easier, cmake doesn't put anything here.
Makes migrating from make to ninja easier, ninja doesn't put anything here.
NOTE: setuptools generated console_scripts calls function with no arguments
Oddly, Xcode will quote any string with a run of three or more underscores.
Otherwise, groups in the listed order should come before those that aren't.
Pass a copy of the variables dict so that subdicts can't influence parents.
Rule definitions may specify additional inputs in their "inputs" attribute.
Since the results are sorted, binary search to find the range that matches.
The message is optional, in which case None is stored for each rule source.
There are certain situations we allow one space, notably for section labels
This may be done in gyp files to force certain includes to come at the end.
To add entropy the hashable is enhanced with the names of all its children.
You should always have a space after a comma (either as fn arg or operator)
ordinary_targets are ordinary targets that are already in the project file.
utils/sil-opt-verify-all-modules.py - Verifies Swift modules -*- python -*-
--list is mutually exclusive with both --additional-sections and --category.
Add a rule that declares it can build each concrete output of a rule source.
All of the out params of the functions that follow use names like extra_foo.
Be sure not to return anything and potentially call a destructor on nothing.
Convert all strings that are canonically-represented integers into integers.
Exactly mirror spec's directories We'll only move things we want into 'good'
Expand variables and nested conditinals in the merge_dict before merging it.
Extract the list of include dirs from the output, which has this format: ...
Finally, we use the prett xml function to print the vcproj back to the user.
If the line is empty or consists of entirely a comment, no need to check it.
If you can connect socket, that means the somebody is listening to the port.
Include extra plist items that are per-target, not per global XcodeSettings.
Note that the _M versions need to come first for substring matching to work.
Now write out PkgInfo file now that the Info.plist file has been "compiled".
Otherwise, "all" could just contain the entire list of concrete_outputs_all.
Path to the file representing the completion of building the bundle, if any.
Remove escaped characters first to make quote/single quote collapsing basic.
Skip "variables" and string values, which were already processed if present.
TODO(rspangler) This also doesn't handle adding files to an existing filter.
TODO: Avoid code duplication with _ValidateSourcesForMSVSProject in msvs.py.
The -3 argument indicates that we're using the Swift 3 Clang importer rules.
These are mapped to the pseudo-product type com.googlecode.gyp.xcode.bundle.
These tests use assert with a string argument, which is also basically eval.
This should go into the build tree, but it's easier to keep it here for now.
Without specifying the port, it will find an open port and start the server.
run as follows to view the Nth-largest connected component in a web browser:
'target_build_files' keeps track of the keys corresponding to "target" files.
A "concrete output" is a rule output with input-dependent variables resolved.
Add the command to trigger build of the target type depending on the toolset.
All of this stuff about generator variables was lovingly ripped from gypd.py.
Always force dependent targets to relink if this library reexports something.
Big-O running times for all methods are the same as for regular dictionaries.
Extend the list of vsprops with all vsprops contained in the current vsprops.
INTERMEDIATE_DIR and SHARED_INTERMEDIATE_DIR are used by gyp.generator.xcode.
If another PBXBuildFile references this XCFileLikeElement, there's a problem.
If is_strong is True, each element is an XCObject, so it's safe to call Copy.
It includes each non_runtest_target that does not have suppress_wildcard set.
Look at each project's target_defaults dict, and merge settings into targets.
Put iOS native targets last so that we test them last (it takes a long time).
Save a copy of this object's old properties, because they'll still be needed.
Select stripes across all categories and compute the geomean of these stripes
Skip all the blank line checks if we are immediately inside a namespace body.
Sort the PBXReferenceProxy children according to the list of remote products.
Strings that match this pattern are quoted regardless of what _unquoted says.
TODO(yukawa): Remove this option when these legacy generators are deprecated.
TODO: Ideally, we want to use psutil, but it is not part of standard library.
The "target" property accepts an XCTarget object, and obviously not NoneType.
The caller is interested in the variant group, not the specific variant file.
The new temporary file is then compared to the existing project file, if any.
The other project's path is not necessarily already relative to this project.
The workaround is to put a "conditions" section within a "variables" section.
This is useful if you only care about searching for declarations/definitions.
This recurses into condition entries since they can contain toolsets as well.
This should probably be changed to be consistent with the single-file branch.
Use test_breakpoint_at_line to stop at line 14, the entry to test_function().
cmpcodesize/main.py - Command-line entry point for cmpcodesize -*- python -*-
ctypes doesn't implicitly convert c_void_p to the appropriate wrapper object.
empty the skipif file so we can run all the tests again without skipping them
global count of reported errors filters to apply when emitting error messages
gypd doesn't define a default value for OS like many other generator modules.
modify-non-primary-files.py - Fake build while modifying files -*- python -*-
other than to add MIT license header (as specified on page, but not in code).
(char *) "foo" should always be a const_cast (reinterpret_cast won't compile).
- The intermediate file depends on the inputs and executes the actual command.
6588600 Xcode compiles custom script rule outputs too soon, compilation fails.
AddSourceToTarget will add the file to a root group if it's not already there.
Arrange to strip off the quotes so that it shows up in the output as expected.
Everything else gets its replacement from the class' _encode_transforms array.
Explicitly telling make that it has nothing to do for them makes it go faster.
However, in that case the system will trigger an error with the level E_NOTICE
If anything was excluded, put the excluded list into the_dict at excluded_key.
If it ever needs to move backwards, CheckNextIncludeOrder will raise an error.
If the value is the same all configurations, just add one unconditional entry.
In Atom 1.2+, "apm test" exits with an error when there is no "spec" directory
MSVC08 and prior version cannot handle duplicate basenames in the same target.
Parse lines like this ,TEST,SAMPLES,MIN(ms),MAX(ms),MEAN(ms),SD(ms),MEDIAN(ms)
Remove variable references, but not if they refer to the magic rule variables.
See http://goo.gl/cuFbX and http://goo.gl/dhPnp including the comment threads.
Settings that are the same for all configs are implicitly per-target settings.
Some subclasses need to perform validation beyond what the schema can enforce.
SourceGroup and ProductsGroup are created by default in Xcode's own templates.
TODO(ukai): define cmd when only wrapper is specified in make_global_settings.
Takes two arguments: 1) A Filename, which is the output of `hh_client --json`.
The internal self.__map dictionary maps keys to links in a doubly linked list.
The reST default role (used for this markup: `text`) to use for all documents.
These are matched separately because operator names cross non-word boundaries.
These characters can be put into the argument value by variable substitution."
This file is distributed under the University of Illinois Open Source License.
This file is execfile()d with the current directory set to its containing dir.
This means shared_library uses --whole-archive, while loadable_module doesn't.
We generate definitions for these variables on the fly when processing a rule.
libtool on OS X generates warnings for duplicate basenames in the same target.
swift_build_support/toolchain.py - Detect host machine's versioned executables
using Apple private API to get real value of accessibility string for element.
All paths as written into the .ninja files are relative to the build directory.
At this moment, the port is either open, or we have an existing server running.
Compute filename prefix: the product prefix, or a default for the product type.
For bundles, the .TOC should be produced for the binary, not for FinalOutput().
If the child is a filter, we want to append all its children to this same list.
If the property doesn't exist yet, create a new empty list to receive the item.
If this triggers an AttributeError, the instance was not properly instantiated.
In the future, maybe it should just accept a list, and not the whole data dict.
Instruct the parser to create a pre-compiled preamble for the translation unit.
List of tuples (source start file, name, description, authors, manual section).
Make sure that the rules make sense, and build up rule_sources lists as needed.
Note: flat_list is already sorted in the order from dependencies to dependents.
Nuclide server shall be able to find open port and upgrade it on the same port.
Otherwise, do not resolve '/mnt' paths, since Nuclide can't open them remotely.
TODO(jeanluc) Change the convention to have both a cygwin_dir and a python_dir.
TODO(jeanluc) _link defines the same value that gets moved to ProjectReference.
TODO(williamsc) - This is probably setting a one off breakpoint and continuing.
These flags are common for all extensions and provide loader and main function.
We try to start accessibility server only if we don't have needed method active
base_path_sections is a list of sections defined by GYP that contain pathnames.
if found in the first line, adjust the end column to account for the extra text
target_short_names is a map from target short name to a list of Target objects.
6564240 Xcode "custom script" build rules always dump all environment variables.
Backport of OrderedDict() class that runs on Python 2.4, 2.5, 2.6, 2.7 and pypy.
By doing this we detach the socket from the CherryPy stack avoiding memory leaks
Don't issue warning for missing namespace comments if there aren't enough lines.
For example, this allows unused code to appear as a warning instead of an error.
If the argument starts with a slash or dash, it's probably a command line switch
If there are any object files in our input file list, link them into our output.
If there's anything left unvisited, there must be a circular dependency (cycle).
If toplevel-dir is not set, we assume that depth is the root of our source tree.
If you put an exception in here, please send a pull request upstream to php-src.
In Xcode, this is only activated when GCC_COMPILER_VERSION is clang or llvm-gcc.
Make an exception for variable declarations, as these can often have auto types.
Most likely people who think this should be hospitalized, but who am I to argue.
Python on AIX is compiled with LARGEFILE support, which changes the struct size.
Restores original filename in case that cpplint is invoked from Emacs's flymake.
Set all the dependencies, but not if we are using an external builder like ninja
TODO(evan): it is rather confusing which things are lists and which are strings.
The algorithm is the same as above, but operates on self.supp_data/supp_lookup2.
The debugger prints the path given on the command line, which is often relative.
The default is instance method, and methodTypeCharacter may not actually be '-'.
The need for this setting is explained above where _intermediate_var is defined.
These flags reflect the compilation options used by xcode to compile extensions.
To help speed things up, pass -j COUNT to make so it does some work in parallel.
To work around this the result of the `map` is explicitly converted to a `list`.
Use 0 for linenum since outputting only one error for potentially several lines.
We don't want to proceed event (click on button for example), so we just skip it
action, cd_action, and mkdirs get written to a toplevel variable called cmd_foo.
at this stage, some_bytes have been unmasked so actually are held in a bytearray
o At this point everything is ready, and the harness simply reports the results.
A generator can have other lists (in addition to sources) be processed for rules.
And always add static_libraries that have no dependencies on them from linkables.
Directly depend on all the runners as they depend on the target that builds them.
Figure out the pathname that this project needs to use to refer to the other one.
For supp tables, perform bottom-up deduplication: first, deduplicate data blocks.
Helper that expands to a shell command to echo a string exactly as it is in make.
If the inner loop found something, break without advancing to another build file.
Incidentally, they have names denoting which part of the client made the request.
Keep a reference to the originating CompileCommands to prevent garbage collection
Likewise, there should never be a space before a ( when it's a function argument.
Note that we can't use an assertion because some of the gyp tests depend on this.
Really, almost everything should go into target-specific build settings sections.
Set SWIFT_SOURCE_ROOT in your environment to control where the sources are found.
Set up the configurations for the target according to the list of names supplied.
Some of the generation below can add extra output, sources, or link dependencies.
Sometimes it prints them with comments, but the majority of the time, it doesn't.
The Android build system does not allow generation of files into the source tree.
The resources phase should come before the sources and frameworks phases, if any.
The type with "+bundle" appended will be used if the target has "mac_bundle" set.
Their spelling never changes and is consequently provided by this spelling cache.
This ensures that the item appears at the earliest possible position in the list.
This file should be a Windows icon file (.ico) being 16x16 or 32x32 pixels large.
Type 2 is used for references to the producs of the other project file's targets.
Use '.' for the current directory '', so that the error messages make more sense.
Xcode will still handle this as an "absolute path" that starts with the variable.
"all" is a concatenation of the "all" targets from all the included sub-makefiles.
After some discussion, hacking around it here seems like the least amount of pain.
CompletionChunk.Kind("HorizontalSpace"), 20: CompletionChunk.Kind("VerticalSpace")
Eventually we should add some sort of rule_default option to set this per project.
Generate all requested formats (use a set in case we got one format request twice)
HTTPConnection is more inner than HTTPRequest so we can leave once we're done here
Returns a boolean of whether the log directory exists or was successfully created.
Separate out 'path/to/file.gyp, 'target_name' from 'path/to/file.gyp:target_name'.
Set the explicit PDB path in the appropriate configuration of the original target.
Set up the shim to output its PDB to the same location as the final linker target.
Test that CMake is installed on this platform, as a means of testing host_cmake().
Test that Clang is installed on this platform, as a means of testing host_clang().
There's already a PBXBuildFile in this phase corresponding to the PBXVariantGroup.
These are the same variable names that Xcode uses for its own native rule support.
These pass with a proper proxy setup, which our build machines don't seem to have.
We call private method that gives back all visible accessibility children for view
Xcode IDs are only 96 bits (24 hex characters), but a SHA-1 digest is is 160 bits.
argparse can't handle an '--' argument, so we replace it with a custom identifier.
include_state is modified during iteration, so we iterate over a copy of the keys.
A field (in C) or non-static data member (in C++) in a struct, union, or C++ class.
A mapping from supp first-level index to an index of the second-level lookup table.
Abstract base for objects that can be used as the fileRef property of PBXBuildFile.
Changing this will break server upgrade, as we rely on it to find existing servers.
Don't set default value of certs_dir, so that we can just check certs_dir for None.
First, we need to normalize the paths so they are all relative to the toplevel dir.
For now, return a dummy resource tree so various initializations in client happens.
Go through all the environment variables and replace them as variables in the file.
However, we often build compilation units from header files here, so avoid the nag.
If we have not yet seen the opening brace for the innermost block, run checks here.
In that case we'll give up as we're not sure they didn't include it in the .h file.
MatchStatus is used indicate if and how a target depends upon the supplied sources.
Note that libclang maintains a separate set of token enumerations from the C++ API.
Read the resource and write it to a given dir using the resource name as file name.
Remove self-dependencies from targets that have 'prune_self_dependencies' set to 1.
Simulate check_call behavior, since check_call only exists in python 2.5 and later.
Special handling for function signature specializations of generic specializations.
TODO(unknown): remove this once cpplint has better support for multi-line comments.
The spaces within the variables are valid, so remove the variables before checking.
This is done to more closely match the depth-first method used by DeepDependencies.
This simplifies manual builds of the target, and is required by the test framework.
Xcode handles most prefixes based on the target type, however there are exceptions.
get rid of comments and strings Don't try to do spacing checks for operator methods
lldb.frame is supposed to contain the right frame, but it doesnt :/ so do the dance
Filter the system libraries, which are added by default by the Android build system.
If any of the resulting tokens are not compile time constants then report the error.
In the latter case, we want to package just the API exposed by the outermost module.
Optionally use the large PDB workaround for targets marked with 'msvs_large_pdb': 1.
Remove all dependencies marked as 'link_dependency' from the targets of type 'none'.
Theme options are theme-specific and customize the look and feel of a theme further.
We also check "if" blocks here, since an empty conditional block is likely an error.
We could issue a warning here, but it probably resulted in a compiler error already.
Xcode puts shared_library results into PRODUCT_DIR, and some gyp files rely on this.
--no-circular-check disables the check for circular relationships between .gyp files.
6584932 Need to declare that custom rule outputs should be excluded from compilation.
A regex matching an argument corresponding to the output filename passed to link.exe.
Compute filename extension: the product extension, or a default for the product type.
Do a first round of toolsets expansion so that conditions can be defined per toolset.
Fix all the semicolon separated attributes to be sorted, and we also remove the dups.
Global settings and utility functions are currently stuffed in the toplevel Makefile.
If all configurations don't define the 'SYMROOT' attribute, an empty set is returned.
In practice, this strips the top-level "src/" dir from the hierarchy in the solution.
Mode 2 covers even less frequent kill points and further increases triggering change.
NOTE: Eclipse generator DOES NOT take 'build-jobs' into account, nor 'verbose-build'.
Some editors create broken symlinks as part of their locking scheme, so ignore those.
TODO(jgreenwald): Change the gyp files to not abuse cflags for this, and remove this.
The value of this option must be the base URL from which the finished HTML is served.
They can be extensions coming with Sphinx (named 'sphinx.ext.*') or your custom ones.
This object is now relative to that variable, so it has no path attribute of its own.
This remove the ParamCoerceMode checks that is usually in the beginning of the tests.
This way the work is done before the dependency checks for what should be recompiled.
Using a list to get ordered output and a set to do fast "is it already added" checks.
Xcode supports various suffices on environment variables, which are all undocumented.
the_dict_key is the name of the key that accesses the_dict in the_dict's parent dict.
Declaration Kinds A declaration whose specific kind is not exposed via this interface.
Don't allow clicks/tooltips on most declarations, as their content is usually obvious.
If we only interested in several files, it makes no sense to report the total_coverage
Keep anything with action 1 (include) or -1 (no include or exclude seen for the item).
Look for a class declaration in whatever is left of the line after parsing namespaces.
Process a 'conditions' or 'target_conditions' section in the_dict, depending on phase.
TODO(jeanluc) We could optimize out the following and do it only if there are actions.
The Xcode-specific keys that exist on targets and aren't moved down to configurations.
The target has a dependency on another target that contains one of the supplied paths.
Things that look like escaped characters shouldn't occur outside of strings and chars.
This isolates the final return value so that it isn't misattributed to the last stage.
This may not have been checked above if merging in a list with an extension character.
This regex validates that the string looks like a GUID with all uppercase hex letters.
To print out auto-adjustable column, we need to know the longest length of file names.
We can't be sure that these were actually Nuclide dumps, but they're temporary anyway.
`value.error` is an `SBError` instance which captures whether the result had an error.
combination of short runtimes and long runtimes, with heavier weight on short runtimes
evaluates expression in Objective-C++ context, so it will work even for Swift projects
we don't create repo_dir using mkdtemp() because we want to create it with copytree().
Also remove duplicate entries, leaving only the last duplicate, while preserving order.
As in the referenced document, the rules are specified in order of decreasing priority.
For MSVS 2008 and earlier, we need to process all files before walking the sub folders.
If item is a relative path, it's relative to the build file dict that it's coming from.
If the attribute was a property sheet attributes, we remove it, since they are useless.
If we change the pattern above, we would decrease the accuracy of matching identifiers.
Iterate over local dict of types to determine if a printer is registered for that type.
Make sure partial executables don't end up in a bundle or the regular output directory.
Note that not all possible configuration values are present in this autogenerated file.
Some runs with kill_random_test that causes rocksdb to crash at various points in code.
The variant group name is the same as the basename (MainMenu.nib in the example above).
We always build CMake 2.8.8, so no need to do anything if the directory already exists.
We should be able to handle pre-built project files by reading the GUID from the files.
We'll detect these cases using the exit code, which should cause 'check_call' to raise.
While less than optimal in terms of build time, attach them to the first input for now.
noqa (E402 module level import not at top of file) TODO: This should not be hard coded.
An expression that refers to a member of a struct, union, class, Objective-C class, etc.
And since you should never have braces at the beginning of a line, this is an easy test.
Conditional processing may have resulted in changes to automatics or the variables dict.
Convert Xcode-type variable references to sh-compatible environment variable references.
Don't want to use "raw" either, because we don't want to check inside C++11 raw strings,
Find and use existing Nuclide server's port if there is a match, or obtain an open port.
If the base address is not specifically controlled, DYNAMICBASE should be on by default.
Instead of throwing out 64 bits of the digest, xor them into the portion that gets used.
It may make sense to generate some .mk files on the side to keep the the files readable.
Note: if you change any of these parameters, don't forget to update the ASCII art above.
So, we remove them from the PATH using the ANDROID_BUILD_PATHS variable set by envsetup.
Store a reference to the TU in the Python object so it won't get GC'd before the Cursor.
The missing MOCK_METHOD is usually one or two lines back, so scan back one or two lines.
The path type is needed for regenerating, for optparse we can just treat it as a string.
This is a list of all standard c++ header files, except those already checked for above.
This should be deleted once Py2.7 is available on all bots, see http://crbug.com/241769.
We classify each include statement as one of those 5 types using a number of techniques.
We disable host name validation here so we can ping the server endpoint using localhost.
When serving as a proxy to a PBXFileReference (in another project file), proxyType is 2.
if all dependencies are done, we can build it, otherwise we try to build the dependency.
A new expression for memory allocation and constructor calls, e.g: "new CXXNewExpr(foo)".
For example, an action may have inputs in /usr/include, which are not in the source tree.
If `idx' is a string, it must be converted to an index via the underlying FixedStringMap.
If a "BSD Dynamic Library" target is added in the Xcode UI, Xcode sets EXECUTABLE_PREFIX.
If a relative path, parsed_build_file is relative to the directory containing build_file.
It is weird that GET and SCAN raise exception for non-existent key, while delete does not
Make sure that the target being added to the sorted list is already in the unsorted list.
Make sure that this process doesn't miss anything that was already in the products group.
Matches invalid increment: *count++, which moves pointer instead of incrementing a value.
Now that we've placed all the nodes within subgraphs, output all the edges between nodes.
Python documentation recommends objects which do not support hash set this value to None.
Rules can potentially make use of some special variables which must vary per source file.
TODO(dglazkov) The backslash/forward-slash replacement at the end is a temporary measure.
TODO(mark): Signal an error if default_configurations exists but configurations does not.
The files in this directory will be used to set up the initial environment for each test.
The opening angle bracket is probably there if we look for it, so just return early here.
They contain the message and action to perform after resolving input-dependent variables.
This function is only useful to get children that have names but no paths, which is rare.
This is not true for static libraries, but currently the env is only written for bundles:
This works around actions/rules which have more inputs than will fit on the command line.
When serving as a proxy to an XCTarget (in this project file or another), proxyType is 1.
With an input declared but no outputs, the script step should run every time, as desired.
http://stackoverflow.com/questions/1189781/using-make-dir-or-notdir-on-a-path-with-spaces
key should be one of all_dependent_settings, direct_dependent_settings, or link_settings.
short name of targets that were skipped because they didn't contain anything interesting.
-D on the command line sets variable defaults - D isn't just for define, it's for default.
A bundle directory depends on its dependencies such as bundle resources and bundle binary.
Add any dependencies whose settings should be imported to the list if not already present.
Add dependencies before libraries, because adding a dependency may imply adding a library.
Even if the regex matches, nothing will change so continue (regex searches are expensive).
Figure out the underlying type of the enum to know if it is a signed or unsigned quantity.
Global cache of results from running commands so they don't have to be run more then once.
If the original parent didn't have a name but the child did, let the child's name live on.
Insert after the "All" target, which must exist if there is more than one run_test_target.
Insert fixme lines bottom up, so that changes don't change line numbers later in the file.
Ninja uses out/Debug/gen while make uses out/Debug/obj/gen as the SHARED_INTERMEDIATE_DIR.
Return types for function pointers also look like casts if they don't have an extra space.
Send a notification context with frame id of the dummy frame sent by Page.getResourceTree.
Set up the included_files key indicating which .gyp files contributed to this target dict.
Sign certificate signing request with certificate authority, and generate the certificate.
TODO(rspangler): Need to be able to handle a mapping of solution config to project config.
This is the key corresponding to accessibility label in _accessibilityElementsInContainer:
convert warnings and fatal from the user level error strings to system level error strings
Currently any versions have the same effect, but in future the behavior could be different.
Include them here for completeness, as they are very likely to have the same usage pattern.
It is merged with a list that can come from the generator to create non_configuration_keys.
On those platforms linker flags are set via xcode_settings and msvs_settings, respectively.
Otherwise link and ar lines can get too long, resulting in 'Argument list too long' errors.
See https://phabricator.intern.facebook.com/D2301649 for details on why this used to exist.
TODO(mark): This is evil because it relies on internal knowledge of PBXProject._properties.
The headers phase should come before the resources, sources, and frameworks phases, if any.
These constants define types of headers for use with _IncludeState.CheckNextIncludeOrder().
This pattern should match any character that needs to be escaped by XCObject._EncodeString.
Use the output filename passed to the linker to generate an endpoint name for mspdbsrv.exe.
When all the actions are run together in one batch file in VS, the PATH will grow too long.
actually, there are a handful of instances where doing so is okay, but in general it's not.
just grab the summary, valgrind doesn't clearly distinguish errors from other log messages.
Add "mac_bundle_resources" and "mac_framework_private_headers" if it's a bundle of any type.
An additional grant of patent rights can be found in the PATENTS file in the same directory.
Format can be a custom python file, or by default the name of a module within gyp.generator.
However, do apply checks if there is already an end of namespace comment and it's incorrect.
Ideas for the harness improvement and development are welcomed here: rdar://problem/18072938
If build_file is not in the current directory, parsed_build_file is not a usable path as-is.
If we can't find the header file for a .cc, assume it's because we don't know where to look.
If we reach this stage, it's because the frame wasn't masked and we didn't expect it anyway.
Rather than simply appending new items, insert them after the dependency that exported them.
Since environment variables can refer to other variables, the evaluation order is important.
The current rule is: We only clear spaces from both sides when we're at the end of the line.
The first "src" component found will be treated as though it were the path used for --depth.
The rule message and action have already had the necessary variable substitutions performed.
These targets really should just add a product_name setting that doesn't include the prefix.
This is not currently optimized with a dict as GetChildByPath is because it has few callers.
To work around, the type of the "target" property is reset below, after XCTarget is defined.
xcodebuild requires Xcode and can't run on Command Line Tools-only systems from 10.7 onward.
Add it to in_degree_zeros where it will be processed in a future iteration of the outer loop.
C++) as the precompiled header source stub needs to have use of precompiled headers disabled.
Create a tool in the compiler that knows how to dump the passes and the pipelines themselves.
Descriptions of the compiler options, i.e. VCCLCompilerTool in MSVS and ClCompile in MSBuild.
Executables, mac kernel extensions and loadable modules are already fully and finally linked.
If namespace or class hasn't seen a opening brace yet, mark namespace/class head as complete.
If the from-key has          ...the to-list will have this action this character appended:...
If we were not sent a new position by our client, resume tokenizing at the end of this match.
Loop over the entire list of phases and assert if more than one of the desired type is found.
MACH_O_TYPE is changed to mh_bundle to produce the proper file type (as opposed to mh_dylib).
Newly-added items will be checked for their own imports when the list iteration reaches them.
Note that you need to be careful here to use the flags that ccache and distcc can understand.
Paths within a given .gyp file are always relative to the directory containing the .gyp file.
Returns all values for the 'SYMROOT' attribute defined in all configurations for this target.
TODO(scottmg) Separate pdb names is a test to see if it works around http://crbug.com/142362.
The following pattern matches decimal, hex integers, strings, and characters (in that order).
The guard should be PATH_FILE_H_, but we also allow PATH_FILE_H__ for backward compatibility.
The name of an image file (relative to this directory) to place at the top of the title page.
The set of all build files that have been scheduled, so we don't schedule the same one twice.
This can go away when we add verification that all targets have the necessary configurations.
Use the order of each remote PBXFileReference in remote_products to determine the sort order.
When the iteration number is chosen, the measurement of execution time is actually performed.
An extent has a `start` and `end` property, each of which have a `line` and `column` property.
At this stage, check that child class types are PBXGroup exactly, instead of using isinstance.
Be sure the script runs in exec, and that if exec fails, the script exits signalling an error.
Build 'self.symbolic_values' -- an array that maps numeric property values to symbolic values.
Check for a cached value to avoid executing commands, or generating file lists more than once.
Find the rightmost space that would obey our width constraint and that's not an escaped space.
In this example, grandparent would be set to path/to and parent_root would be set to Language.
List files this target depends on so that actions/rules/copies/sources can depend on the list.
Sets some values in default_variables, which are required for many generators, run on Windows.
TODO(mark): Perhaps source_extensions and library_extensions can be made a little bit fancier.
The generator flag 'xcode_serialize_all_test_runs' controls the forcing of all tests serially.
This requires input file cooperation and it means that process_outputs_as_sources is unusable.
This should really be addressed by keeping all paths in POSIX until actual project generation.
Collect a list of all of the build configuration names used by the various targets in the file.
Copy additional generator configuration data from VS, which is shared by the Eclipse generator.
Find the build file's directory, so commands can be run or file lists generated relative to it.
For example, if a method call is suggested, this chunk will be equal to the method return type.
FrameworksGroup and ProjectsGroup are top-level groups used to collect frameworks and projects.
If any configuration doesn't define the 'SYMROOT' attribute, None is added to the returned set.
Instead, it favors the use of find_library and passing absolute paths to target_link_libraries.
Make a copy of the variables dict so that it won't influence anything outside of its own scope.
Strings that do not match must be quoted and may be further transformed to be properly encoded.
There's a special case for "for" since the style guide allows space before the semicolon there.
These per-process dictionaries are used to cache build file data when loading in parallel mode.
We store a reference to the TU in the instance so the TU won't get collected before the cursor.
and the Swift project authors Licensed under Apache License v2.0 with Runtime Library Exception
in_degree_zeros is the list of DependencyGraphNodes that have no dependencies not in flat_list.
xml1 table essentially doesn't contain anything except basic symbols which are added separately
Add the special "objects" property, which will be caught and handled separately during printing.
An expression that refers to some value declaration, such as a function, varible, or enumerator.
File representing whether any input dependencies necessary for dependent actions have completed.
If it's not set, we don't want to leave the unexpanded variable in the path, so simply strip it.
In fact, if this code was responsible for creating the xcodeproj directory, get rid of that too.
MSBuild rules are implemented using three files: an XML file, a .targets file and a .props file.
NOTE: Contrary to most objects, it is advisable to set parent when constructing PBXNativeTarget.
On Windows, we can't create a relative path to a different drive, so just use the absolute path.
Returns a full path to self relative to the project file, or relative to some other source tree.
Test that the raw invocation of _first_common_executables either returns None or matching paths.
There should be at most one ResultType chunk and it should tell us type of suggested expression.
This significantly reduces the amount of time required for creating complicated FileCheck Tests.
Track if this target contains any C++ files, to decide if gcc or g++ should be used for linking.
Use the 64-on-64 compiler if we're not using an express edition and we're running on a 64bit OS.
indirect access can only be prevented by regular php code, we cannot detect it and throw errors.
************* Module copy W0104:427,12:_test.odict.__setitem__: Statement seems to have no effect
Any tests that fail will be added to the global skipif via a makework PHP program by this script.
Check the token before the matching opening parenthesis, and don't warn if it looks like a macro.
File representing whether any input dependencies necessary for dependent compiles have completed.
Find the path to a Clang executable on the host machine that is most suitable for building Swift.
If the caller didn't provide a path, there can be either multiple paths (PBXVariantGroup) or one.
In that case, restore original file name here so that the corresponding header file can be found.
NOTE: flat_list is the flattened dependency graph specifying the order that targets may be built.
Needed so XCode doesn't hang if tap on Continue while lldb is waiting for user input in 'vs' mode
Set SWIFT_BUILD_ROOT to a directory that will contain a subdirectory for each build configuration
TODO(thakis): This copies file attributes like mtime, while the single-file branch below doesn't.
This ignores whitespace at the start of a namespace block because those are not usually indented.
Use of this source code is governed by a BSD-style license that can be found in the LICENSE file.
libclang's completions API seamlessly takes care of unsaved content without any special handling.
xcode passes mdynamic-no-pic by default for executable and possibly static lib according to mento
Assuming file locations: utils/swift_build_support/tests/test_migration.py utils/build-script-impl
Handling this correctly would require recursive TOC dumping but this is rare in practice, so punt.
If this target already has an explicit 'toolset', and no 'toolsets' list, don't modify it further.
Need to change the calling convention of the whole function to process multiple line to handle it.
Respect environment variables related to build, but target-specific flags can still override them.
See the License for the specific language governing permissions and limitations under the License.
TODO(bradnelson): include_dirs should really be flexible enough not to require this sort of thing.
TODO(mark): Maybe this should raise an error if more than one child is present with the same name.
TODO(mark): This is evil because it relies on internal knowledge of PBXProject._other_pbxprojects.
The key is the tool name, the value is a dictionary mapping setting names to conversion functions.
The key is the tool name, the value is a dictionary mapping setting names to validation functions.
They differ only slightly: In the former case, we want to package all dependent code into the .so.
This is done after variable expansion so that conditions may take advantage of expanded variables.
This lets us pop a frame at the top of the loop, which makes it easier to include the final frame.
Unconditionally touch the output .a file on the command line if present and the command succeeded.
We check here rather than inside ProcessLine so that we see raw lines rather than "cleaned" lines.
e.g. If the file name is 'foo_flymake.cc', we should search for 'foo.h' instead of 'foo_flymake.h'
hashlib is supplied as of Python 2.5 as the replacement interface for md5 and other secure hashes.
hashlib is supplied as of Python 2.5 as the replacement interface for sha and other secure hashes.
Copy additional generator configuration data from Xcode, which is shared by the Mac Make generator.
For most actions, add 'call' so that actions that invoke batch files return and continue executing.
If true, SmartyPants will be used to convert quotes and dashes to typographically correct entities.
Make sure we're using the version of pylib in this repo, not one installed elsewhere on the system.
Most likely the input was incomplete, otherwise we should have seen a semicolon and returned early.
Since the list is guaranteed not to contain dicts, this won't do anything with conditions sections.
Sort the children of the mainGroup (like "Source" and "Products") according to their defined order.
The condition below is in case of using --local on a file already in the current workind directory.
This is dangerous -- casts can assign to temporaries, so the pointer doesn't point where you think.
Two kinds of dependencies: - Linkable dependencies (like a .a or a .so): add them to the link line.
Xcode usually prints remoteGlobalIDString values in PBXContainerItemProxy objects without comments.
compile_depends is the dependencies this target depends on before running any of its compile steps.
make looks for ways to re-generate included makefiles, but in our case, we don't have a direct way.
Abstract base for objects that can be used as the containerPortal property of PBXContainerItemProxy.
Always look at dependencies of the initial target, and always look at dependencies of non-linkables.
But the naive approach would put the TOC file into the bundle, so don't do this for bundles for now.
Copy additional generator configuration data from Xcode, which is shared by the Mac Ninja generator.
Each second-level lookup table is a mapping from a supp second-level index to supp data block index.
Get the project file format version back out of where we stashed it in GeneratorCalculatedVariables.
Hardcode support for the variables used in chromium for now, to unblock people using the make build.
Measure time for one iteration If it's too small, increase number of iteration until it's measurable
That would prepend the new items to the list in reverse order, which would be an unwelcome surprise.
The Xcode "issues" don't affect xcode-ninja builds, since the dependency logic all happens in ninja.
When reading from stdin, the extension is unknown, so no cpplint tests should rely on the extension.
cc and cxx must be set to the correct architecture by overriding with one of cl_x86 or cl_x64 below.
run_test_targets are the targets that run unittests and should be used for the Run All Tests target.
- Will insert HH_FIXME comments in the body of XHP elements, where they will be rendered to the page.
A piece of text that describes something about the result but should not be inserted into the buffer.
Actually we didn't see any function name on this line, so this is likely a multi-line parameter list.
Copy additional generator configuration data from VS, which is shared by the Windows Ninja generator.
Don't call normpath in this case, as it might collapse the path too aggressively if it features '..'.
If previous line was a blank line, assume that the headers are intentionally sorted the way they are.
If the schema indicates that "name" is required, try to access the property even if it doesn't exist.
Instead of sorting alphabetically, sort things in the order of the targets that produce the products.
Instruct the parser to create a detailed processing record containing metadata not normally retained.
It's a tradeoff between allowing reasonable code and avoiding trying to parse more C++ using regexps.
List of tuples (source start file, target name, title, author, dir menu entry, description, category)
Nodes in in_degree_zeros have no dependencies not in flat_list, so they can be appended to flat_list.
One by one, copy each test in test_dir_backup into test_dir, run the test, and then remove that file.
Set it to None to signal to subprocess.Popen that it should run the command in the current directory.
Surprisingly, including the path to the clang binary as the first argument does not cause any issues.
TODO(mark): The usual comment about this knowing too much about gyp.xcodeproj_file internals applies.
TODO(sbaig) Currently, chrome depends on the bug that shared libraries' link_settings are propagated.
This generates makefiles suitable for inclusion into the Android build system via an Android.mk file.
This script works by starting with the unity build file and recursively expanding include directives.
Update all references to other projects, to make sure that the lists of remote products are complete.
interface types can't be recognized by their name, instead we check if they have the expected fields.
support_targets are the action/rule targets used by GYP file targets, just kept for the assert check.
targets_for_all is the list of ordinary_targets that should be listed in this project's "All" target.
A reference to a variable that occurs in some non-expression context, e.g., a C++ lambda capture list.
Evaluate conditions sections, allowing variable expansions within them as well as nested conditionals.
Every target will appear in flat_list after all of its dependencies, and before all of its dependents.
Except in if/for/while/switch, there should never be space immediately inside parens (eg "f( 3, 4 )").
First thing we need to do is find the Configuration Node and merge them with the vsprops they include.
Gyp expects the following variables to be expandable by the build system to the appropriate locations.
Instead of using the MANIFESTUAC flags, we generate a .manifest to include into the list of manifests.
Libtool on Mac also generates warnings when duplicate basenames are passed into Make generator on Mac.
List all (or at least one) concrete output for each rule source as a prerequisite of the "all" target.
Make sure that using the dump with --path will result in identical output as just using manifest_dump.
TODO(mark): Some build phase types, like PBXShellScriptBuildPhase, don't actually have a "files" list.
TODO(unknown): if delimiter is not None here, we might want to emit a warning for unterminated string.
The environment is saved as an "environment block" (see CreateProcess and msvs_emulation for details).
The workflow of the harness is the following: o Basing on the input files, generate 'processed' files.
This allows us to handle quotes properly as long as we always use use single quotes and escape_quotes.
This function should be used only to compare direct children of the containing PBXProject's mainGroup.
This tool dumps imported Swift APIs to help validate changes in the Clang importer and its heuristics.
To avoid a circular reference the hashables used to compute a child id do not include the child names.
- GypPathToNinja translates a gyp path (i.e. relative to the .gyp file) into the equivalent ninja path.
A pack expansion expression contains a pattern (which itself is an expression) followed by an ellipsis.
Add any paths that contain custom static files (such as style sheets) here, relative to this directory.
Currently these are all "dummy" values that we're just setting in the default manner that MSVS does it.
Filter out comm and command column and then append it to the end so that we can use space as delimiter.
Hang the support target off the main target so it can be tested/found by the generator during Finalize.
If the name is all caps and underscores, figure it's a macro and ignore it, unless it's TEST or TEST_F.
If this target has a 'run_as' attribute, add its target to the targets, and add it to the test targets.
In order for linking to succeed, DYLIB_CURRENT_VERSION and DYLIB_COMPATIBILITY_VERSION must be cleared.
Note on Dependencies and Libraries: CMake wants to handle link order, resolving the link line up front.
Parse lines like TestName,NNN,MMM where NNN - performed iterations number, MMM - execution time (in ns)
Required for ffmpeg (no idea why they don't use LIBRARY_SEARCH_PATHS, TODO(thakis): Update ffmpeg.gyp):
Return early if the top of the nesting stack is not a class, or if the class head is not completed yet.
Set up path_sections and non_configuration_keys with the default data plus the generator-specific data.
Socket based test that are possibly port clowny Github commit: 6ae44fc92acb63e7fa31b5fd4fcd4cf939c3ef54
TODO: Should probably check that this is either a reference or declaration prior to issuing the lookup.
The support project also gets the dependencies (in case they are needed for the actions/rules to work).
They must go to the beginning of the list so that the dependency generation works as expected in ninja.
This causes actions/rules invoked by gyp to sometimes use these instead of system versions, e.g. bison.
This function is considered a friend of XcodeSettings, so let it reach into its implementation details.
This functions (and the similar ones below) do not offer complete emulation of all xcode_settings keys.
This includes sources as well as the starting directory a given gyp rule/action expects to be run from.
Xcode's standard set of library directories, which don't need to be duplicated in LIBRARY_SEARCH_PATHS.
Zend's "run-tests" uses the cgi-fcgi sapi to run tests our implementation is simply different by design
All items in list_actions are initialized to -1 because no excludes or includes have been processed yet.
Characters above the ASCII range are passed through to the output encoded as UTF-8 without any escaping.
Check if we are running in the SDK command line environment and use the setup script from the SDK if so.
Keeping the path to each generator that is used in sys.path is likely harmless and arguably a good idea.
Our own rules (for running gyp-win-tool) and other actions in Chromium rely on python being in the path.
Postbuilds expect to be run in the gyp file's directory, so insert an implicit postbuild to cd to there.
Take out the dependent settings now that they've been published to all of the targets that require them.
This is not quite right, as it also protects these for actions, not just for rules where they are valid.
You can't test beyond this because each developer's machines may have a different set of SDKs installed.
tgt_mac_bundle_resources holds the list of bundle resources so the rule processing can check against it.
:rfc1034identifier is used in the standard project template these days, and :identifier was used earlier.
A function may not exist, if these bindings are used with an older or incompatible version of sourcekitd.
Abstract base for objects that can be used as the remoteGlobalIDString property of PBXContainerItemProxy.
Add the _asm suffix as msvs is capable of handling .cc and .asm files of the same name without collision.
Also, for list expansions, there can be no other text besides the variable expansion in the input string.
Android uses separate flags for assembly file invocations, but gyp expects the same CFLAGS to be applied:
Android's envsetup.sh adds a number of directories to the path including the built host binary directory.
Any values set globally are applied to all configurations, then any per-configuration values are applied.
Create the various element names, following the example set by the Visual Studio 2008 to 2010 conversion.
Given the body_text of a protocol definition, return a list of associated type and operator requirements.
If explicitly set to preprocess the plist, invoke the C preprocessor and specify any defines as -D flags.
If the closing parenthesis is preceded by only whitespaces, try to give a more descriptive error message.
If there's only one node for this file, simplify the display by making it a box without an internal node.
Ignore the interrupt signal so that the parent process catches it and kills all multiprocessing children.
Make sure anything appearing in a list other than "dependencies" also appears in the "dependencies" list.
Make sure the path to the custom generator is in sys.path Don't worry about removing it once we are done.
Normally make does this implicitly, but we force rules to always run so we can check their command lines.
The prerequisites for this rule are the rule source itself and the set of additional rule inputs, if any.
These are lists that will be treated as exclude lists and regular expression-based exclude/include lists.
These cannot run on non-Windows as they require a VS installation to correctly handle variable expansion.
We wrap each .mk include in an if statement so users can tell make to not load a file by setting NO_LOAD.
cd into the directory before running, and adjust paths in the arguments to point to the proper locations.
time to stabilize before the next run we need to clean up after ourselves -- only do this on test success
"gyp_all_modules" is a concatenation of the "gyp_all_modules" targets from all the included sub-makefiles.
A function may not exist, if these bindings are used with an older or incompatible version of libclang.so.
Build up a list of products in the remote project file, ordered the same as the targets that produce them.
Do this after sorting the targets, because the Products group is sorted based on the order of the targets.
If a build file (or any of its included files) is modified we assume all targets in the file are modified.
Include a dummy out folder so that Eclipse doesn't use the default /bin folder in the root of the project.
Moving the item to the end of the list does works, but that's only possible if there's only one such item.
Note that this only scans back one line, since scanning back arbitrary number of lines would be expensive.
Otherwise, Xcode will fill them in when it opens the project file, which will result in unnecessary diffs.
Put to-be-removed items in a set and remove them all in a single pass if this becomes a performance issue.
TODO(rspangler): Should be able to configure this stuff too (though I've never seen this be any different)
The following script takes as input a SIL fragment and changes all SSA variables into FileCheck variables.
The make generator doesn't support it, so forbid it everywhere to keep the generators more interchangable.
We add back in all of the non-compilable stuff to make sure that the make rules have dependencies on them.
We use codecs here because sometimes Python decides to use the ascii codec and chokes on utf-8 characters.
bash does not enable history by default in non-interactive shells, so this is not thought to be a problem.
Dicts to map between values found in rules' 'rule_name' and 'extension' keys and the rule dicts themselves.
Fetching the typed text for each result is expensive, so this requires only O(log N) lookups / comparisons.
Name will be set to the basename of path, if the basename of path is different from the full value of path.
The below make code says, only load the .mk file if the .mk filename doesn't start with a token in NO_LOAD.
This file needs to be here in order for Python to treat the utils/cmpcodesize/tests/ directory as a module.
-- Print header size of separator is determined by 3 column sizes: file name, coverage percentage and lines.
Because Xcode's rule engine is not being used, they need to be expanded as they are written to the makefile.
If not '', a 'Last updated on:' timestamp is inserted at every page bottom, using the given strftime format.
Similar to the above, we only trigger if both sides are missing spaces to avoid false positives with shifts.
Since some toolsets might have been defined conditionally, perform a second round of toolsets expansion now.
The code below generates a separate .mk file for each target, but all are sourced by the top-level Makefile.
These relationships should not exist, but they've only been observed to be harmful with the Xcode generator.
This will always be the fallback because we're not sure enough that the header is associated with this file.
We allow some, but not all, declarations of variables to be present in the statement that defines the class.
We never need to explicitly depend on previous target's link steps, because no compile ever depends on them.
actions_depends is the dependencies this target depends on before running any of its action/rule/copy steps.
Generator flags should be prefixed with the target generator since they are global across all generator runs.
Perhaps it should also remove references from this pbxproject that are no longer present in other_pbxproject.
Prune filters with a single child to flatten ugly directory structures such as ../../src/modules/module1 etc.
Recurse into child dicts, or process child lists which may result in further recursion into descendant dicts.
The other project reports its path as relative to the same directory that this project's path is relative to.
This file needs to be here in order for Python to treat the utils/swift_build_support/ directory as a module.
This is important because paths will be used as keys to the data dict and for references between input files.
We can simply ignore them since they're either empty line or doesn't find executable lines of the given file.
Xcode does not have a distinct type for loadable modules that are pure BSD targets (not in a bundle wrapper).
output_mapping('mappings/ROMAN.TXT', 'entity_table_cs_macroman') table for encoding csjis is esentially empty
'/' is notably absent from this list, because there's no way for a regular expression to be treated as a path.
Clang 3.8 comes with CXTranslationUnit_CreatePreambleOnFirstParse, which allows us to skip the forced reparse.
Find the "real" replacement, matching the appropriate closing paren, and adjust the replacement start and end.
In range-based for, we wanted spaces before and after the colon, but not around "::" tokens that might appear.
Look for the bracket that matches the first bracket seen in a string, and return the start and end as a tuple.
Note: actool crashes if inputs path are relative, so use os.path.abspath to get absolute path name for inputs.
TODO(mark): "text" is the default value, but "file" is appropriate for unrecognized files not containing text.
The PBXFileReference or PBXVariantGroup will be added to or gotten from this PBXGroup, no recursion necessary.
The other intelligent aspects of merge processing won't apply because item is being merged into an empty dict.
They get matched as: -exported_symbols_list file -Wl,exported_symbols_list file -Wl,exported_symbols_list,file
This happens when the SDK is sync'd via src-internal, rather than by typical end-user installation of the SDK.
We do not use `tarfile` here because: - We wish to support LZMA2 compression while also supporting Python 2.7.
We write to a dep file on the side first and then rename at the end so we can't end up with a broken dep file.
modify-non-primary-files.py simulates a build where the user is modifying the source files during compilation.
o fix memory management issues (currently client must hold on to index and translation unit, or risk crashes).
"isa" isn't in the _properties dictionary, it's an intrinsic property of the class which the object belongs to.
Apparently putting the script step after the link step isn't sufficient to ensure proper ordering in all cases.
Filter out those which do not match prefix and suffix and produce the resulting list without prefix and suffix.
Finally, wrap the whole thing in quotes so that the above quote rule applies and whitespace isn't a word break.
If the command already has path elements (either relative or absolute), then assume it is constructed properly.
Instead of using assert() which will crash debugger log an error message and tolerate this non-fatal situation.
Its input is a set of swift files, containing functions named 'bench_*' that take no arguments and returns Int.
Membership in this set means that the cygwin environment has been set up, and does not need to be set up again.
TODO(mark): This only adds references to products in other_pbxproject when they don't exist in this pbxproject.
The include_state object keeps track of the highest type seen, and complains if we see a lower type after that.
Enable typo-detection (and the corresponding fixits) For some reason this is not enabled by default in libclang.
Helper to compare the command we're about to run against the command we logged the last time we ran the command.
If current_file is not set, we reach the last line of report, which contains the summarized coverage percentage.
If prepending a singleton that's already in the list, remove the existing instance and proceed with the prepend.
If the precompiled header is generated by a C source, we must not try to use it for C++ sources, and vice versa.
If we haven't seen an opening brace yet, but we already saw a semicolon, this is probably a forward declaration.
Make sure that any targets in a.gyp don't contain dependencies in other .gyp files that further depend on a.gyp.
Merge the intermediate one with ours to .assert.manifest, then check that .assert.manifest is identical to ours.
Skip the tool named '' which is a holder of global settings handled by _GetMSBuildConfigurationGlobalProperties.
This file needs to be here in order for Python to treat the utils/cmpcodesize/cmpcodesize directory as a module.
Write subninja file containing compile and link commands scoped to a single arch if a fat binary is being built.
Doesn't work with spaces, but that's fine: .d files have spaces in their names replaced with other characters."""
For example, to dump the API for all frameworks across OS X, iOS, watchOS, and tvOS, with the Swift 3 rules, use:
If the directory is relative to the documentation root, use os.path.abspath to make it absolute, like shown here.
NOTE: on windows (but not cygwin) rename will not replace an existing file, so it must be preceded with a remove.
Only use one target from each rule as the dependency for 'all' so we don't try to build each rule multiple times.
Python doesn't deal well with this circular relationship, and doesn't have a real way to do forward declarations.
The code below generates a separate .mk file for each target, but all are sourced by the top-level GypAndroid.mk.
The harness makes a separate test from each of these functions, runs all the tests and reports aggregate results.
The xcode build is relative to a gyp file's directory, and OTHER_LDFLAGS can contain entries that depend on this.
These must happen before we compile any sources, so compute a list of predependencies for sources while we do it.
This is the dict for copying the source file (part of the GYP tree) to the intermediate directory of the project.
Writing to a temporary file first also avoids the possible problem of Xcode rereading an incomplete project file.
'truncatingBitPattern' initializer is defined if the conversion is truncating on any platform that Swift supports.
- Non-linkable dependencies (like a rule that generates a file and writes a stamp file): add them to implicit_deps
CMake is opposed to setting linker directories and considers the practice of setting linker directories dangerous.
E.g. 'type foo string' will make foo a plain struct in the eyes of gdb, circumventing the pretty print triggering.
GYP allows such modules to be specified by setting a target type to loadable_module without having mac_bundle set.
If the file has the wrong C++ extension, then we add a rule to copy that to intermediates and use the new version.
Prepare a dict indicating which project configurations are used for which solution configurations for this target.
There should probably be some way for that module to push the names in, rather than having to hard-code them here.
This allows all the other paths we use to be relative to the Android.mk file, as the Android build system expects.
When referencing an item in this project file, containerPortal is the PBXProject root object of this project file.
When the connection is closed, put a StopIteration on the message queue to signal there's nothing left to wait for
Adding an extra quote would correct the problem in the VCProj but cause the same problem on the final command-line.
Don't warn on assignments to function pointers, but keep warnings for unnamed parameters to pure virtual functions.
It will only be called by re.sub with match.group(0) containing a character matched by the the _escaped expression.
Note that the code below adds actions to this target, so if you move these two lines, move the lines below as well.
See http://blogs.msdn.com/b/vcblog/archive/2010/04/21/quick-help-on-vs2010-custom-build-rule.aspx for more details.
Set LD_LIBRARY_PATH in case the rule runs an executable from this build which links to shared libs from this build.
TODO(mark): add destructor that cleans up self.path if created_dir is True and things didn't complete successfully.
The format of PkgInfo is eight characters, representing the bundle type and bundle signature, each four characters.
These can be specified in means beyond what argparse supports, so we gather them in a list and parse them manually.
This file needs to be here in order for Python to treat the utils/swift_build_support/tests/ directory as a module.
This source code is licensed under the license found in the LICENSE file in the root directory of this source tree.
Try to find an installation location for the Windows DDK by checking the WDK_DIR environment variable, may be None.
We install host executables into shared_intermediate_dir so they can be run by gyp rules that refer to PRODUCT_DIR.
--no-duplicate-basename-check disables the check for duplicate basenames in a static_library/shared_library project.
.dylib is plainly wrong, and .bundle is used by loadable_modules in bundle wrappers (com.apple.product-type.bundle).
Also ignores cases where the previous line ends with a backslash as can be common when defining classes in C macros.
Fresh init tests don't care about which files changed, so we can just use the default .hhconfig in the template repo
Ideally this would modify every non-primary file, but that's harder to infer without actually parsing the arguments.
If there is a parent 'src' or 'java' folder, navigate up to it - these are canonical package root names in Chromium.
Mac does not use readelf/nm for .TOC generation, so avoiding polluting the master ninja with extra unused variables.
Rather than attempting to enumerate the bad shell characters, just whitelist common OK ones and quote anything else.
So for now, we will allow it, unless the 'allow_sharedlib_linksettings_propagation' flag is explicitly set to False.
included_file is relative to the current directory, but it needs to be made relative to build_file_path's directory.
Add the path to this python here so that if it's not in the path when ninja is run later, python will still be found.
At least, it provides a way to workaround this warning for people who use multi-line comments in preprocessor macros.
GypPathToUniqueOutput generates a path relative to the product dir, so insert product_dir in front if it is provided.
If extensions (or modules to document with autodoc) are in another directory, add these directories to sys.path here.
Insert makefile as 0'th input, so it gets the action attached there, as this is easier to understand from in the IDE.
It is only guaranteed to exist and be constant within the context of a project, corresponding to a single input file.
It's an error for a target to depend on all other targets in the same file, because a target cannot depend on itself.
Make each output depend on the main output, with an empty command to force make to notice that the mtime has changed.
Set LD_LIBRARY_PATH in case the action runs an executable from this build which links to shared libs from this build.
Since the CLT has no SDK paths anyway, returning None is the most sensible route and should still do the right thing.
The condition variable used to protect this object and notify the main loop when there might be more data to process.
The makefile rules are all relative to the top dir, but the gyp actions are defined relative to their containing dir.
This creates an interface with the same name as a builtin, which hphpc doesn't correctly support AttrUnique flags on.
To avoid unnecessary changes to the project file after Xcode opens it, don't write comments for remoteGlobalIDString.
Use items instead of iteritems because there's no need to try to look at reinserted keys and their associated values.
We call the path from the source root to the gyp file the "base directory" within the per-.gyp-file NinjaWriter code.
We set up a rule to build the first output, and then set up a rule for each additional output to depend on the first.
gMock methods are defined using some variant of MOCK_METHODx(name, type) where type may be float(), int(string), etc.
A possible workaround is to lie to Xcode about a rule's output, giving it a dummy file it doesn't know how to compile.
Better yet, callers can just call AddFile with a pathname and not worry about building their own PBXBuildFile objects.
Each file will have two lines of report, from which we can extract the file name, total lines and coverage percentage.
If we didn't find the end of the class, last_line would be zero, and the check will be skipped by the first condition.
In order to gradually migrate away from build-script-impl, this module provides tools to handle parsing of these args.
In reality we handle this with the Python tokenizer, which avoids mis-detections due to nesting, comments and strings.
Otherwise, it would have extra automatics added for everything that should just be an ordinary variable in this scope.
Strip off leading/trailing whitespace so that variable matches are simpler below (and because they are rarely needed).
TODO(scottmg): This is a temporary hack to get some specific variables through to actions that are set after gyp-time.
The children of the main group ("Source", "Products", etc.) is pretty much the only case where this likely to come up.
The only workaround is to put rules and their inputs in a separate target from the one that compiles the rule outputs.
The rules are - The priority from low to high is gcc/g++, the 'make_global_settings' in gyp, the environment variable.
The typedef is a declaration of size_type (CXCursor_TypedefDecl), while the type of the variable "size" is referenced.
This should be irrelevant, but some targets extract .o files from .a and depend on the name of the extracted .o files.
Turn the object's sourceTree and path properties into a single flat string of a form comparable to the path parameter.
We must first write out each node within its file grouping before writing out any edges that may refer to those nodes.
just in case the file descriptor was reused we actually check the instance (well, this might also have been reused...)
msbuild_use_call provides a way to disable this but I have not seen any adverse effect from doing that for everything.
Give the generator the opportunity to set additional variables based on the params it will receive in the output phase.
Give the generator the opportunity to set generator_input_info based on the params it will receive in the output phase.
Note that ldflags goes at the end so that it has the option of overriding default settings earlier in the command line.
SHARED_INTERMEDIATE_DIR is the same, except that it is shared among all targets that share the same BUILT_PRODUCTS_DIR.
They affect the size of the lookup tables (and thus, lookup time), but do not change the overall structure of the trie.
They are copied after the builtin static files, so a file named "default.css" will overwrite the builtin "default.css".
This replaces the obj variable for the action rule with an absolute version so that the output goes in the right place.
"Convert" the plist so that any weird whitespace changes from the preprocessor do not affect the XML parser in mac_tool.
It's not possible for gmock macros to appear in the first 2 lines, since the class head + section name takes up 2 lines.
It's ok not to have spaces around binary operators like + - * /, but if there's too little whitespace, we get concerned.
NOTE: data contains both "target" files (.gyp) and "includes" (.gypi), as well as meta-data (e.g. 'included_files' key).
PBXBuildFile's settings property is represented in the output as a dict, but a hack here has it represented as a string.
Paths in gyp files are relative to the .gyp file, but we want paths relative to the source root for the master makefile.
This can be removed if shutil.which() is backported, or if the Swift build toolchain migrates completely to Python 3.3+.
fixme.py -- Adds HH_FIXME annotations in your code to clean up after a new check in the typechecker or after an upgrade.
Check for custom main gyp name, otherwise use the default CHROMIUM_GYP_FILE and prepend .ninja before the .gyp extension.
For a literal quote, CommandLineToArgvW requires 2n+1 backslashes preceding it, and results in n backslashes + the quote.
Having // dummy comments makes the lines non-empty, so we will not get unnecessary blank line warnings later in the code.
It is not sufficient to just rely on Name() to get the XCFileLikeElement's name, because that is not a complete pathname.
List of patterns, relative to source directory, that match files and directories to ignore when looking for source files.
On Windows, incremental linking requires linking against all the .objs that compose a .lib (rather than the .lib itself).
Our segmentation algorithm works on UTF-8 sequences, so encoding a surrogate would produce an invalid code unit sequence.
Some build environments may allow their intermediate directory to be shared on a wider scale, but this is not guaranteed.
Sort everything else by putting group before files, and going alphabetically by name within sections of groups and files.
TODO(unknown): Do a better job of finding .h files so we are confident that not having the .h file means there isn't one.
The CC and CXX from host_clang() should be of the form 'path/to/clang', where 'clang' may have a trailing version number.
The kernel uses the following, but it seems like it would have false positives, where one string reordered its arguments.
The translation unit cursor exists primarily to act as the root cursor for traversing the contents of a translation unit.
This logic is list-specific, but since it relies on the associated dict key, it's checked in this dict-oriented function.
We borrow heavily from the kernel build setup, though we are simpler since we don't have Kconfig tweaking settings on us.
We only write the file if the contents have changed so that simply regenerating the project files doesn't cause a relink.
We still tell link to generate a manifest, but we only use that to assert that our simpler process did not miss anything.
When the need arises, the syntax should be extended to support no caching off a command's output so it is run every time.
Xcode watches for changes to the project file and presents a UI sheet offering to reload the project when it does change.
flat_list is the sorted list of dependencies - actually, the list items are the "ref" attributes of DependencyGraphNodes.
A reference to a class template, function template, template template parameter, or class template partial specialization.
However, in some cases, especially when multiple projects are open or when Xcode is busy, things don't work so seamlessly.
If build_file is just a leaf filename indicating a file in the current directory, build_file_dir might be an empty string.
If the file came from the mac_bundle_resources list or if the rule is marked to process outputs as bundle resource, do so.
If there's a .svn file in the current directory, we recursively look up the directory tree for the top of the SVN checkout
If we're not listing excluded files, then they won't appear in the project, so don't try to configure them to be excluded.
Otherwise, we have have to force an immediate reparse to generate precompiled headers (necessary for fast autocompletion).
Our segmentation algorithm works on UTF-16 sequences, so encoding a surrogate would produce an invalid code unit sequence.
This replaces the gyp_* variables for the action rule with an absolute version so that the output goes in the right place.
_quote is a pattern that should match any argument that needs to be quoted with double-quotes by EncodePOSIXShellArgument.
- We are forward-declaring an inner class that is semantically private, but needed to be public for implementation reasons.
If we see those, don't issue warnings for deprecated casts, instead issue warnings for unnamed arguments where appropriate.
Note that .tlb is not included in the outputs as it is not always generated depending on the content of the input idl file.
The first item in the tuple should be the PBXGroup to which "path" should be added, either as a child or deeper descendant.
The target's sources weren't in the supplied paths and none of the target's dependencies depend upon a target that matched.
This is useful if the translation unit will be reparsed and you don't want to incur the overhead of reparsing the preamble.
This method returns True if all configurations in target contain a 'SYMROOT' attribute that is unique for the given target.
To get serial runs this little bit of python does the same as the linux flock utility to make sure only one runs at a time.
Turn off precompiled header usage for source files of a different type than the file that generated the precompiled header.
Undefine ANDROID for host modules TODO: the source code should not use macro ANDROID to tell if it's host or target module.
When referencing an item in another project file, containerPortal is a PBXFileReference identifying the other project file.
_AddCustomBuildToolForMSVS() will call _FixPath() on the inputs and outputs, so do the same for our generated command line.
path is not a file in the project tree in this case, but calling normpath is still important for trimming trailing slashes.
As short names are  not necessarily unique only do this for short names that haven't already been output for another target.
Even though they may be built by other targets that depend upon them it makes detection of what is going to be built easier.
However, CMake does provide the command link_directories, which adds link directories to targets defined after it is called.
Note that this only happens with the BuildConsole, and does not occur if IncrediBuild is executed from inside Visual Studio.
Some products go into the output root, libraries go into shared library dir, and everything else goes into the normal place.
These parameters are passed in order (as opposed to by key) because ActivePython cannot handle key parameters to __import__.
When expanding a list into string context, turn the list items into a string in a way that will work with a subprocess call.
Xcode 7 started shipping with ".tbd" (text based stubs) files instead of ".dylib" without providing a real support for them.
known issue: dtype_name decoded from runtime.rtype is "nested.Foo" but the dwarf table lists it as "full/path/to/nested.Foo"
Binary-less frameworks don't seem to contain symlinks (see e.g. chromium's out/Debug/org.chromium.Chromium.manifest/ bundle).
Hashtable nodes contain only a pointer to the next node in the bucket, but are always immediately followed by the value pair.
If the target file and the include we're checking share a basename when we drop common extensions, and the include lives in .
Note that the caller is to be expecting a list in return, and not all callers do because not all are working in list context.
Put a generated "All" target first so that people opening up the project for the first time will build everything by default.
The same condition is often evaluated over and over again so it makes sense to cache as much as possible between evaluations.
This could be further improved by inspecting the java file for the package name if this proves to be too fragile in practice.
This source code is licensed under the BSD-style license found in the LICENSE file in the root directory of this source tree.
We are still keeping the less descriptive message because if lhs or rhs gets long, the error message might become unreadable.
We build up a list of every single one of the targets so we can slurp in the generated dependency rule Makefiles in one pass.
output_mapping('mappings/8859-15.TXT', 'entity_table_cs_8859_15') output_mapping('mappings/CP866.TXT', 'entity_table_cs_866')
* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
.o files are added to Xcode Frameworks phases, but conceptually aren't frameworks, they're more like sources or intermediates.
False positives include C-style multi-line comments and multi-line strings but those have always been troublesome for cpplint.
Finally, the .so extension is forcibly applied over the default (.dylib), unless another forced extension is already selected.
Remove any of the targets for all that were not explicitly supplied, 'all' is subsequentely added to the matching names below.
Remove every non-hard static library dependency and remove every non-static library dependency that isn't a direct dependency.
Set LOCAL_ADDITIONAL_DEPENDENCIES so that Android's build rules depend on both our dependency targets and our generated files.
That means that things need to be prepended to excluded_list to maintain them in the same order that they existed in the_list.
The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
This happens to be easier in this case, since a variable's definition contains all variables it references in a single string.
Create an "All" target if there's more than one target in this project file and the project didn't define its own "All" target.
Each Gyp configuration creates a different CMakeLists.txt file to avoid incompatibilities between Gyp and CMake configurations.
Lists in dicts can be merged with different policies, depending on how the key in the "from" dict (k, the from-key) is written.
Non-bundled loadable_modules are called foo.so for some reason (that is, .so and no prefix) with the xcode build -- match that.
Not all generators will need to use the rule_sources lists, but some may, and it seems best to build the list in a common spot.
Note: Don't make c++0x to c++11 so that c++0x can be used with older clangs that don't understand c++11 yet (like Xcode 4.2's).
TODO: It's not clear if libtool_flags should be passed to the alink call that combines single-arch .a files into a fat .a file.
The second item should be a boolean indicating whether files should be added into hierarchical groups or one single flat group.
This is actually the quoting rules for CommandLineToArgvW, not for the shell, because the shell doesn't do anything in Windows.
This source code is licensed under the BSD-style license found in the LICENSE file in the "hack" directory of this source tree.
Unfortunately Clang has no way of limiting autocompletion results, but set a reasonable limit to avoid overloading the Atom UI.
We could use some of these to add additional capabilities, I suppose, but they might not have parity with other platforms then.
We have not seen a closing angle bracket yet, but it's probably a few lines later if we look for it, so just return early here.
- missing/empty description - missing/incorrect repository - missing/incorrect version - missing/incorrect scripts/test property
A reference to a member of a struct, union, or class that occurs in some non-expression context, e.g., a designated initializer.
Add or get a PBXGroup corresponding to the outermost path component, and then recurse into it, chopping off that path component.
Change stderr to write with replacement characters so we don't die if we try to print something containing non-ASCII characters.
If a rule specifies multiple outputs, each input file that the rule is applied to will have the same number of concrete outputs.
Include dirs will occasionally use the SHARED_INTERMEDIATE_DIR variable as part of the path when dealing with generated headers.
It seems there's a race between the creation of the .pdb by the precompiled header step for .cc and the compilation of .c files.
Make sure that 'TargetPath' matches 'Lib.OutputFile' or 'Link.OutputFile' (depending on the tool used) to avoid MSB8012 warning.
Sometimes, Xcode is able to detect that a project file has changed but can't unload it because something else is referencing it.
This is necessary as the other dependencies on them may be static libraries themselves, which are not compile time dependencies.
This works more or less because most programs (including the compiler, etc.) use that function to handle command line arguments.
If the framework doesn't contain a binary, then nothing depends on the actions -- make the framework depend on them directly too.
Make a copy of the variables_in dict that can be modified during the loading of automatics and the loading of the variables dict.
Since make might not rebuild everything that could be declared here as an output, this extra compilation activity is unnecessary.
TODO(evan): move all cross-compilation logic to gyp-time so we don't need to replicate this environment fallback in make as well.
TODO(unknown): Don't complain if line before blank line, and line after, both start with alnums and are indented the same amount.
The Mac linker doesn't work that way, but other platforms do, and so their linker invocations need to be constructed in this way.
The definition of PBXTargetDependency can't be moved below XCTarget because XCTarget's own schema references PBXTargetDependency.
The other option, PROJECT_DERIVED_FILE_DIR, is unsuitable because while it is project-specific, it is not configuration-specific.
A PBXBuildFile that refers to this object will call this method to obtain additional hashables specific to this XCFileLikeElement.
Create a graph of the protocol refinement relationships, associated types, operator requirements, and defaulted generic operators.
If all files have dependencies, add the first file as a dependent of root_node so that the cycle can be discovered from root_node.
On older releases, or on releases for which we cannot determine the release date, we search for the most modern version available.
Replace all double-quotes with double-double-quotes to escape them for cmd shell, and then quote the whole thing if there are any.
This module always tracks it as an object, but contains a hack to prevent it from printing the comment in the project file output.
tempfile.mkstemp uses an overly restrictive mode, resulting in a file that can only be read by the owner, regardless of the umask.
Also set the "PRODUCT_NAME" build setting in each configuration, but only if the setting is not present in any build configuration.
Currently this weird argument munging is used to duplicate the way a python script would need to be run as part of the chrome tree.
Go through their associated PBXContainerItem to get the remote PBXFileReference, which will be present in the remote_products list.
If there is a reason for either of those to differ, then this mapping can be overridden after an instance of this class is created.
NOTE: It does not handle quotes that span more than one line, or cases where an escaped quote is preceeded by an escaped backslash.
The target doesn't contain the source, but the dependent targets have not yet been visited to determine a more specific status yet.
This function is called a lot so for maximum performance, avoid involving regexps which would otherwise make the code much shorter.
This procedure needs to give the impression that target_defaults is used as defaults, and the individual targets inherit from that.
We have to do some pretty insane escaping to get those backslashes and dollar signs past make, the shell, and sed at the same time.
o When all files are processed, the harness begins to compile them, keeping track of all compile fails for later results reporting.
Add in libraries, note that even for empty libraries, we want this set, to prevent inheriting default libraries from the enviroment.
Because this parser has no nesting state about templates, by the time it saw "class Comparator", it may think that it's a new class.
Currently we can't even get the diagnostics on failure because they refer to locations in an object that will have been invalidated.
Executables are for build and test purposes only, so they're installed to a directory that doesn't get included in the system image.
Finalize1 is responsible for sorting duty, and once all project files are sorted, Finalize2 can come in and update these references.
Handle the associated variables dict first, so that any variable references within can be resolved prior to using them as variables.
If parsed_build_file is absolute, it is usable as a path regardless of the current directory, and os.path.join will return it as-is.
See http://swift.org/LICENSE.txt for license information See http://swift.org/CONTRIBUTORS.txt for the list of Swift project authors
TODO: figure out how to not build extra host objects in the non-cross-compile case when this is enabled, and enable unconditionally.
Take the wildcard out and adjust the index so that the next dependency in the list will be processed the next time through the loop.
_escape is used with re.sub to backslash anything in _escape's first match group, hence the (parentheses) in the regular expression.
Files that aren't added to a sources or frameworks build phase can still go into the project file, just not as part of a build phase.
Go backwards through the list_actions list so that as items are deleted, the indices of items that haven't been seen yet don't shift.
If cpplint is invoked from Emacs's flymake, a temporary file is generated by flymake and that file name might end with '_flymake.cc'.
If they generate any extra headers etc., the per-.o file dep tracking will catch the proper rebuilds, so order only is still ok here.
If we have actions/rules/copies, we depend directly on those, but otherwise we depend on dependent target's actions/rules/copies etc.
Loop through the targets in the other build file, adding them to this target's list of dependencies in place of the removed wildcard.
See also _AddActions: cygwin's setup_env mustn't be called for every invocation or the command that sets the PATH will grow too long.
TODO(mark): Like a lot of other things here, this assumes internal knowledge of PBXProject - in this case, of its "targets" property.
The .d checking code below uses these functions: wildcard, sort, foreach, shell, wordlist wildcard can handle spaces, the rest can't.
This is dangerous because the C++ language does not guarantee that globals with constructors are initialized before the first access.
This is only triggered if both sides are missing spaces, even though technically should flag if at least one side is missing a space.
This means the delimiter and the next list item that follow this one in the .vcproj file will be misinterpreted as part of this item.
Xcode sets remoteInfo to the name of the target and not the name of its product, despite this proxy being a reference to the product.
If all targets have dependencies, add the first target as a dependent of root_node so that the cycle can be discovered from root_node.
No warning for all other cases, including whitespace or newline, since we have a separate check for semicolons preceded by whitespace.
Sections that can be found inside targets or configurations, but that should not be propagated from targets into their configurations.
TODO(evan): don't call this function for 'none' target types, as it doesn't do anything, and we fake out a 'binary' with a stamp file.
The "-m" argument can be omitted, in which case the script will collect all of the frameworks in the named SDK(s) and dump their APIs.
There's no reason to not respect the umask here, which means that an extra hoop is required to fetch it and reset the new file's mode.
Trivial benchmark shows that this is more efficient when the operands are longer than a single character, which is generally the case.
Unfortunately the mapping of fields to python attributes in gdb.py isn't complete: you can't test for presence other than by trapping.
When there are more args than the command has declared, assume the initial args form an expression and combine them into a single arg.
argparse is only capable of expressing mutual exclusivity among options, not among groups of options, so we detect this case manually.
For consistency with other builders, put sub-project build output in the sub-project dir (see test/subdirectory/gyptest-subdir-all.py).
If the_dict's parent is not a dict (it could be a list or it could be parentless because it is a root dict), the_dict_key will be None.
If we detected a type split across two lines, join the previous line to current line so that we can match const references accordingly.
Recursively explorer the tree of dicts looking for projects which are the sole item in a folder which has the same name as the project.
Thankfully the typechecker does not accept them at this location, and so it won't actually silence the error and can be fixed manually.
Bundle postbuilds can depend on the whole bundle, so run them after the bundle is packaged, not already after the bundle binary is done.
Callers should use this instead of calling AppendProperty('children', child) directly because this function maintains the group's dicts.
For each remote project file, sort the associated ProductGroup in the same order that the targets are sorted in the remote project file.
If the active build configuration is changed, the project file must be closed and reopened if it is desired for the tree view to update.
Make it less likely for people to manipulate hashes by following the pattern of always pushing an object type value onto the list first.
TODO: This is broken, one cannot generally set properties on files, as other targets may require different properties on the same files.
The GUID needs to be the same each time this builder is invoked, so that we don't need to rebuild the solution when the project changes.
This is intended for executable, shared_library and loadable_module targets where every configuration is set up to produce a PDB output.
./convert_make_target_to_command.py SlowVM ./convert_make_target_to_command.py QuickRepoJit ./convert_make_target_to_command.py ZendJitIR
An Objective-C "bridged" cast expression, which casts between Objective-C pointers and C pointers, transferring ownership in the process.
For reasons of convention, the Android build system requires that all shared library modules are named 'libfoo' when generating -l flags.
These semicolons seems far more common than other kinds of redundant semicolons, possibly due to people converting classes to namespaces.
When we enable nohup logging, the test or any Python script that calls this script via subprocess.Popen will hang on Popen.communicate().
base_non_configuration_keys is a list of key names that belong in the target itself and should not be propagated into its configurations.
If depth is set, predefine the DEPTH variable to be a relative path from this build file's directory to the directory identified by depth.
Loop this way instead of "for dependency in" or "for index in xrange" because the dependencies list will be modified within the loop body.
Make sure that the list of targets being replaced is the same length as the one replacing it, but allow for the added test runner targets.
Parameterless conversion functions, such as bool(), are allowed as they are probably a member operator declaration or default constructor.
Strip out -l, as it is not used on windows (but is needed so we can pass in libraries that are assumed to be in the default library path).
If previous section is different from current section, _last_header will be reset to empty string, so it's always less than current header.
See: https://github.com/apple/swift/pull/169 Building Swift from source requires a recent version of the Clang compiler with C++14 support.
Used to indicate that brief documentation comments should be included into the set of code completions returned from this translation unit.
We support two kinds of shared objects (.so): 1) shared_library, which is just bundling together many dependent libraries into a link line.
Xcode has some "issues" with checking dependencies for the "Compile sources" step with any source files/headers generated by actions/rules.
Found the end of the string, match leading space for this line and resume copying the original lines, and also insert a "" on the last line.
If the websocket was terminated and there are no messages left in the queue, return None immediately otherwise the client will block forever
Since I could find no way to make foreach work with spaces in filenames correctly, the .d files have spaces replaced with another character.
TODO(mark): Maybe it should try with the original case first and fall back to lowercase, in case there are any instances where case matters.
Callers should use this instead of calling AppendProperty('files', pbxbuildfile) directly because this function maintains the object's dicts.
I assume it's a function argument when the char before the whitespace is legal in a function name (alnum + _) and we're not starting a macro.
In another one-off, let's set flatten_list on buildSettings properties of XCBuildConfiguration objects, because that's how Xcode treats them.
It is not sufficient to just rely on name and parent to build a unique hashable : a node could have two child PBXGroup sharing a common name.
Items for which no exclusion or inclusion has been applied (yet) have value -1, items excluded have value 0, and items included have value 1.
Make sure all the local variables are added to the variables list before we process them so that you can reference one variable from another.
we create the state in a different dir from the one we run our tests on, to verify that the saved state does not depend on any absolute paths
A reference to a set of overloaded functions or function templates that has not yet been resolved to a specific function or function template.
Deleting an existing item uses self.__map to find the link which is then removed by updating the links in the predecessor and successor nodes.
However, IncrediBuild BuildConsole will parse the solution file, but then silently skip building the target causing hard to track down errors.
Instead of appending to lhs one character at a time, we do another regular expression match to consume several characters at once if possible.
Put enough ".." components to back up out of relative_to to the common prefix, and then append the part of path_split after the common prefix.
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
This is because the Android LOCAL_GENERATED_SOURCES must be in the local module intermediate directory for the compile rules to work properly.
This will be read by link.exe to know which instance of mspdbsrv.exe it should connect to (if it's not set then the default endpoint is used).
This will not help if the comment started before the current line or ended after the current line, but it catches most of the false positives.
For a variant path/to/Language.lproj/MainMenu.nib, put a variant group named MainMenu.nib inside path/to, and give it a variant named Language.
If no depth variable was set on the command line, try to find a "src" directory by looking at the absolute path to each build file's directory.
It just means that it's going to load a build file that contains targets and is expected to provide a targets dict that contains the targets...
Note that this must be two directories beneath src/ for unit tests to pass, as they reach into the src/ directory for data with relative paths.
We always want to ignore the environment when regenerating, to avoid duplicate or changed flags in the environment at the time of regeneration.
With inputPaths and outputPaths not supplied, make will always be called, but it knows enough to not do anything when everything is up-to-date.
path_tree_to_subfolder maps names of Xcode variables to the associated dstSubfolderSpec property value used in a PBXCopyFilesBuildPhase object.
Any string that doesn't begin with a "-" is a singleton - it can only appear once in a list, to be enforced by the list merge append or prepend.
Handling this case properly would also be problematic because bash allows the history character to be changed with the histchars shell variable.
Ideally we should fetch the underlying value content and display (key, value) so user does not need to expand one more level to examine content.
Libraries (i.e. -lfoo) These must be included even for static libraries as some of them provide implicit include paths through the build system.
Xcode's built-in rule support is almost powerful enough to use directly, but there are a few significant deficiencies that render them unusable.
o cleanup ctypes wrapping, would be nice to separate the ctypes details more clearly, and hide from the external interface (i.e., help(cindex)).
we run the --json version first because --json --refactor doesn't change any files, but plain --refactor does (i.e. the latter isn't idempotent)
Although XCProjectFile is implemented here as an XCObject, it's not a proper object in the Xcode sense, and it certainly doesn't have its own ID.
For a non-literal quote, CommandLineToArgv requires an even number of backslashes preceding it, and it produces half as many literal backslashes.
These files contain a main function with simple arguments parsing, time measurement utilities and a loop in which the bench-functions are called.
This function might benefit from a dict optimization as GetChildByPath for some workloads, but profiling shows that it's not currently a problem.
utils/build-script takes arguments for its argument parser, as well as arguments that are meant to be passed directly to utils/build-script-impl.
Even though Breakpoints are registered on SBTarget lldb.SBTarget.EventIsTargetEvent() will return false for breakpoint events so handle them here.
Note that the stock python on SunOS has a bug where fcntl.flock(fd, LOCK_EX) always fails with EBADF, that's why we use this F_SETLK hack instead.
Note that this pattern will also pass on assignments of "0" to function pointers, but the preferred values for those would be "nullptr" or "NULL".
Note that this relies on the Python dict comparison operator comparing componentwise lexicographically based on the alphabetical ordering of keys.
Otherwise, we try to remove spaces from the right side, if this doesn't work we try on left side but only if there's a non-character on the right.
Pre-compiled header source stubs need a different compiler flag (generate precompiled header) and any source file not of the same kind (i.e. C vs.
To prevent this rule from executing on every build (expensive, especially with postbuilds), expliclity update the time on the framework directory.
nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
normal run with FIFO compaction mode ops_per_thread is divided by 5 because FIFO compaction style is quite a bit slower on reads with lot of files
- If there is no 'make_global_settings' for CC.host/CXX.host or 'CC_host'/'CXX_host' enviroment variable, cc_host/cxx_host should be set to cc/cxx.
Found DISALLOW* macro outside a class declaration, or perhaps it was used inside a function when it should have been part of the class declaration.
If we were unable to exec for some reason, we want to exit with an error, and fixup variable references to be shell syntax instead of xcode syntax.
It is very heavily advised to keep each target in an entire project (even across multiple project files) using the same set of configuration names.
Likewise, gMock's MockCallback takes a template parameter of the form return_type(arg_type), which looks much like the cast we're trying to detect.
TODO(sugawarayu): Audit cpplint.py to see what places could be profitably rewritten to use _GetTextInside (and use inferior regexp matching today).
What it does, for "/usr/lib" libraries, is do "-L/usr/lib -lname" which is dependent on the library order and cause collision when building Chrome.
* load from the chosen second-level lookup table using the second-level index, which will give you the number of the data block that you should use.
Besides these, we don't accept anything else, otherwise we might get false negatives when existing comment is a substring of the expected namespace.
Issue warning if the line before public/protected/private was not a blank line, but don't do this if the previous line contains "class" or "struct".
Setting a new item creates a new link which goes at the end of the linked list, and the inherited dictionary is updated with the new key/value pair.
This benefits both the "build chrome" case as well as the gyp tests, which expect to be able to run actions and build libraries by their short name.
rules run on the host, so they should in theory only use host libraries, but until everything is made cross-compile safe, also use target libraries.
First, try to read the file using plistlib that only supports XML, and if an exception is raised, convert a temporary copy to XML and load that copy.
The cache key contains the command to be run as well as the directory to run it from, to account for commands that depend on their current directory.
Therefore, on py2k, the bytes are actually a str object and can't be used in the utf8 validator as we need integers when we get each byte one by one.
ensure all external dependencies are complete before internal dependencies extra_deps currently only depend on their own deps, so otherwise run early
hacky code to pass an additional option to the unparser we use the test input extension as a cue for what option we want to pass to the test_unparser
I hope that these shortcomings are addressed, I really liked having the rules handled directly in Xcode during the period that I was prototyping this.
The settings are: filetype : used for explicitFileType in the project file prefix : the prefix for the file name suffix : the suffix for the file name
This does not match the characters in _escape, because those need to be backslash-escaped regardless of whether they appear in a double-quoted string.
actions run on the host, so they should in theory only use host libraries, but until everything is made cross-compile safe, also use target libraries.
gyp has mac_bundle_resources to copy things into a bundle's Resources folder, but there's no built-in way to copy files to other places in the bundle.
Because only whitespaces are allowed before the keywords, this will also ignore most do-while-loops, since those lines should start with closing brace.
In this case, we also need to save the compile_deps for the target, so that the the target that directly depends on the .objs can also depend on those.
Look for more matches now that we've replaced some, to deal with expanding local variables (variables defined in the same variables block as this one).
Replace the XCConfigurationList attached to the PBXProject object with a new one specifying all of the configuration names used by the various targets.
Topologically sort, and then reverse, because we used an edge definition that's inverted from the expected result of this function (see comment above).
Create an extended_line, which is the concatenation of the current and next lines, for more effective checking of code that may span more than one line.
Except after an opening paren, or after another opening brace (in case of an initializer list, for instance), you should have spaces before your braces.
The 'target_build_files' key is only set when loading target build files in the non-parallel code path, where LoadTargetBuildFile is called recursively.
There will be more chances to add it to flat_list when examining it again as a dependent of those other dependencies, provided that there are no cycles.
This will result in a KeyError being raised for the property that should be present, which seems more appropriate than NotImplementedError in this case.
We can't simply silence the warning on first sight of closing brace, because that would cause false negatives for things that are not initializer lists.
Fetch the generator specific info that gets fed to input, we use getattr so we can default things and the generators only have to provide what they need.
If they're present, Xcode will provide a slight optimization by only running the script phase if any output is missing or outdated relative to any input.
One can execute it to dump the API of a given module within a particular SDK, e.g., UIKit from the iOS SDK as seen in Swift 3 after the "grand renaming":
OptionParser will throw in the case where you want just one big long argument and no options and you enter something that starts with '-' in the argument.
There is currently no logic on deciding what these nontrivial things are, so this check is triggered by namespace size only, which works most of the time.
This arrangement means that a "conditions" section containing a "variables" section will only have those variables effective in subdicts, not in the_dict.
This does not apply when the non-space character following the comma is another comma, since the only time when that happens is for empty macro arguments.
Using manual string matching since that is much faster than the regexp and this can be called hundreds of thousands of times so micro performance matters.
We keep this code here in case we have to special-case any tests (on a short-term basis) to be run serially after all of the parallel tests have finished.
XCBuildPhase should only provide buildActionMask and runOnlyForDeploymentPostprocessing, and not files or the various file-related methods and attributes.
For a literal quote, CommandLineToArgv requires an odd number of backslashes preceding it, and it produces half as many literal backslashes (rounded down).
If self.bmp_data contains identical data blocks, keep the first one, remove duplicates and change the indexes in self.bmp_lookup to point to the first one.
If there are n source files matching the rule, and m additional rule inputs, then adding 'inputs' to each build edge written below will write m * n inputs.
If this is a subsequent target and it's linkable, don't look any further for linkable dependencies, as they'll already be linked into this target linkable.
Take these nodes out of in_degree_zeros as work progresses, so that the next node to process from the list can always be accessed at a consistent position.
The generators can provide more keys, the two lists are merged into path_sections, but you should call IsPathSection instead of using either list directly.
This avoids these false positives: - macro that defines a base class - multi-line macro that defines a base class - macro that defines the whole class-head
25 lines seems like a good cutoff since that's the usual height of terminals, and any class that can't fit in one screen can't really be considered "small".
Due to circular dependencies between libraries :(, we wrap the special "figure out circular dependencies" flags around the entire input list during linking.
The main things we want for sure are (a) simple external access to kinds, (b) a place to hang a description and name, (c) easy to keep in sync with Index.h.
Check if this file is copied into the current bundle, and if so add it to the bundle depends so that dependent targets get rebuilt if the copy input changes.
Fortunately, this logic is very fast, so it doesn't seem like we'll have to make it multi-threaded any time soon, so we can get away with sharing this field.
Other shared-object link notes: - Set SONAME to the library filename so our binaries don't reference the local, absolute paths used on the link command-line.
The included_files entries are relative to the dir of the build file that included them, so we have to undo that and then make them relative to the root dir.
The ordering required to allow for monkeypatching causes the warning "I100 Import statements are in the wrong order." when linting using flake8-import-order.
With a machine that has 2 quad-core Xeons, a build can quickly run out of processes based on scheduling/other tasks, and randomly failing builds are no good.
loadable_modules not in a mac_bundle are mapped to com.googlecode.gyp.xcode.bundle, a pseudo-type that xcode.py interprets to create a single-file mh_bundle.
setuptools expects to be invoked from within the directory of setup.py, but it is nice to allow `python path/to/setup.py install` to work (for scripts, etc.)
string to int dict storing error counts output format: "emacs" - format that emacs can parse (default) "vs7" - format that Microsoft Visual Studio 7 can parse
A small discourse on paths as used within the Ninja build: All files we produce (both at gyp and at build time) appear in the build directory (e.g. out/Debug).
For any generated source, if it is coming from the shared intermediate directory then we add a Make rule to copy them to the local intermediate directory first.
Note that we accept C style "/* */" comments for terminating namespaces, so that code that terminate namespaces inside preprocessor macros can be cpplint clean.
This keeps the file writer from outputting something that would be treated as the end of a comment in the middle of something intended to be entirely a comment.
We can safely pop the build_file_data from per_process_data because it will never be referenced by this process again, so we don't need to keep it in the cache.
A particular header is only expanded once, so this script will break if there are multiple inclusions of the same header that are expected to expand differently.
For each static library target, remove "dependencies" entries referring to other static libraries, unless the dependency has the "hard_dependency" attribute set.
If DISALLOW_EVIL_CONSTRUCTORS, DISALLOW_COPY_AND_ASSIGN, or DISALLOW_IMPLICIT_CONSTRUCTORS is present, then it should be the last thing in the class declaration.
See http://swift.org/LICENSE.txt for license information See http://swift.org/CONTRIBUTORS.txt for the list of Swift project authors Bit counts for all int types
preserves member order iteration in the resulting objects Member order is used by package linting However, this is Python 2.7 only, so we conditionally enable it
Initially, it is a copy of the children of this node, because when the graph was built, nodes with no dependencies were made implicit dependents of the root node.
We also check for the case where the previous line is indented 6 spaces, which may happen when the initializers of a constructor do not fit into a 80 column line.
We need to move any non-generated sources that are coming from the shared intermediate directory out of LOCAL_SRC_FILES and put them into LOCAL_GENERATED_SOURCES.
concrete_outputs_all is a flat list of all concrete outputs that this rule is able to produce, given the known set of input files (rule_sources) that apply to it.
The supp tables contain entries for BMP code units to simplify trie implementation, but those BMP entries are filled with the default value, so they compress well.
This is done in a separate loop up front, because the _included and _excluded keys need to be added to the_dict, and that can't be done while iterating through it.
This means that all variables in .mk-files clobber one another, and furthermore that any variables set potentially clash with other Android build system variables.
We also need to move over any C++ files that don't match our local_cpp_extension, since Android will only generate Makefile rules for a single LOCAL_CPP_EXTENSION.
.o is conceptually more of a "source" than a "library," but Xcode thinks of "sources" as things to compile and "libraries" (or "frameworks") as things to link with.
Copies all the phplang-spec tests to a temporary directory, runs them in interp mode, then copies the good ones to test/spec/good and the bad ones to test/spec/bad.
Need to join with the build_dir here as we're writing it during generation time, but we return the un-joined version because the build will occur in that directory.
The only subclass of PBXGroup, PBXVariantGroup, should not participate in reparenting in the same way: reparenting by merging different object types would be wrong.
The xcode generator special-cases global xcode_settings and does something that amounts to merging in the global xcode_settings into each local xcode_settings dict.
A "rule source" is a file that was listed in a target's "sources" list and will have a rule applied to it on the basis of matching the rule's "extensions" attribute.
A PBXProject is really just an XCObject, the XCContainerPortal thing is just to allow PBXProject to be used in the containerPortal property of PBXContainerItemProxy.
Any dict merged into the_dict will be recursively processed for nested conditionals and other expansions, also according to phase, immediately prior to being merged.
Populated lazily by XcodeVersion, for efficiency, and to fix an issue when "xcodebuild" is called too quickly (it has been found to return incorrect version number).
TODO(bradnelson): once the annotator supports a postscript (section for after the build proper that could be used for cumulative failures), use that instead of this.
This function resolves a target into a canonical form: - a fully defined build file, either absolute or relative to the current directory - a target name - a toolset
This uses printf instead of echo because printf's behaviour with respect to escape sequences is more portable than echo's across different shells (e.g., dash, bash).
An XCTarget is really just an XCObject, the XCRemoteObject thing is just to allow PBXProject to be used in the remoteGlobalIDString property of PBXContainerItemProxy.
To ensure that Nuclide is easy to set up and install, we want to limit our dependencies to built-in Python libraries and libclang (which is provided in ../pythonpath)
Due to C++11 brace initialization, there are more places where semicolons are required than not, so we use a whitelist approach to check these rather than a blacklist.
IntermediatesGroup is used to collect source-like files that are generated by rules or script phases and are placed in intermediate directories such as DerivedSources.
Nothing else can be a link dependency of them, there can only be dependencies in the sense that a dependent target might run an executable or load the loadable_module.
Now that all of the target's configurations have been built, go through the target dict's keys and remove everything that's been moved into a "configurations" section.
Take care to normpath only the path in the case of 'call ../x.bat' because otherwise the whole thing is incorrectly interpreted as a path and not normalized correctly.
The paths in build_files were relativized above, so undo that before testing against the non-relativized items in target_list and before calculating the Makefile path.
Xcode properly detects a file being renamed over an open project file as a change and so it remains able to present the "project file changed" sheet under this system.
"include" is specified relative to subdict_path, so compute the real path to include by appending the provided "include" to the directory in which subdict_path resides.
The import .lib is the output of a build step, but because dependents only link against the lib (not both the lib and the dll) we keep track of the import library here.
This RE is a little bit more complicated than one might expect, because we have to take care of space removals tools so we can handle comments inside statements better.
A possible workaround is a shell script phase prior to compilation that touches a rule's primary input files if any would-be additional inputs are newer than the output.
Finalize2 needs to happen in a separate step because the process of updating references to other projects depends on the ordering of targets within remote project files.
This extra absorption in the regexp facilitates testing the regexp on its own, by preventing the interior of some of these constructs from being treated as literal text.
Do a regular expression match here to make sure that we are matching the expected CHECK macro, as opposed to some other macro that happens to contain the CHECK substring.
It also requires a fairly recent libtool, and if the system clang isn't used, DYLD_LIBRARY_PATH needs to contain the path to the libLTO.dylib that matches the used clang.
An amalgamation consists of a header that includes the contents of all public headers and a source file that includes the contents of all source files and private headers.
Build systems that operate serially or that need to have dependencies defined before dependents reference them should generate targets in the order specified in flat_list.
By picking up this special type and converting it to a dynamic library (com.apple.product-type.library.dynamic) with fix-ups, single-file loadable modules can be produced.
From Alex Martelli, http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52560 ASPN: Python Cookbook: Remove duplicates from a sequence First comment, dated 2001/10/13.
TODO(mark): "Build" is used by gyp.generator.xcode, perhaps the generator should have a way of influencing this list rather than having to hardcode for the generator here.
Take the dependency out of the list, and don't increment index because the next dependency to analyze will shift into the index formerly occupied by the one being removed.
For Android, the target of these maps is a tuple ('static', 'modulename'), ('dynamic', 'modulename'), or ('path', 'some/path') instead of a string, since we link by module.
Implements the GNU __null extension, which is a name for a null pointer constant that has integral type (e.g., int or long) and is the same size and alignment as a pointer.
Old method of searching for which VS version is installed We don't use the 2010-encouraged-way because we also want to get the path to the binaries, which it doesn't offer.
Run mt.exe on the theoretically complete manifest we generated, merging it with the one the linker generated to confirm that the linker generated one does not add anything.
Setting a "name" property at instantiation may also affect "productName", which may in turn affect the "PRODUCT_NAME" build setting in children of "buildConfigurationList".
This is because the downside for getting the whitelist wrong means some extra semicolons, while the downside for getting the blacklist wrong would result in compile errors.
We can't just use the project filename sans path, since there could be multiple projects with the same base name (for example, foo/unittest.vcproj and bar/unittest.vcproj).
No-op, used by tests') Since this target depends on binary and resources which are in nested subfolders, the framework directory will be older than its dependencies usually.
* Neither the name of ws4py nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
The harness chooses a number of iterations for each tests to achieve the best accuracy in the given time limit (in order to do that, it performs several auxiliary test runs).
Unfortunately, it will also assume that all outputs are touched by the script, and if the outputs serve as files in a compilation phase, they will be unconditionally rebuilt.
Coalesce multiple "copies" sections in the same target with the same "destination" property into the same PBXCopyFilesBuildPhase, otherwise they'll wind up with ID collisions.
Some of the entities in html5 share the same code points (e.g. "midast" and "ast" share 0x42) In zend's php which one to use is chosen by usort, which has undefined behaviour.
Use a banner that looks like the stock Python one and like what code.interact uses by default, but tack on something to indicate what locals are available, and identify gypsh.
looks like identify-function doesn't support JSON - but still be careful changing this, since tools may just call everything with --json flag and it would be a breaking change
There's nothing unique about this PBXGroup, and if left alone, it will wind up with the same set of hashables as all other PBXGroup objects owned by the projectReferences list.
Similarly, if we haven't seen an opening brace yet, but we already saw a closing parenthesis, then these are probably function arguments with extra "class" or "struct" keywords.
That ensures that earlier replacements won't mess up the string in a way that causes later calls to find the earlier substituted text instead of what's intended for replacement.
This means not only that the linker should not generate the intermediate manifest but also that the manifest tool should do nothing even when additional manifests are specified.
This should call a generator-provided function that observes the proper list-to-argument quoting rules on a specific platform instead of just calling the POSIX encoding routine.
If build_file is a symlink, we must not follow it because there's a chance it could point to a path above toplevel_dir, and we cannot correctly deal with that case at the moment.
Consequently, until Xcode rules are made more capable, "rules" input sections will be handled in Xcode output by shell script build phases performed prior to the compilation phase.
To work around this, if a target is building anything directly (not type "none"), then a second target is used to run the GYP actions/rules and is made a dependency of this target.
python2 will not cast pc (type void*) to an int cleanly instead python2 and python3 work with the hex string representation of the void pointer which we can parse back into an int.
Despite the documentation that says this only defaults to on when the subsystem is Vista or greater (which applies to the linker), the IDE defaults it on unless it's explicitly off.
For if/for/while/switch, the left and right parens should be consistent about how many spaces are inside the parens, and there should either be zero or one spaces inside the parens.
The __null extension is typically only used by system headers, which define NULL as __null in C++ rather than using 0 (which is an integer that may not match the size of a pointer).
TODO(gspencer): Switch the os.environ calls to be win32api.GetDomainName() and win32api.GetUserName() once the python version in depot_tools has been updated to work on Vista 64-bit.
Rules to determine extended grapheme cluster boundaries, as defined in 'Grapheme Break Chart', http://www.unicode.org/Public/6.3.0/ucd/auxiliary/GraphemeBreakTest.html, Unicode 6.3.0.
This is all roughly based on the Makefile system used by the Linux kernel, but is a non-recursive make -- we put the entire dependency graph in front of make and let it figure it out.
We implement a whitelist of safe macros instead of a blacklist of unsafe macros, even though the latter appears less frequently in google code and would have been easier to implement.
otherwise we matched some non-generic operator Find clusters of protocols that have the same name when underscores are stripped map from potential cluster name to nodes in the cluster
Note that this expression matches the characters listed with "+", for 1 or more occurrences: if a string is empty, it must not match this pattern, because it needs to be encoded as "".
We don't actually care about the content of the input file, either, so we actually stick *the new dependencies* in the input file, and copy that over the old dependencies (if present).
For each linkable target, add a "dependencies" entry referring to all of the target's computed list of link dependencies (including static libraries if no such entry is already present.
The value of inherit_unique_symroot decides, if a configuration is assumed to inherit a unique 'SYMROOT' attribute from its parent, if it doesn't define an explicit value for 'SYMROOT'.
But in many cases, after trie compression there will be fewer than 256 unique second-level lookup tables and/or data storage blocks, which allows one to use 8-bit words in lookup tables.
If a source file gets copied, we still need to add the orginal source directory as header search path, for GCC searches headers in the directory that contains the source file by default.
This should be handled by mspdbsrv, but rarely errors out with c1xx : fatal error C1033: cannot open program database By making the rules target separate pdb files this might be avoided.
PathHashables returns hashables unique enough that no two PBXBuildFiles should wind up with the same set of hashables, unless someone adds the same file multiple times to the same target.
Link dependencies (i.e. other gyp targets this target depends on) These need not be included for static libraries as within the gyp build we do not use the implicit include path mechanism.
There are three ways we might decide not to print an error message: a "NOLINT(category)" comment appears in the source, the verbosity level isn't high enough, or the filters filter it out.
Each item in a conditions list consists of cond_expr, a string expression evaluated as the condition, and true_dict, a dict that will be merged into the_dict if cond_expr evaluates to true.
The list itself can't influence the variables dict, and ProcessVariablesAndConditionsInList will make copies of the variables dict if it needs to pass it to something that can influence it.
We use the name 'gyp_all_modules' as the Android build system doesn't allow the use of the Make target 'all' and because 'all_modules' is the equivalent of the Make target 'all' on Android.
On some systems, ld is finicky and even requires the libraries to be ordered in such a way that unresolved symbols in earlier-listed libraries may only be resolved by later-listed libraries.
Project files generated by this module will use _intermediate_var as a custom Xcode setting whose value is a DerivedSources-like directory that's project-specific and configuration-specific.
Adjust the replacement range to match the entire command found by FindEnclosingBracketGroup (since the variable_re probably doesn't match the entire command if it contained nested variables).
If the target and include share some initial basename component, it's possible the target is implementing the include, so it's allowed to be first, but we'll never complain if it's not there.
A small utility to take the output of a Swift validation test run where some compiler crashers have been fixed, and move them into the "fixed" testsuite, removing the "--crash" in the process.
Each item in list_actions identifies whether the corresponding item in the_list should be excluded, unconditionally preserved (included), or whether no exclusion or inclusion has been applied.
Remove trigger_file from excluded_sources to let the rule be triggered (e.g. rule trigger ax_enums.idl is added to excluded_sources because it's also in an action's inputs in the same project)
ccache or distcc lose the path to the target, so we convert a rule of the form: foobar.o: DEP1 DEP2 into path/to/foobar.o: DEP1 DEP2 (2) we want missing files not to cause us to fail to build.
Add the paths first, because if something's going to raise, the messages provided by _AddPathToDict are more useful owing to its having access to a real pathname and not just an object's Name().
Chromium's .gyp files currently have some circular relationships on non-Mac platforms, so this option allows the strict behavior to be used on Macs and the lenient behavior to be used elsewhere.
`objectGroups` are used by the client to designate remote objects on the server that should stick around (for potential future queries), and eventually released with a `releaseObjectGroup` call.
If the output path has variables in it, which happens in practice for 'copies', writing the environment as target-local doesn't work, because the variables are already needed for the target name.
It's preferable to keep dependencies listed first during a link phase so that they can override symbols that would otherwise be provided by libraries, which will usually include system libraries.
Note: Numeric values (including the names) should be consistent with '_GraphemeClusterBreakPropertyValue' enum on the Swift side, and with 'GraphemeClusterBreakProperty' in the compiler C++ code.
Make sure static libraries don't declare dependencies on other static libraries, but that linkables depend on all unlinked static libraries that they need so that their link steps will be correct.
Start with self, and walk up the chain of parents prepending their paths, if any, until no more parents are available (project-relative path) or until a path relative to some source tree is found.
If any concrete outputs are outdated or missing relative to their corresponding rule_source or to any specified additional input, the rule action must be performed to generate the concrete outputs.
Instead, we merge all the manifests provided (along with one that includes what would normally be in the linker-generated one, see msvs_emulation.py), and include that into the first and only link.
Maybe there's a more elegant way around this, but this is the only case where we need to own objects in a dictionary (that is itself in a list), and three lines for a one-off isn't that big a deal.
Grit intentionally doesn't touch the timestamp of its output file when the file doesn't change, which is fine in hash-based dependency systems like scons and forge, but not kosher in the make world.
Default variables provided by this program and its modules should be named WITH_CAPITAL_LETTERS to provide a distinct "best practice" namespace, avoiding collisions with user and automatic variables.
Some phases may be present in multiples in a well-formed project file, but phases like PBXSourcesBuildPhase may only be present singly, and this function is intended as an aid to GetBuildPhaseByType.
There's no need to write anything into the script to ensure that the output directories already exist, because Xcode will look at the declared outputs and automatically ensure that they exist for us.
