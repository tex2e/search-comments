@param str The string
Access from JS thread
Can be int or double.
Check iterator access
Convert from PX to DP
Convert from SP to PX
General pause poshort
UseAdaptiveMutex test
Wait before retrying.
add a deletion record
merge yy under cfkey2
open the new one, too
this also closes baos
.setJSMainModuleName()
@return size in bytes.
@return the backup id.
@see RateLimiterConfig
Access from any thread
Called from UI thread.
Cancels the animation.
Collect histogram data
Convert from DIP to PX
General resume poshort
Insertion into a queue
No timeouts by default
Returns the empty map.
Run main "update" loop
Test ACTION_DOWN event
This builder is reused
add new key/value pair
check if key is merged
hide FPS debug overlay
keyboard is now hidden
noinspection unchecked
*key is a run of 0xffs.
@return The slice data.
@return TtlDB instance.
@return lookahead value
Delete the first backup
FIFO compaction option.
Manages raw text nodes.
Sets the encoding type.
Size has to be positive
Test listColumnFamilies
Test with column family
This starts all markers
hide dev options dialog
polling already enabled
reached end of database
retrieve key value pair
setup sample properties
writing xx under cfkey2
@param opt Read options.
Check for server errors.
Clears the backing slice
Click first visible item
Compaction style for DB.
Everything failed, throw
Otherwise returns false.
Should never reach here.
accessed from any thread
color is not transparent
dismiss redbox if exists
forward iterative access
generate a different key
iterate using a snapshot
reverse iterative access
@return Always returns 0.
@return Compaction style.
@return Compression type.
And we apply the position
Apps should enforce this.
Backing for a React View.
Clean mUpdatedNodes queue
Disable timeouts for read
Else return an ok status.
Get the current position.
Logs requests to Systrace
Not on an Android system.
See renderApplication.js.
Trigger failure callbacks
Utility class constructor
Verify that backups exist
insert 5 writes into a cf
register standard options
@param url the URL to open
Any 'Enter' action will do
Database with TTL support.
Handles a createView call.
Quits this queue's Looper.
Registers a new root view.
Should be called only once
Show a date picker dialog.
Simple spring interpolator
Stop listening for shakes.
Stub implementation of QPL
TODO(9577825): remove this
Test without column family
This does nothing anymore.
This is a programmer error
To disable auto compaction
Wait for the UI to settle.
@return block size in bytes
@return column family name.
Ask the JVM to load for us.
Does not support canceling.
Handles a setChildren call.
Handles an updateView call.
Reads and crops the bitmap.
RocksDB memory environment.
See ScrollViewTestModule.js
Start listening for shakes.
The name of the comparator.
The wait time for db mutex.
This ordering is important.
Wait for flush to finished.
e.g. "index.android.bundle"
set snapshot in ReadOptions
stop shake gesture detector
strip initial slash in path
thread has been terminated.
verify url, method, headers
@param height height to set.
@return The length in bytes.
@return the hugePageTlbSize.
@see org.rocksdb.RocksObject
Align to baseline by default
Bytes read during compaction
Cleanup finished animations.
Default: BytewiseComparator.
Denoting a finally situation
Don't send same text changes
Find length of common prefix
Get new Snapshot of database
Interface for a mutable map.
Returns newly created array.
Set a default spacing value.
Set compaction style for DB.
Set custom logger to options
Test Optimize for statements
This can use a lot of memory
We compensate for that here.
get first char in otherslice
negative will be mapped to 0
restore db from first backup
start shake gesture detector
@return size of write buffer.
@return the hash table ratio.
@return the index sparseness.
@return the number of buckets
@return the number of levels.
@see IllegalArgumentException
AUTOMATICALLY GENERATED CODE.
Enable double-tap-R-to-reload
First event for this gesture.
Handles an updateLayout call.
If 0, then there is no limit.
Loading is done using Fresco.
Make a new DirectorySoSource.
Return the loggers log level.
Set the config for mem-table.
TODO(6352067): Support dashes
TextAlign + TextAlignVertical
The default value is 6 hours.
We stop writes at this point.
restore db from latest backup
@param tickerType Ticker type.
@return a Checkpoint instance.
@return block restart interval
@return the size of the backup
Constants used by ReactMarker.
Construct ColumnFamilyOptions.
Determine part's content type.
Disable automatic compactions.
Events that make JS do things.
Exactly one of the two is null
Gets the opacity from a color.
Handles a manageChildren call.
Interface for a mutable array.
It does a number of things: 1.
Plain-Table requires mmap read
Quits this MessageQueueThread.
Regenerate with genstructs.sh.
Returns the data of the slice.
The first sequence number is 1
The latest backup must remain.
The second backup must remain.
This needs to be investigated.
Value sent from JS (setState).
We want custom min..max range.
@param histData Histogram data.
@param histType Histogram type.
Always called on the UI thread.
Bytes written during compaction
Find visible item to be clicked
Get InfoLogLevel by byte value.
Get updates since the beginning
Helper for database operations.
Manages instances of TextInput.
Maps its methods to method ids.
Remove once bridge is unforked.
Retrieve name of column family.
See ScrollViewListenerModule.js
Size of compressed block cache.
Test HashSkipListMemTableConfig
This enables e.g. the dev menu.
Utility class for creating maps
Utility class for creating sets
We need to find their position.
change log level to debug level
non-null only for group setters
test same call with readOptions
@param comparator java instance.
@param db_path path to database.
@return the name of this module.
Although this might be extended.
Android dp to pixel manipulation
Construct WriteOptions instance.
Crashy crashy exception handler.
Create and/or open the database.
Don't use this action identifier
Get the spacing for a direction.
If no Snapshot is assigned null.
Invoke without round trip to JS.
Level 1 to b-1 need to be empty.
Lifecycle state for an Activity.
Maximum number of level-0 files.
Number of times WAL sync is done
Otherwise, use update animation.
Resizing is inferior to scaling.
See also ScrollViewTestModule.js
See that class for more details.
Set the config for table format.
Set the height of the skip list.
Shuts down statistics collector.
So we expect zero L2 files here.
TODO(t9349129) Don't use timeout
TODO: tell all APIs to shut down
The "tag" comes from iOS naming.
This is the main recursive call.
This specifies the info LOG dir.
Timers fire on frame boundaries.
Useful in special circumstances.
VectorMemTableConfig constructor
We layout non flexible children.
as long as the env is not freed.
found value which fits partially
iterate over current state of db
open DB with two column families
path to JS bundle on file system
store 10,000 random integer keys
verify RequestBodyPart for image
@return CompressionType instance.
@return block cache size in bytes
@return numerical property value.
@return the number of bloom-bits.
Access from native modules thread
Called once animation is finished
Can remove it later if necessary.
Case 1: We dispatched a UI update
Constructs a WriteBatch instance.
Don't intercept ACTION_UP events.
Has to be different than db name.
Helper class for database errors.
Initialize all the native modules
It creates a DialogRootViewGroup.
Manages instances of ProgressBar.
Return size of write buffer size.
Successfully resolve the Promise.
TODO(AR) log a warning message...
TODO: t7936714 merge these events
Test also with createColumnFamily
hit in the compressed block cache
load test data to the write batch
read key/value pairs using MemEnv
repeat the test with WriteOptions
test same method with ReadOptions
update key value pair to newvalue
@param array the array to convert.
@param canvas the canvas to set up
@param context Application context
@param ratio the hash table ratio.
@return if block cache is disabled
@return the number of hash buckets
All units are in pixels (not DPs).
Apply changes to CSSNode hierarchy
Base class for inline image spans.
Called when an animation finishes.
Controls an enclosing ProgressBar.
Dont release C++ Snapshot pointer.
If not a exception must be thrown.
Inspired by Android ColorDrawable.
Intent action for reloading the JS
Iterate over keys using a iterator
Loads the necessary library files.
Manages instances of ReactToolbar.
Must be called from the UI thread.
Otherwise, it continues iterating.
Provides Checkpoint functionality.
Recursively search class hierarchy
Represents a click on the toolbar.
Returns the directory of info log.
Returns the set RocksEnv instance.
SkipListMemTableConfig constructor
TIME SPENT IN IO DURING TABLE OPEN
Test with parameter initialization
fill database with key/value pairs
found value which fits in outValue
have to open default column family
if it contains unicode characters.
miss in the compressed block cache
swallow, no need to handle it here
write key/value pairs using MemEnv
@param canvas the canvas to restore
@param config the mem-table config.
@param view view to update property
A list of packages used by the app.
Allows thread-safe inplace updates.
Exactly onw of the pointers goes up
Fill database with some test values
If we were already finished, ignore
Matches ScrollViewListenerModule.js
Provides stub implementation of QPL
Read LOG file contents into String.
Removes all rows of the keys given.
Retrieve assigned options instance.
Retrieve snapshot from read options
The older manifest file be deleted.
This class works around that issue.
This should be called exactly once.
We ain't doing no newfangled 64-bit
direct access - seek to key offsets
iterate over new_cf key/value pairs
key was written with a newer value.
last argument is a time out boolean
measure only the main executor time
multiple values for the same header
@param maxMemCompactionLevel Unused.
@param path the path to the RocksDB.
@param path the path to the rocksdb.
@return LOG file contents as String.
@return The unique id of this event.
@return instance of iterator object.
@return the currently set index type
@return the height of the skip list.
@return the timestamp of the backup.
A good value is the number of cores.
By default all modules return false.
Can be read by really old RocksDB's.
Compact all L0 files we just created
Compress quality of the output file.
Constructor for StatsCollectorInput.
Default root view for catalyst apps.
Delete a directory and its contents.
Extracts the headers from the Array.
Fill database with some test values.
For initialization and cleanup only.
Give it a name for easier debugging.
Identify the last line of the header
If not a Segmentation fault happens.
If not specified, defaults to false.
In JS this is Image.props.source.uri
Inserts multiple (key, value) pairs.
KeyMayExist in CF1 must return false
Making sure there are some L1 files.
No read or write timeouts by default
Returns the name of the main module.
Shadow node for virtual ARTText view
Stop listening for location updates.
Successful termination of the marker
The target file size for compaction.
compare the results to the test data
developer should have called close()
randomly pick one from the keyBuffer
snapshopot was created before newkey
test that put fails in readonly mode
@param context - application context.
@param db_path Path to store data to.
@return number of items in WriteBatch
@return the thread pool queue length.
Add merge operand for key/value pair.
Check if key size equals cfList size.
Clear properties from previous rounds
Constructor for statistics collector.
Deletes underlying C++ slice pointer.
Holds the current Application Object.
Launch other activities or open URLs.
Making sure there isn't any L0 files.
Native module for JS timer execution.
Otherwise get the size from the view.
Rate limiting is disabled if nullptr.
Return react tag for touched element.
Return the PointerEvents of the View.
Shadow node for virtual ARTGroup view
Shadow node for virtual ARTShape view
Start listening for location updates.
Starts at 1 since bridge starts idle.
TODO(6352048): Support gradients etc.
TODO(6845124): Create a test for this
This exception represents that error.
This needs to fill the entire window.
Used for managing children operation.
We may have already called/removed it
We treat moves as an add and a delete
by default targetFileSizeBase is 2MB.
ignore HTTP call response - see above
ignore callback if call was cancelled
loading possibly necessary libraries.
merge key1 with another value portion
showOrUpdate will display the Dialog.
@param config the table format config.
@param key the key retrieve the value.
@param numLevels the number of levels.
@param view view that will be animated
@return Java typed access to the data.
@return the name of this view manager.
A fragment used to display the dialog.
Allow the OS to mmap file for writing.
Calculates layouts based on CSS style.
Check debug server host setting first.
Create an iterator of a column family.
Deletes underlying C++ filter pointer.
Deletes underlying C++ object pointer.
Event emitted when loading has started
HashSkipListMemTableConfig constructor
If zero it's determined automatically.
Just keep the messages from one thread
Number of Write calls that request WAL
Number of shards used for table cache.
Only set the text if it is up to date.
Operates on the default column family.
Options that control write operations.
Otherwise this method will return true
Returns map containing a single entry.
Soft limit on number of level-0 files.
TargetApi 16 for use of Choreographer.
The config for plain table sst format.
Use reactTagForTouch() to get its tag.
We store timers sorted by finish time.
You probably want to use that instead.
lazy-initialized when a child is added
register reload app broadcast receiver
switchview because switch is a keyword
@param file File or directory to delete
@param msg the specified error message.
@param sparseness the index sparseness.
@return Ordered array of supported ABIs
@return size of compressed block cache.
@return the currently set checksum type
@return the initial size of the vector.
Callback function to get ticker values.
Copyright (c) 2011 The LevelDB Authors.
Deletes underlying C++ handler pointer.
First, remove the node from its parent.
For Java traces there is no difference.
Listener for receiving activity events.
NaN will be used if property gets reset
Props that affect more than just layout
RUN_JS_BUNDLE_END is in JSCExecutor.cpp
Release a previously acquired snapshot.
Runs the given Callable on this Thread.
Runs the given Runnable on this Thread.
Set a table factory and check the names
Spec for creating a MessageQueueThread.
Test with column family and readOptions
The default should work for most cases.
This SoSource loaded the given library.
This is the default as per web and iOS.
Used to pass arguments from Java to JS.
Verify the database exists and is open.
We manually strip it here if necessary.
We set the User-Agent header by default
@param blob binary object to be inserted
@param compactionStyle Compaction style.
@param compressionType Compression Type.
@param count the number of hash buckets.
@param options a map containing options.
@param tickerCount Value of ticker type.
@param ttl time to live for new entries.
@return maximum number of write buffers.
A UI event that can be dispatched to JS.
Clear all updates buffered in this batch
Construct options for opening a RocksDB.
Enumeration of Write Batch event actions
Event emitted when loading is completed.
Get the file this stack frame points to.
Handle width and height style attributes
HashLinkedListMemTableConfig constructor
Module to initialize the Fresco library.
Open the database using a C++ Comparator
Returns maximum number of write buffers.
Set minDate to the beginning of the day.
Sets an icon for a specific icon source.
Sometimes retrieving the database fails.
TODO(5815532): Check if consumed on read
Used to pass parameters from JS to Java.
Uses default provider if null is passed.
unregister app reload broadcast receiver
@param key the key to retrieve the value.
@return The hash code for the Write Entry
@return if whole key filtering is enabled
@return instance of current FlushOptions.
@return the maximum number of open files.
@throws IOException if file is not found.
Allocation-less once it starts listening.
Construct a new instance of FlushOptions.
Define the trailing position accordingly.
Disable child process inherit open files.
Get the drawable that is span represents.
If it returns false, iteration is halted.
Integration test for vertical ScrollView.
Listens for the user shaking their phone.
Make sure we do create one more L0 files.
No further calls are expected after this.
Open the database using a Java Comparator
Responsible for flushing cookies to disk.
Return the length (in bytes) of the data.
Returns a custom path of the bundle file.
Returns map containing the given entries.
Returns the name of the bundle in assets.
Semi-randomly return the next unique key.
Termination of marker due to some failure
The class that controls the get behavior.
Turn shared-library loading into a no-op.
Type of property that will be send to JS.
Unregisters a root node with a given tag.
Will be invalid because abc is after abc1
You never want to go smaller than padding
does key already exist (avoid duplicates)
notify JS about layout event if requested
path to JS bundle root on packager server
@param key the specified key to be merged.
@return the number of hash probes per key.
@return the path to the info log directory
@return the size limit of a manifest file.
@return the target size of a level-0 file.
A drawer must have exactly two children 2.
Activity that display developers settings.
Callback function to get histogram values.
Copyright (c) 2014-present, Facebook, Inc.
Copyright (c) 2015-present, Facebook, Inc.
Delete everything except the latest backup
Deletes underlying C++ compaction pointer.
Deletes underlying C++ comparator pointer.
Destroy this instance, making it unusable.
Do nothing as we are laid out by UIManager
Flush has higher priority than compaction.
Generates a hash code for the Write Entry.
Get this node's flex, as defined by style.
KeyMayExist only incurs in-memory look up.
Listener interface for ReactPicker events.
Multiplies the color with the given alpha.
Number of writes ending up with timed-out.
Prepend our own SoSource for our own DSOs.
Resets this instance to its default state.
Returns the currently set lookahead value.
Returns the size value of hugePageTlbSize.
Returns true on success, false on failure.
Soft limit on the number of level-0 files.
Stub implementation of Action Identifiers.
This is not a general purpose ELF library.
This parameter can be changed dynamically.
Update underlying native SeekBar's values.
View manager for ReactRootView components.
We don't need to handle its layouting here
We want to be consistent across platforms.
by default 'maxBytesForLevelBase' is 10MB.
public access level is required by Mockito
put and get from non-default column family
@param offset offset within the byte array.
@param size the initial size of the vector.
@return the instance of the current Object.
@return the instance of the current Options
@return the number of files of this backup.
@return the specified size of the user key.
Backup process is slower with sync enabled.
Before we touch the body send headers to JS
Called in case when animation was cancelled
Coordinates in the ViewTag coordinate space
Integration test for horizontal ScrollView.
Interface to the JavaScript Systrace Module
It does this the same way as ReactRootView.
Otherwise an undefined behavior will occur.
ReactImageViews only render a single image.
Recreate the react application and context.
Returns the number of updates in the batch.
Returns whether dev mode should be enabled.
Slowly drag the ScrollView to prevent fling
Some (general) drawing action has completed
Supports non-default checksum, like xxHash.
Switch that has its value controlled by JS.
Termination of marker due to a cancellation
Test open database with column family names
This can significantly reduce memory usage.
This is left as an exercise for the reader.
Update pointer position for current gesture
Utility for interacting with the UI thread.
ViewManager for ARTSurfaceView React views.
We start slowing down writes at this point.
iterate over current state of column family
null if it does not find the specified key.
@param key the specified key to be inserted.
@return if true, then data-sync is disabled.
@return the instance of the current Options.
@return the reference to the current config.
@return the reference to the current option.
A spec for animation operations (add/remove)
Apply the specified updates to the database.
Base Activity for React Native applications.
Don't show the dialog if the host is paused.
Find first character that can be incremented
Get permission to show redbox in dev builds.
Get this node's border, as defined by style.
If this flag is true, writes will be slower.
It is only used when dev support is enabled.
Module that exposes Android Constants to JS.
Only show the first and most actionable one.
Returns the maximum size of a info log file.
Send property updates to native view manager
Set maximum number of entries in one bucket.
Set the database entry for "key" to "value".
Sets the index type to used with this table.
Spec for creating a ReactQueueConfiguration.
animation has completed, no more frames left
e.g. source is landscape, target is portrait
native view that wraps view added to adapter
protect against int key calculation overflow
@param statistics Reference of DB statistics.
@param ttl TTL to set for this column family.
@return One of the LOAD_RESULT_XXX constants.
@return Whether JS bundle should be minified.
@return Whether element inspector is enabled.
@return the reference of the current Options.
A JS exception that was propagated to native.
All events for a given view can be coalesced.
Always return true if we are already focused.
Android SeekBar only supports integer values.
Do something to display or log the exception.
If 0 or negative, then go as fast as you can.
It computes its size based on the input size.
Listener interface for react instance events.
May or may not actually create a native view.
Native module that exposes Geolocation to JS.
Private constructor to disallow instantiation
Releases all references to given native View.
Remove the database entry (if any) for "key".
Report an exception, with default error code.
Results are stored in the given outputBuffer.
Set the textview that will contain this span.
Sets the initial lifecycle state of the host.
Shared utility for asserting on MeasureSpecs.
TODO(yhchiang): use (Integer)Flag.perf_level.
This check force a check right when intended.
This option is good for bulk-loading of data.
Use android View id field to store React tag.
Verify that we've visited *all* active nodes.
do fast check whether intersect state changed
read key/value pairs after flush using MemEnv
register it within NativeViewHierarchyManager
set or setException must only be called once.
user compaction function has dropped the key.
@return The string representation of the data.
@return numShardBits the number of shard bits.
@return the maximum size of the info log file.
Animated node that represents view properties.
CREATE_REACT_CONTEXT_END is in JSCExecutor.cpp
Calculate the coordinates for the target view.
Calling this method twice will have no effect.
For handling node removal from manageChildren.
Helper for generating JSON for lists and maps.
If true column families be created if missing.
In that case local JS executor should be used.
It will be available on the JS error instance.
Listener interface for memory pressure events.
Module that handles global application events.
Note that there should be no module2 returned.
Note: this **DOES NOT** consume the source map
Number of files to trigger level-0 compaction.
Options to control the behavior of a database.
Record the number of calls to GetUpadtesSince.
Reflection exceptions are rethrown at runtime.
Request to toggle the react element inspector.
Restore the canvas after an element was drawn.
Return true if the length of the data is zero.
See CatalystApplicationFragment as an example.
Simple Json generator that does no validation.
Specifies the maximum size of a info log file.
Statistics to analyze the performance of a db.
TODO(7854667): handle and test proper clipping
The config for vector memtable representation.
This optimization is turned off when set to 0.
This view and its children can't be the target
Use the specified comparator for key ordering.
Used for rounded border and rounded background
Used to locate views in end-to-end (UI) tests.
make sure the default rounding method is used.
oldJSON will contain the result of this merge.
parent must point to a valid RocksDB instance.
reinsert k1 and make sure we see the new value
see reasoning for this check a few lines above
taken from Libraries/Utilities/MessageQueue.js
write throttle because of too many files in L0
@param timeout value of 0 results in no timeout
@return methods callable from JS on this module
@return the Snapshot assigned to this instance.
@return width corrected for rounding to pixels.
A event dispatched from a ScrollView scrolling.
Any negative number means use default settings.
Approximate size of user data packed per block.
Get this node's width, as defined in the style.
If 0, all logs will be written to one log file.
In this case, callback parameter will be false.
Maximum number of bytes in all compacted files.
Note: this consumes the map so do not reuse it.
Returns the font family set for this StyleSpan.
See the AUTHORS file for names of contributors.
Should be either FLUSH_POOL or COMPACTION_POOL.
Simple type conversion methods for use in tests
So for the other modes, we use a postprocessor.
Spacing type that represents the top direction.
Test without column family but with readOptions
The default implementation always returns true.
The destination file will be marked executable.
The order in which packages are passed matters.
This static ctor wrapper protects against that.
Time system had to wait to do LO-L1 compactions
Time system had to wait to move memtable to L1.
You should be good by leaving it at default 10.
compute the line's height and find the endIndex
don't use Robolectric before initializing mocks
read for newkey using the snapshot must be null
throws RocksDBException if something goes wrong
verify key/value pairs after flush using MemEnv
@return An iterator for the Write Batch contents
@return height corrected for rounding to pixels.
@return the currently configured format version.
A Runnable that has a native run implementation.
Adds a idle listener for this Catalyst instance.
Create an iterator of the default column family.
DBOptions to control the behavior of a database.
Encapsulates a Thread that can accept Runnables.
Event emitted when there is an error in loading.
Get the name of the method this frame points to.
Get the value associated with the specified key.
Get this node's height, as defined in the style.
If it's set to 0, then each key will be indexed.
Influence the behavior when kHashSearch is used.
Invoked when there is a mutation in a node tree.
Load a shared library library into this process.
Number of open files that can be used by the DB.
POJO to hold the output of the measure function.
Report an exception with a custom error message.
Set the resolved resolution in the node's layout
Sets the maximum size the database will grow to.
Spacing type that represents the left direction.
The debug server returns errors as json objects.
The periodicity when obsolete files get deleted.
This is necessary for making layout thread-safe.
We only run if there's a width or height defined
empty constructor that can be used by subclasses
getLocationOnScreen will include the status bar.
merge on non existent key shall insert the value
monospace bold pre Android 5.0), that style (ie.
update k2 in the write batch and check the value
@param keysAndValues keys and values, interleaved
@param position the position of the selected item
@param value byte representation of InfoLogLevel.
@return the instance of the current WriteOptions.
@return the reference to the current ReadOptions.
@return whether this module supports web workers.
Absolute elements do not take part in that phase.
Allow the OS to mmap file for reading sst tables.
Also logs the current FPS to logcat while active.
Animation objects can be "started" and "stopped".
Calculate the base64 representation for an image.
Called when determining the touch area of a view.
Creates a view and installs event emitters on it.
Get this node's align items, as defined by style.
If 0, then block_cache_compressed is set to null.
It is possible to expose all kind of information.
Note that there should be no managerNo2 returned.
Number keys updated, if inplace update is enabled
Package defining basic modules and view managers.
Resets the spacing instance to its default state.
Returns an array with all keys from the database.
Returns the currently assigned Snapshot instance.
Should be added to the debug manifest of the app.
Spacing type that represents the right direction.
The config for skip-list memtable representation.
The parent already computed us a width or height.
The size of one block in arena memory allocation.
This method also sets the child's mParent to null
Value -1 means files opened are always kept open.
Verify the database is open for reads and writes.
We can only proceed forward if we have a Context.
We need to remove the status bar from the height.
bold) will not be inherited by nested Text nodes.
iterate using a snapshot on default column family
since they are optional, we ignore loading fails.
@param context the ReactContext of the application
@param reserved_bytes reserved size for WriteBatch
@return The name of this comparator implementation
@return the name of this event as registered in JS
@return the number of shards used for table cache.
@return true if there is no data, false otherwise.
Base class for all Env implementations in RocksDB.
Base class for various catalyst animation engines.
Called when the system generates a memory warning.
Class responsible for dispatching UI events to JS.
Container gets events but none of its children do.
Controls the number of shards for the block cache.
Copyright (C) 2011 the original author or authors.
Delete the old libs directory if we don't need it.
Get the URL where the last bundle was loaded from.
Get this node's position top, as defined by style.
Interface for getting animation lifecycle updates.
RestoreOptions to control the behavior of restore.
Returns null if we're not attached to an Activity.
Sets the checksum type to be used with this table.
Spacing type that represents the bottom direction.
Start animating only the first addition input node
This is used when reloading JS during development.
This method returns true if the iterator is valid.
This unfortunately leads to some code duplication.
This view is the target, its children don't matter
Use to control write rate of flush and compaction.
View manager for AndroidViews (plain React Views).
We implement the Modal by using an Android Dialog.
no worth marking as dirty if it already rendered..
remove k1 and make sure we can read back the write
resetNative() may be called multiple times safely.
@return Options instance assigned to this instance.
@return boolean value indicating if sync is active.
All scroll events for a given view can be coalesced
All slide events for a given view can be coalesced.
Callback interface provided to StatisticsCollector.
Constructs a WriteBatch instance with a given size.
Contains static helper methods for accessing props.
Currently supports only vertically positioned item.
Enqueues a UIOperation to be executed in UI thread.
Facebook reserves all rights not expressly granted.
Find the offset of the dynamic linking information.
Flushes to disk with a maximum delay of 30 seconds.
Get just the name of the file this frame points to.
Get remote param before calling super which uses it
Get this node's direction, as defined in the style.
Get this node's position left, as defined by style.
Get this node's position type, as defined by style.
Implementation of a read-only map in native memory.
Implements the XMLHttpRequest JavaScript interface.
IndexType used in conjunction with BlockBasedTable.
Issue one request for every bytes_per_sync written.
Manages Images embedded in Text nodes using Fresco.
Reusing database options and column family options.
Support for iterating over the contents of a batch.
The caller must not use "snapshot" after this call.
Therefore it can be used to calculate node's value.
This method will be called at the end of animation.
This method will be called before animation starts.
Uses this plus total elapsed time to determine FPS.
Utility class that access default values from style
Waits for both the UI thread and bridge to be idle.
messages shall be received due to previous actions.
new context is the same as the old one - do nothing
only set up the canvas if we have something to draw
@return boolean value indicating if WAL is disabled.
@return currently set value for store index in file.
@return false if this Event can *never* be coalesced
@return the number of locks used for inplace update.
All switch events for a given view can be coalesced.
Always write full keys without any special encoding.
Animated node that plays a role of value aggregator.
Base class for different types of animation drivers.
By default, just chooses the one the is more recent.
Clearing the database has failed, delete it instead.
Copy from an inputstream to a named filesystem file.
Get this node's flex direction, as defined by style.
Get this node's position right, as defined by style.
Helper class that deals with emitting Scroll Events.
If no constants are exported this should do nothing.
If the column family is not known removal will fail.
If view is becoming invisible, use delete animation.
If you need this use GuardedResultAsyncTask instead.
In JS this is Image.props.loadingIndicatorSource.uri
It is used to find the target View of a touch event.
Manifest file is rolled over on reaching this limit.
Offsets above are identical in 32- and 64-bit cases.
On these systems, we resolve dependencies ourselves.
Provides access to React Native developers settings.
Removes the *last* n items of the array all at once.
Report an error which wasn't caused by an exception.
Returns OK on success, and a non-OK status on error.
Store number of visited nodes in `activeNodesCount`.
TODO: t11041683 Remove this duplicate property name.
That will fill the entire window of the application.
The eventTime for each event is still set correctly.
This is used to schedule rendering of the component.
This loader is used when proxy debugging is enabled.
This makes WRAP_CONTENT work in Toolbar's internals.
This method is overridden because of two reasons: 1.
do not set state to destroyed, do not send an event.
should only be accessed from main thread (UI thread)
@return a map of constants this module exports to JS.
@return the hard limit of the number of level-0 file.
@return the name of the currently used table factory.
A spec for an operation on the native View hierarchy.
After the drop the native handle is not valid anymore
Animation responsible for updating opacity of a view.
Centralized OkHttpClient for all networking requests.
Class responsible to load and cache Typeface objects.
Do not shorten if one string is a prefix of the other
Either this view or one of its children is the target
Get this node's justify content, as defined by style.
Get this node's position bottom, as defined by style.
NB: Requires API 16 for use of FpsDebugFrameCallback.
Note that the slider is _not_ a controlled component.
Remove all styling spans we might have previously set
Set and initialize CatalystInstance for this Context.
TODO(AR) revisit here when implementing AutoCloseable
The caller owns the returned value and may mutate it.
Then wrapping lists into sets to be order-independent
This is useful e.g. when a user logs out from an app.
This must generally be true for gets to be efficient.
This view can't be the target, but its children might
Use the specified filter policy to reduce disk reads.
We can coalesce move events but not start/end events.
We check for exopackage dir update time in that case.
Writer has to wait for compaction or flush to finish.
e.g. "file://sdcard/myapp_cache/index.android.bundle"
getInputType will return whatever value is passed in.
test replace one with another merge operator instance
@param n use the first n bytes of a key as its prefix.
@param numFiles soft limit on number of level-0 files.
@return the current instance of SkipListMemTableConfig
@return the soft limit on the number of level-0 files.
@return whether we should request minified JS bundles.
A module that allows JS to get/set clipboard contents.
After reopen the values shall still be in the mem env.
Class that contains the data needed for a text update.
Create new logger with max log level passed by options
Determine how preferred a given ABI is on this system.
Ensure that a shared library exists on disk somewhere.
If LayoutParams sets size explicitly, we can use that.
Memtable format can be set using setTableFormatConfig.
Multiple implementations are provided by this library.
NB: this class should only be used from the UI thread.
Neither the container nor its children receive events.
On other systems, Bionic's built-in resolver suffices.
Path to your app's main module on the packager server.
Set the exception handler for all native module calls.
Shadow node for ART virtual tree root - ARTSurfaceView
The maximum size cannot be set below the current size.
Then Wrapping lists into sets to be order-independent.
They will be updated and accessed only from JS thread.
This view is the view that is displayed by the Dialog.
To explicitly delete the instance, call resetNative().
We "execute" active animations as a part of this step.
Will be abc3 because the next one after abc999 is abc3
if currently profiling stop and write the profile file
@param blockCacheNumShardBits the number of shard bits.
@return the size limit of the total sum of table files.
Abstract tests for both Comparator and DirectComparator
Add a listener to be notified of react instance events.
Add merge operand for key/value pair in a ColumnFamily.
BlockBasedTable is a RocksDB's default SST file format.
Database supplier of the database used by react native.
Drops the column family identified by columnFamilyName.
Handle enqueued request to re-initialize react context.
If the format is invalid, this method will return null.
If true, the database will be created if it is missing.
Only Events that have the same cookie can be coalesced.
Operation for updating native view's position and size.
See comment above as to why this is not correct to use.
Store and use in the next loadApplicationScript() call.
That's why we recommend to limit the number of backups.
The config for hash skip-list mem-table representation.
This is to include all the setters from parent classes.
This targetFileSizeBase determines a level-1 file size.
Used by all types of background and for drawing borders
We can't specify rounding in XML, so have to do so here
shall throw an exception because db dir does not exist.
then it's not successful, the output will indicate this
@return the name of the currently-used memtable factory.
@return the reference to the current comparator options.
@return true if thread-safe inplace updates are allowed.
A mutation or animation operation on the view hierarchy.
Add a listener to be notified of memory pressure events.
Any Exception caught here is because of something in JS.
Checksum types used in conjunction with BlockBasedTable.
Container doesn't get events but all of its children do.
Destroy this React instance and the attached JS context.
Dispatch this event to JS using the given event emitter.
Dummy implementation of storage module, used for testing
Event emitted by EditText native view when text changes.
Extract SoLoader boottsrap information from an ELF file.
Get new Snapshot of database set snapshot in ReadOptions
However, chances are some of the backups are consistent.
In that case, no TextChanged events should be triggered.
Interface for fast tracking the initial adding of views.
Internal handles to this column family will be disposed.
Moreover, they are not consistent with what iOS returns.
Note: Comparator can be set once upon database creation.
Reset the flag since we are going to create a new dialog
Returns a map of keys for which values were found in DB.
Returns the maximum number of info log files to be kept.
Sets the number of bits used in the prefix bloom filter.
Space on the edges is half of the space between elements
The number of hash probes per key used in the mem-table.
The remaining available space that needs to be allocated
The set log level influences the underlying native code.
The supported custom fonts extensions are .ttf and .otf.
This is the default behavior on other platforms as well.
Use KeyMayExist API to filter deletes when this is true.
Utility for determining coalescing keys for TouchEvents.
We don't have to measure the text within the text input.
We just go for the option that require less calculations
null will be returned if the specified key is not found.
write key/value pairs using MemEnv to db and to otherDb.
@param enabled whether layout animation is enabled or not
@param maxBytesForLevelBase maximum bytes for level base.
@param value the value associated with the specified key.
@return Whether dev mode should be enabled in JS bundles.
@return maximum bytes of overlaps in "grandparent" level.
@return opacity expressed by one of PixelFormat constants
@return the number of shard bits used in the block cache.
A higher level API on top of the asynchronous JSC bridge.
Constructs a slice where the data is taken from a String.
Create Error object to be passed back to the JS callback.
Event emitted when the user finishes dragging the slider.
In particular, it will not be persisted to the SST files.
LayoutAnimation API on Android is currently experimental.
Listener for receiving activity/service lifecycle events.
NB: we assume two gestures cannot begin at the same time.
Native module that provides image cropping functionality.
Package defining core framework modules (e.g. UIManager).
Parse a DebugServerException from the server json string.
Position is meaningful when the click happenned on a menu
Return true if the create_if_missing flag is set to true.
Returns the name of the current mem table representation.
Returns the number of shard bits used in the block cache.
Returns the path to the write-ahead-logs (WAL) directory.
Returns the value of the given key, or null if not found.
The number should never be greater than number of probes.
This is applied only if cacheSize is set to non-negative.
This is to guarantee that scaling is performed correctly.
This will be added to the TextView in place of this node.
Use this class for writing integration tests of catalyst.
We create ProgressBars on both the UI and shadow threads.
put data to the write batch and make sure we can read it.
@param blockCacheCompressedSize of compressed block cache.
@param columnFamilyDescriptor column family to be created.
@param handle The address of the underlying native object.
@param keys of keys for which values need to be retrieved.
@param maxLogFileSize the maximum size of a info log file.
@param value the out-value to receive the retrieved value.
@return a boolean indicating whether paranoid-check is on.
@return the view id for the view that generated this event
@return true if the createIfMissing option is set to true.
A RocksDB is a persistent ordered map from keys to values.
A RocksDBException encapsulates the error of an operation.
ColumnFamilyOptions to control the behavior of a database.
Compress blocks using the specified compression algorithm.
Converts JS resize modes into Android-specific scale type.
Event emitted by EditText native view when it loses focus.
For rounded borders we use default "borderWidth" property.
Helper class for obtaining information about local images.
If VARIABLE_LENGTH, then it indicates variable-length key.
If cacheSize is non-positive, then cache will not be used.
Is used for multiline, boring text and the width is known.
It is not an error if "key" did not exist in the database.
NOTE: This drawing code is copied from DynamicDrawableSpan
Now we move the coordinates to the View's coordinate space
Only SCROLL events can be coalesced, all others can not be
Pointer for statistics object is managed by Options class.
Prefetches the given image to the Fresco image disk cache.
Provides a clearer exception message than the default one.
RocksDB.NOT_FOUND will be returned if the value not found.
Specifies the maximum number of info log files to be kept.
TODO: t9053573 is tracking that this code should be shared
The insertion will replace conflicting (key, value) pairs.
This creates, opens and deletes the database as necessary.
This is cheap as everything else is shared under the hood.
Useful to keep track of transaction log iterator refreshes
Using this method will pass the error code "EUNSPECIFIED".
ignore malformed uri, then attempt to extract resource ID.
measure() should never be called before setThemedContext()
verify that X get updated when we update layout properties
@return the maximum number of bytes in all compacted files.
And we recursively call the layout algorithm for this child
Callers may wish to set this field to false for bulk scans.
Case 2: Ended idle but no UI was enqueued during that frame
Each block may be compressed before being stored in a file.
If we return true here than UP event will not be delivered.
Implementation of a write-only map stored in native memory.
Instead, the drawing code should apply opacity recursively.
NB: For simplicity, we catch and wrap InterruptedException.
Resource to trigger garbage collection after each test run.
Returns the number of bits used in the prefix bloom filter.
Set if the flush operation shall block until it terminates.
Slider that behaves more like the iOS one, for consistency.
Starts a corresponding external activity for the given URL.
The temporary file will be registered for deletion on exit.
This causes the parent to update its native children count.
This is registered after JS starts since it makes a JS call
Update value only (optimization in case only value is set).
index is "closer" to the last cached index than it is to 0.
keyboard is now showing, or the keyboard height has changed
@param targetFileSizeBase the target size of a level-0 file.
@return boolean value indicating if the iteration is halted.
@return if distrubtion of number of entries shall be logged.
@return the MessageQueueThread that owns the current Thread.
@throws java.io.IOException if a filesystem operation fails.
An event representing the start, end or movement of a touch.
Fill the cache when loading the block-based sst formated db.
Fresco currently sets drawables' intrinsic size to (-1, -1).
Handler callback for iterating over the contents of a batch.
Helper for view managers to handle commands like 'scrollTo'.
If no view was found, callback will be invoked with no data.
If true, place whole keys in the filter (not just prefixes).
Initialize a dbOptions object from cf options and db options
Interface for a map that allows typed access to its members.
Last, third argument represent the value that should be set.
Request react instance recreation with JS debugging enabled.
Returns the input stream for a file given by its contentUri.
Set a default padding (left/top/right/bottom) for this node.
So instead we generate a quasi-dynamic string to confuse it.
TODO: Remove registered check when source of crash is found.
The upper-bound of the total size of level-1 files in bytes.
This SoSource doesn't know how to provide the given library.
This class doesn't allow doInBackground to return a results.
We override measure spec and use dimensions of the children.
retrieve key value pair created before the snapshot was made
@param bitsPerKey the number of bits per key for bloom filer.
@param maxManifestFileSize the size limit of a manifest file.
@param mimeType the MIME type of the file to create (image/*)
@return entries per bucket threshold before SkipList is used.
@return map of string to int mapping of the expected commands
@return the host to use when connecting to the bundle server.
@return the number of bits per key used for the bloom filter.
Also remember where the string table for those entries lives.
Append a blob of arbitrary size to the records in this batch.
Base node class for representing virtual tree of React nodes.
Called on the JS thread after a ReactBridge has been created.
Controls the number of shards for the block compressed cache.
Creates a RequestBody from a mediaType and inputStream given.
Ensure that it is so that this event gets delivered promptly.
Event emitted by EditText native view when it receives focus.
Fill the cache when loading the block-based sst formatted db.
For universal-style compaction, you can usually set it to -1.
Get rectangular bounds to which view is currently clipped to.
Get this node's margin, as defined by style + default margin.
Gets the view with a given react test ID in the UI hierarchy.
If the action is dismiss, year, month and date are undefined.
If true the distrubition of number of entries will be logged.
Ignore this error and just fallback to loading JS from assets
Implementation of a write-only array stored in native memory.
Interface for the configuration object that is passed to JSC.
Keys will be iterated in the order given by index_comparator.
Let's not measure the text if we already know both dimensions
Path to the JS bundle file to be loaded from the file system.
Returns the root view of a given view in a react application.
Set the branching factor used in the hash skip-list memtable.
TODO(6818138): Solve use-case of native/js modules overriding
TODO: Call the method directly when this is no longer needed.
The value is actually handled in NativeViewHierarchyOptimizer
This makes sense because we never run the devserver in tests.
This method is idempotent: calls after the first are ignored.
Uses reflection to create DevSupportManagerImpl if it exists.
since it may be optional, we ignore its loading failure here.
there should be zero messages using fatal level as log level.
@deprecated Prefer passing a module-specific error code to JS.
@param numFiles the hard limit of the number of level-0 files.
Checkpoints provide persistent snapshots of RocksDB databases.
Class representing CSS spacing (padding, margin, and borders).
Creates a RequestBody from a mediaType and gzip-ed body string
Event can be null if it has been coalesced into another event.
Fallback gracefully for cross-platform compat instead of error
If it is empty, the log files will be in the same dir as data.
If step is 0 (unset) we default to this total number of steps.
Ignores duration and immediately jump to the end of animation.
Indicating if we'd put index/filter blocks to the block cache.
JS Queue Thread: The thread and Looper that JS is executed on.
Keys for props that need to be shared across multiple classes.
List of available application is located in TestBundle.js file
One way to make this lighter weight is to avoid doing any IOs.
Returns true for the layout to *not* be automatically invoked.
Set maxDate to the end of the day, same reason as for minDate.
Set the amount of cache in bytes that will be used by RocksDB.
The current text gets replaced with the text received from JS.
These are merged back on the JS side into one React component.
These specs allows the Threads to be created fully configured.
This is because logout implies that the instance is destroyed.
This loader is used when bundle gets reloaded from dev server.
This occurs when the size of mEventsToDispatch is zero or one.
This takes into account any default values that have been set.
Touch event can encode multiple concurrent touches (pointers).
Tracks errors connecting to or received from the debug derver.
Values must have suffix V2 because of restoring latest backup.
ViewManager for all shadowed ART views: Group, Shape and Text.
@param keys List of keys for which values need to be retrieved.
@param nativeHandle The native handle of the C++ RocksDB object
@return true if the createMissingColumnFamilies is set to true.
@return whether an overlay showing current FPS should be shown.
@return whether createReactContextInBackground has been called.
A listener that is notified about view hierarchy update events.
Animation responsible for updating size and position of a view.
At this point we know the final size and margin of the element.
Call with the present values in order to re-layout if necessary
Do not throw an error in the case animation could not be found.
Get this node's padding, as defined by style + default padding.
If it was intersecting before, should be attached to the parent
If the server error has the expected form, fail with more info.
If this value is set to zero, then hash table will not be used.
Interface for an array that allows typed access to its members.
Lazily initialize as FrescoModule have not been initialized yet
Return true, since DrawerLayout will lay out it's own children.
Returns the maximum number of concurrent background flush jobs.
TODO(yhchiang): this option seems to be block-based table only.
That table is a pointer, which we translate to an offset below.
The dimensions can never be smaller than the padding and border
The internal version of this file has not been opensourced yet.
This loader is recommended one for release version of your app.
This re-occurrence is detected by comparing a name of a module.
This will draw a line from the last draw point (or 0,0) to x,y.
Touch event types that JS module RCTEventEmitter can understand
Use instead size of text content within EditText when available
Verify that 'scrollTo' command makes ScrollView start scrolling
We have to include the module id in the stack for that, though.
We use this Dialog to actually display the Modal in the window.
large enough to serve all typical value sizes we want to write.
@param host The host that the HMRClient should communicate with.
@param statsCallback Reference of statistics callback interface.
@return if index and filter blocks should be put in block cache.
@return the reference to the current HashSkipListMemTableConfig.
A low-pri request is usually blocked in favor of hi-pri request.
Add SoSource objects for each of the system library directories.
Add all of the layout-only node's children to its parent instead
Close this executor and cleanup any resources that it was using.
However, if the mutex is hot, we could end up wasting spin time.
IMPORTANT: This class should be accessed only from the UI Thread
If you want to builder full filter, it needs to be set to false.
Implement this method to provide application key to be launched.
Intermediate negative values can mess this computation otherwise
Load a shared library, initializing any JNI binding it contains.
Request to receive the component hierarchy for a particular tag.
Scroll event types that JS module RCTEventEmitter can understand
Subclasses should return a new View instance of the proper type.
Suppress any callbacks if destroyed - will only lead to sadness.
That's why it support only a set of properties of the same type.
The maximum number of write buffers that are built up in memory.
The returned iterator should be closed before this db is closed.
This method is currently used only by Element Inspector DevTool.
This should return non-bubbling directly-dispatched event types.
This specifies the absolute dir path for write-ahead logs (WAL).
UI Queue Thread: The standard Android main UI thread and Looper.
Update `mIncomingNodes` attribute for each node during that BFS.
Utility method used to help develop web workers on debug builds.
We can never assign a width smaller than the padding and borders
set LIMIT to first + 1 so that we know how to populate page_info
update visibility of FPS debug overlay depending on the settings
@param blockCacheCompressedNumShardBits the number of shard bits.
@param bridge the ReactBridge instance that has just been created
@param columnFamilyOptions options to be used with column family.
@return whether we should enabled HMR when requesting JS bundles.
A set of Java APIs to expose to a particular JavaScript instance.
Add option item to dev settings dialog displayed by this manager.
Add the node and all its children as if we are adding a new nodes
As this should only be the case in dev mode we leave it as it is.
Available compaction styles can be chosen using this enumeration.
Class corresponding to a JS VM that can call into native modules.
Class that receives intents whenever the connection type changes.
Comparator instance can be re-used in multiple options instances.
Determine whether or not an installed app can handle a given URL.
Ensure that the MQT is registered by the time this method returns
Event emitted by a DrawerLayout as it is being moved open/closed.
Exceeding this val leads to a switch from LinkedList to SkipList.
Gets the view at given path in the UI hierarchy, ignoring modals.
Interface for receiving notification for bridge idle/busy events.
Interface for the root native view of a React native application.
Larger values increase performance, especially during bulk loads.
Last "special" elements of the the graph are "animation drivers".
No-op since UIManagerModule handles actually laying out children.
Spacing type that represents vertical direction (top and bottom).
Specifies the maximum number of concurrent background flush jobs.
The element we are about to add would make us go to the next line
The pointer to the snapshot is released by the database instance.
This check is potentially lighter-weight than invoking DB::Get().
This is different from the FPS above since JS rendering is async.
Try to get start value and fallback to given type if not defined.
We can't use scaling as view content may not necessarily stretch.
We only want the values of what will actually be shown on screen.
We want to execute the next two loops one per line with flex-wrap
when the iterator is deleted it will also delete the baseIterator
@param platform The platform in which HMR updates will be enabled.
@param statsCollectorInputList List of statistics collector input.
@param uiViewOperationQueue interface for enqueueing UI operations
@return the reference to the current HashLinkedListMemTableConfig.
Android only supports 0..max range so we implement this ourselves.
Comparators are used by RocksDB to determine the ordering of keys.
Create the view since it doesn't exist in the native hierarchy yet
Data structure that couples view tag to it's index in parent view.
Dialog for displaying JS errors in an eye-catching form (red box).
For use by perf markers that need to happen immediately after draw
If the layout is null, the view hasn't been properly laid out yet.
Interface for accessing and interacting with development features.
It will also move all log files from archive directory to wal_dir.
Make sure you know what you're doing before calling this method :)
Number of bytes to preallocate (via fallocate) the manifest files.
Recreate debug overlay controller with new CatalystInstance object
Removes an existing Animation, canceling it if it was in progress.
Returns the name of the main component registered from JavaScript.
Set the number of hash buckets used in the hash skiplist memtable.
The ColumnFamilyHandle is automatically disposed with DB disposal.
The JavaScript side expects a map with at least the error message.
The animation will only apply during the current batch operations.
This is the absolute position including things like the status bar
This is used by android in certain places, such as text selection.
This method will return false if the animation has been cancelled.
This object holds a native C++ member for hybrid Java/C++ objects.
This value will be used only when a prefix-extractor is specified.
Those are like "pulse generators" for the rest of the nodes graph.
using no snapshot the latest db entries will be taken into account
3) Iterate the views being added by index low to high and add them.
@param memtablePrefixBloomProbes the number of hash probes per key.
@param threshold maximum number of entries before SkipList is used.
@return the size ratio between a level-(L+1) file and level-L file.
A native module whose API can be provided to JS catalyst instances.
An illegal argument Exception caused by an argument passed from JS.
Animation loop performs two BFSes over the graph of animated nodes.
Control locality of bloom filter probes to improve cache miss rate.
Forces animation to be playing 10x slower, used for debug purposes.
Is used when the width is not known and the text is not boring, ie.
JSTouchDispatcher handles dispatching touches to JS from RootViews.
Names starting with "rocksdb." are reserved and should not be used.
Number of keys written to the database via the Put and Write call's
Purge duplicate/deleted keys when a memtable is flushed to storage.
Returns whether encode type indicates the body needs to be gzip-ed.
See the documentation of needsOffscreenAlphaCompositing in View.js.
Spacing type that represents horizontal direction (left and right).
TODO(5483031): Only dispatch updates when shadow views have changed
TODO(7728153) : animating view deletion is currently not supported.
The default value is MAX_INT so that roll-over does not take place.
This method retains an instance to provided mDefaultBackButtonImpl.
To retain that style, you have to add it to those nodes explicitly.
We have to open the stream again, like in the example linked above.
@return the upper-bound of the total size of level-1 files in bytes.
A utility for getting the MessageQueueThread for the current thread.
As a result, incorrect use of this function may cause a memory leak.
ByteBuffer based slices perform better when large keys are involved.
Callback for when we receive the ownership hierarchy in native code.
Example where this can happen: HorizontalScrollView in a ScrollView.
Get the real display metrics if we are using API level 17 or higher.
Ignore this error and just fallback to downloading JS from devserver
Incoming charSequence gets mutated before onTextChanged() is invoked
Interface used to update particular property types during animation.
May be used to enqueue additional ui operations for the native view.
React test ID is currently propagated into view content description.
Should be called from the child's onTouchIntercepted implementation.
The Name() value of the prefix extractor will be stored in the file.
The private construct used by a set of public static factory method.
The real metrics include system decor elements (e.g. soft menu bar).
This enables incremental backups and avoids unnecessary data copies.
This prefix-extractor uses the first n bytes of a key as its prefix.
We need to know how many there are in order to distribute the space.
We store number of visited nodes in this step in `updatedNodesCount`
We'll do that when the parent node actually gets attached somewhere.
create default UIImplementationProvider if the provided one is null.
there should be more than zero received log messages in debug level.
@return whether we should enable dev mode when requesting JS bundles.
Event emitted by EditText native view when the user submits the text.
Get the value associated with the specified key within column family.
If a value has already been set, this method will return immediately.
If this is specified, the cropped image will be resized to that size.
Make sure TextView has exactly one span and that span has given type.
Measures the view specified by tag relative to the given ancestorTag.
MemTableConfig is used to config the internal mem-table of a RocksDB.
Nothing in data payload, at least nothing we could understand anyway.
Return a boolean value indicating if index shall be stored in a file.
Returns the time interval for the info log file to roll (in seconds).
Start animating for the first addition input node, will have 6 frames
They use it to calculate and cache information used in the draw pass.
This is possible since we don't inflate React views from layout xmls.
This is used in cases the bundle should be loaded from a custom path.
WriteBatch holds a collection of updates to apply atomically to a DB.
attempt to copy the library from the Jar file to the temp destination
@param refillPeriodMicros this controls how often tokens are refilled.
@return boolean value indicating if key does not exist or might exist.
@return maximum number of entries in one bucket before logging starts.
Annotation which is used to mark methods that are exposed to Catalyst.
Base class for an array whose members are stored in native code (C++).
Called when the react context is initialized (all modules registered).
Cookie handler that forwards all cookies to the WebView CookieManager.
Delete files in libsDir that we don't provide or that are out of date.
Enum CompactionStyle  RocksDB supports different styles of compaction.
Event emitted by EditText native view when the text selection changes.
For some examples please refer to ARTGroupCSSNode or ReactTextCSSNode.
If number of entries in one bucket exceeds that setting, log about it.
Interface for something that knows how to wait for bridge and UI idle.
Mockito loads this with reflection, so this class might appear unused.
Name of the JS bundle file to be loaded from application's raw assets.
Return true if the create_missing_column_families flag is set to true.
Sets up the transform matrix on the canvas before an element is drawn.
Stub definition of identifier needed in react native open source code.
Test removal in same test, since it's costly to set up the test again.
The bridge will not become busy again until a timer, touch event, etc.
There are three kind of children, non flexible, flexible and absolute.
This annotation is meant to be used for a group of similar properties.
This is class represents java version of native js executor interface.
Walk the items in the dynamic section, counting the DT_NEEDED entries.
We don't need to do bubbling in native (it's already happening in JS).
the latest sequence number is 5 because 5 puts were written beforehand
Doesn't get updated during drag (slider is not a controlled component).
Handler that can catch and dispatch Exceptions to an Exception handler.
Handles native children cleanup when css node is removed from hierarchy
If empty try to detect emulator type and use default hostname for those
If the initial capacity was 1 we need to ensure it at least grows by 1.
If there is a up-to-date bundle downloaded from server, always use that
Maximum number of successive merge operations on a key in the memtable.
Note that the sync() may not be required but is here of legacy reasons.
Returns null if the file has not been found or if an error as occurred.
Returns the FpsInfo as if stop had been called at the given upToTimeMs.
Spacing type that represents all directions (left, top, right, bottom).
Specifies the time interval for the info log file to roll (in seconds).
StringAppendOperator is a merge operator that concatenates two strings.
The listener should be purely passive and not affect application logic.
The shared library is extracted to a temp folder and loaded from there.
This allows to use the rocksjni default Options instead of the c++ one.
This avoids lazy-loading some phones (LG) use when we call loadLibrary.
We're missing the last padding at this point to get the final dimension
You may need to increase this if your database has a large working set.
no-op: it's here only so that "collapsable" property is exported to JS.
test the round-tripability of keys written and read with the Comparator
@param maxTableFilesSize the size limit of the total sum of table files.
@param options map containing optional arguments: highAccuracy (boolean)
@return Whether debug information about transitions should be displayed.
Animation engine should call this method when the animation is finished.
Append a field which represents the constants this module exports to JS.
As soon as that fact no longer holds, this method will need to be fixed.
Can't actually assert the specific color so this is the next best thing.
Creates a Checkpoint object to be used for creating open-able snapshots.
Determines the URL used to fetch the JS bundle from the packager server.
Event emitted by a ReactSliderManager when user changes slider position.
Helper class containing logic for setting accessibility View properties.
Interface for adding/removing/moving views within a parent view from JS.
Invokes the default back handler for the host of this catalyst instance.
Just a Java wrapper around EmptyValueCompactionFilter implemented in C++
L0 will be directly merged into level b, instead of always into level 1.
Low-pri requests can get blocked if flush requests come in continuously.
Task class responsible for (re)creating react context in the background.
The bridge may have been destroyed due to an exception during the batch.
Then it is sufficient to add/subtract height of item at the "last index"
This class helps in calculating "real" offset of row at specified index.
This class mimics the db/write_batch_test.cc in the c++ rocksdb library.
This is applied only if blockCompressedCacheSize is set to non-negative.
This method needs to be called before event is sent to event dispatcher.
This optimization avoids writing the delete to storage when appropriate.
This provides an implementation of the public CatalystInstance instance.
Useful in catch-all scenarios where it's unclear why the error occurred.
We do 2 retries: first without database deletion and then with deletion.
We don't want to miss any textinput event, as event data is incremental.
setting null to snapshot in ReadOptions leads to no Snapshot being used.
shouldContinue is called by the underlying iterator WriteBatch::Iterate.
- Retained (static) in-memory data that may contain user info or content.
@return the maximum number of bytes in all source files to be compactedo.
@throws UnsatisfiedLinkError if there was an error loading native library
@throws java.lang.InterruptedException thrown if Threads are interrupted.
A subclass may override this method if it needs to use a custom instance.
At this point we know the final size of the element in the main dimension
Based on Fresco's DrawableUtilsTest (https://github.com/facebook/fresco).
Gets the coalescing key corresponding to the gesture with this down time.
In which case we try to minimize the number of rows we will loop through.
Indicating if we'd like to pin L0 index/filter blocks to the block cache.
JavaScript ListView implementation rely on getting correct scroll offset.
Methods are sorted by name so we can dupe check and have obvious ordering
Note that the block size specified here corresponds to uncompressed data.
Pass exception to onPostExecute() so it can be handled on the main thread
Returns a map of view-specific constants that are injected to JavaScript.
Sets the properties of the drawer, after the navigationView has been set.
TODO(5712813): cleanup callback in JS callbacks table in case of an error
TODO(9139831) : remove this method once layout animation is fully stable.
The blob will be stored in the transaction log but not in any other file.
This assumes that updateJSError belongs to the most recent showNewJSError
This could reduce context switch when the mutex is not heavily contended.
This flag is set to true when we set the text of the EditText explicitly.
This notifies any listening modules so they can do any necessary cleanup.
This way clients of this library can know if it's loaded for sure or not.
View that automatically monitors and displays the current app frame rate.
We aggregate the total dimensions of the container in those two variables
@param error will be called if there was an error processing the animation
@param inplaceUpdateNumLocks the number of locks used for inplace updates.
@return if L0 index and filter blocks should be pinned to the block cache.
Adding this layout-only child could result in adding multiple native views
Compactions will continue to occur, but no obsolete files will be deleted.
Default: SNAPPY_COMPRESSION, which gives lightweight but fast compression.
Exists so that the ProgressBar can be recreated if the style would change.
However, the spans on the current text need to be adapted to the new text.
If no children are optimized away it'd look like this: (0) (1) (2) (3) ...
If true, then the contents of data files are not synced to stable storage.
It is also responsible for acting as a RootView and handling touch events.
It should ideally use hardware texture to optimize rendering performances.
NB: if the font family is null / unsupported, the default one will be used
Prefix extractor is used to specify how to extract the prefix given a key.
Returns the maximum number of entries in one bucket before logging starts.
Sends an event to the JS instance that the hardware back has been pressed.
Slices are used by RocksDB to provide efficient access to keys and values.
Start animating for the first addition input node, will have 2 frames only
TODO(8624925): Implement removeClippedSubviews support for native ListView
Their contents remain in the OS buffers till the OS decides to flush them.
This class is used to load the RocksDB shared library from within the jar.
This method will give JS the opportunity to consume the back button event.
To get that we use information from the WindowManager and default Display.
WebSocket is already closed Don't do anything, mirror the behaviour on web
make sure we exclude the View itself because of the PointerEvents.BOX_NONE
some keys have not been found - insert them with null into the final array
we need a bigger timeout for CI builds because they run on a slow emulator
@param count the number of hash buckets used in the hash skiplist memtable.
@param fairness RateLimiter accepts high-pri requests and low-pri requests.
@return a MessageQueueThreadImpl corresponding to Android's main UI thread.
@throws RocksDBException if an error happens in the underlying native code.
@throws java.lang.IllegalArgumentException if an invalid value is provided.
Base class for a Map whose keys and values are stored in native code (C++).
DB implementations can export properties about their state via this method.
Exception thrown when there is an error evaluating JS, e.g. a syntax error.
In that case animation engine should not attempt to call this method again.
In that case the latter will win i.e. the latter will overwrite the former.
NativeModule for tests that allows assertions from JS to propagate to Java.
Prevents the ViewGroup from dispatching the pressed state to it's children.
Return the directory into which we put our self-extracted native libraries.
Sends the given Event to JS, coalescing eligible events if JS is backed up.
Set the database entry for "key" to "value" in the specified column family.
TODO(6418010): Fix readers-writers problem in debug reload from HTTP server
TableFormatConfig is used to config the internal Table format of a RocksDB.
This code can be removed if using Fresco from Maven rather than from source
This method isn't safe since it doesn't factor in layout-only view removal.
This should be invoked if JS does not want to handle the back press itself.
Throw otherwise as this would mean there is a cycle in animated node graph.
Translate the runtime string table pointer we found above to a file offset.
Used as a default value for "customType" property as "null" is not allowed.
index is relatively small, it's faster to calculate the sum starting from 0
@param inplaceUpdateSupport true if thread-safe inplace updates are allowed.
@param port The port that the HMRClient should communicate with on the host.
@return a byte array storing the value associated with the input key if any.
@throws RocksDBException thrown if operation was not performed successfully.
Called when a child starts a native gesture (e.g. a scroll in a ScrollView).
Event emitted by a ReactSwitchManager once a switch is fully switched on/off
Find the shared libraries provided in this APK and supported on this system.
Implementation of a NativeArray that allows read-only access to its members.
Override this method to make some concrete (quick and harmless) native call.
Set the database entry for "key" to "value" for the specified column family.
Should be called after all updateLayout calls for a batch have been handled.
Should measure the given node and put the result in the given MeasureOutput.
TODO(6788898): Refactor test code to use ReactPackage instead of SpecForTest
The event that contains the event counter and updates it must be sent first.
This is used so we don't get an event when changing the selection ourselves.
This is used to close a block before it reaches the configured 'block_size'.
This means the gesture has already ended, via some other CANCEL or UP event.
Use your own identifiers with your own QuickPerformanceLogger implementation
We do not accept the touch event if this view is not supposed to receive it.
We intercept the touch event if the children are not supposed to receive it.
We mark virtual anchor node as dirty as updated text needs to be re-measured
technically, width should never be negative, but there is currently a bug in
@param bundleEntry The path to the bundle entry file (e.g. index.ios.bundle).
@param multiplier the size ratio between a level-(L+1) file and level-L file.
@param outClippingRect output clipping rect should be written to this object.
@param paths a list of strings where each describes a directory of a library.
A context for holding values local to a given instance of layout computation.
A wrapper around WebSocketClient that recognizes RN debugging message format.
All paths are relative to the root folder the packager is serving files from.
Default property values for Views to be shared between Views and ShadowViews.
Enumeration of the Write operation that created the record in the Write Batch
Event used to notify JS component about changes of its position or dimensions
For each font family the bold, italic and bold_italic variants are supported.
For example, to create a line the instruction will be 2 (PATH_LINE_TO), x, y.
In debug mode, these exceptions are normally shown to developers in a redbox.
It can either be from the style attribute or because the element is flexible.
It controls the total write rate of compaction and flush in bytes per second.
Native module that handles device hardware events like hardware back presses.
Note: You should be aware that it is intentionally marked as package-private.
Random walk and make sure iter and result_iter returns the same key and value
See specification at http://www.sco.com/developers/gabi/latest/contents.html.
Since genymotion runs in vbox it use different hostname to refer to adb host.
That is, nodes that are not mapped into native views (e.g. nested text node).
The ideal ratio would be the number of prefixes / the number of hash buckets.
The main dimension is the sum of all the elements dimension plus the spacing.
The number of files in level 0 to trigger compaction from level-0 to level-1.
This is to make sure we execute enqueued operations in the order given by JS.
Tries to load the necessary library files from the given list of directories.
Use adaptive mutex, which spins in the user space before resorting to kernel.
Wait up to the timeout time for another Thread to set a value on this future.
We avoid allocating an array and iterator, and "sorting" if we don't need to.
When scaling down the bitmap, decode only every n-th pixel in each dimension.
moveTo and addAt are both relative to the final state of the View's children.
test the round-tripability of keys written and read with the DirectComparator
the latest sequence number is 10 because (5 + 5) puts were written beforehand
@param shortName Name of library to find, without "lib" prefix or ".so" suffix
@param threshold - number of entries in a single bucket before logging starts.
@throws RocksDBException thrown if error happens in underlying native library.
A Java Object that has native memory allocated corresponding to this instance.
A space efficient index block that is optimized for binary-search-based index.
Add additional font family, or replace the exist one in the font memory cache.
Add this annotation to a class, to keep all "void set*(***)" and get* methods.
All native functions are not thread safe and appropriate queues should be used
ByteBuffer backed slices typically perform better with larger keys and values.
Default capacity: for some reason they don't expose a (Comparator) constructor
Default:1, i.e. pick maxfilesize amount of data as the source of a compaction.
Invoked when native view that corresponds to a root node has its size changed.
Records the sonames (e.g., "libdistract.so") of shared libraries we've loaded.
Represents a generic entry in a stack trace, be it originally from JS or Java.
Safe to acquire choreographer here, as initialize() is invoked from UI thread.
Sets the value for the key given, returns true if successful, false otherwise.
Sometimes errors cause multiple errors to be thrown in JS in quick succession.
TODO: T7538796 Check requirement for Override of getSystemService ReactContext
Target sizes of level 1 to 4 are not applicable because they will not be used.
The logic here is that the semaphore is only acquirable if the bridge is idle.
The second BFS runs in topological order over the sub-graph of *active* nodes.
This drawable uses the size of a loaded image to determine the intrinsic size.
This option only applies to memtable prefix bloom and plaintable prefix bloom.
Translates and routes memory pressure events to the current catalyst instance.
Trigger shutdown of the dispatcher's executor so this process can exit cleanly
WalTtlSeconds() and walSizeLimitMB() affect how archived logs will be deleted.
You can only stretch if the dimension has not already been defined previously.
attempt to read test data back from the WriteBatch by iterating with a handler
clear auto correct flags, set SUGGESTIONS or NO_SUGGESTIONS depending on value
@param readOnly boolean value indicating if database if db is opened read-only.
@return true if missing column families shall be created automatically on open.
At present we just permit an overriding Java class to wrap a C++ implementation
Called when the bridge was in an idle state and executes a JS call or callback.
Clear layout animation, as animation only apply to current UI operations batch.
Fresco has a workaround for this, but it requires knowing the background color.
If the host activity is paused, the frame callback may not be currently posted.
If this flag is false, and the machine crashes, some recent writes may be lost.
In that case loader expect JS bundle to be prefetched and stored in local file.
Increments the coalescing key corresponding to the gesture with this down time.
Index sparseness determines the index interval for keys inside the same prefix.
Input type password defaults to monospace font, so we need to re-apply the font
Must be called from the UI thread so that we can fully shut down other threads.
Package-private class which provides java api to access c++ WriteBatchInternal.
Pre-allocate disk space for a file if we can do that on this version of the OS.
Prevent the RocksDB object from attempting to delete the underly C++ DB object.
Returned only if LOAD_FLAG_ALLOW_IMPLICIT_PROVISION is provided to loadLibrary.
Simplified version of manageChildren that only deals with adding children views
The memory for the corresponding views and data structures should be reclaimed.
The updates are applied in the order in which they are added to the WriteBatch.
This can use significantly less memory than decoding the full-resolution bitmap
This is a temporal solution for the lack of real animation engines implemented.
This is the base class for all the classes representing certain native library.
This may translate into multiple manageChildren calls for multiple other views.
Trigger react context initialization asynchronously in a background async task.
Will return false after onDestroy until a new initial context has been created.
@param cacheIndexAndFilterBlocks and filter blocks should be put in block cache.
@param fullScanMode boolean value indicating if full scan mode shall be enabled.
@return list of JS modules to register with the newly created catalyst instance.
Called from the main thread after a UI batch has been applied to all root views.
DialogRootViewGroup is the ViewGroup which contains all the children of a Modal.
For example, never store the value returned by this method in a member variable.
For most views, onMeasure can be stubbed out to only call setMeasuredDimensions.
If you want to create new backup, you will first have to delete backups 4 and 5.
In that case, the caller is responsible for providing a correct LD_LIBRARY_PATH.
Main catalyst view is responsible for collecting and sending touch events to JS.
Make sure the SoLoaderShim is configured to use our loader for native libraries.
TODO(7613721) : callbacks are not supported, this feature will likely be killed.
Temporary map for constructing the individual arrays of timers per ExecutorToken
This allows ProGuard to strip that class and its dependencies in release builds.
This should be much faster than using regex to verify input and Integer.parseInt
This will not work correctly as the drawable callback logic is messed up in AOSP
When false, the Backup Engine will not issue a flush before starting the backup.
@param value the value to be merged with the current value for the specified key.
@return the x position of the corresponding view on the screen, rounded to pixels
@return the y position of the corresponding view on the screen, rounded to pixels
Base class for Catalyst native modules whose implementations are written in Java.
Changes the way we encode compressed blocks with LZ4, BZip2 and Zlib compression.
If the switch has a different value than the value sent by JS, we must change it.
In that case, onLayout for this View type must *not* call layout on its children.
It should only be called after an initial call to createReactContextInBackground.
NB: This modifies the eventCoords to always be relative to the current viewGroup.
Rate is computed on actual elapsed time, not the sum of per-thread elapsed times.
ReactProgressBarViewManager manages how this style is applied to the ProgressBar.
Returns information about logging the distribution of number of entries on flush.
Returns the touch target View that is either viewGroup or one if its descendants.
Subclasses can use this method to access catalyst context passed as a constructor
The maximum time interval a put will be stalled when hard_rate_limit is enforced.
This class works by installing a Choreographer frame callback on the main thread.
Use your own implementation with you own implementation of QuickPerformanceLogger
Utility for creating pre-configured instances of core react components for tests.
We need to compare using "equals" which means that this value needs to be unique.
We use justifyContent to figure out how to allocate the remaining space available
results must be the same with new Snapshot instance using the same native pointer
4 is kinda arbitrary, but the default of 10 seems really high for an average View.
@param config the configuration of the animation for view addition/removal/update.
@param memtablePrefixBloomBits the number of bits used in the prefix bloom filter.
@return the host to use when connecting to the bundle server from the host itself.
As InfoLogLevel is set to FATAL_LEVEL, here we expect the log content to be empty.
If we're downscaling, we can decode the bitmap more efficiently, using less memory
Invoked at the end of the transaction to commit any updates to the node hierarchy.
Invoked by React to create a new node with a given tag has its properties changed.
Invoked by React to create a new node with a given tag, class name and properties.
Native children are represented by (N) where N is the no-opt child they came from.
Native module that can asynchronously request the owners hierarchy of a react tag.
Possible values for pointer events that a view and its descendants should receive.
See https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events for more info.
Spaces and tabs are dropped by IntelliJ logcat integration, so rely on __ instead.
Test with many keys, so that it's above the 999 limit per batch imposed by SQLite.
This is to include all the setters from parent classes up to ReactShadowNode class
When only background color is set we won't allocate any extra/unnecessary objects.
When this method exits, the new MessageQueueThreadImpl is ready to receive events.
You must call this each time the layout is generated if the node has a new layout.
read with previously created snapshot will read previous version of key value pair
@param expandedCompactionFactor the maximum number of bytes in all compacted files.
@param flag a boolean flag to specify whether to disable write-ahead-log on writes.
@return a CatalystInstance mock that has a default working ReactQueueConfiguration.
Allow loadLibrary to implicitly provide the library instead of actually loading it.
At the same time we disallow receiving lifecycle events for this wrapper instances.
Class stores configuration of javascript modules that can be used across the bridge
Creates a empty RequestBody if required by the http method spec, otherwise use null
Do not register default touch emitter and let WebView implementation handle touches
Indicates a module may contain sensitive user data and should be cleaned on logout.
Initialize a normal DirectorySoSource that will load from our extraction directory.
It provides support for base view properties such as backgroundColor, opacity, etc.
PointerEvents.BOX_NONE means that this react element cannot receive pointer events.
Reset view content as it's going to be populated by the application content from JS
Return an list of ABIs we supported on this device ordered according to preference.
Returns iterators from a consistent database state across multiple column families.
TODO(5966918): Consider extending touchable area for text spans by some DP constant
This is used as a fallback when no spacing has been set for a particular direction.
Thread safety: StatisticsCollector doesn't make any guarantees about thread safety.
We reset target tag to -1 and expect no further event associated with this gesture.
@param bf the probabilistic size ratio between adjacent link lists in the skip list.
@param maxGrandparentOverlapFactor maximum bytes of overlaps in "grandparent" level.
@return the index of the given child, or -1 if the child doesn't exist in this node.
If called from this MessageQueueThread, this will be the last thing the thread runs.
If the size has changed, and this child has children we need to re-layout this child
If there is any intersection we need to inform the child to update its clipping rect
JS can use the returned tag with manageChildren to add/remove children to this view.
TODO(8850038): add the stack trace info in, need to figure out way to serialize that
The actual size of the unit read from disk may be smaller if compression is enabled.
The oldest table file will be deleted once the sum of table files reaches this size.
Timer that runs every UPDATE_INTERVAL_MS ms and updates the currently displayed FPS.
We store JS bundle loaded from dev server in a single destination in app's data dir.
hashTableRatio is the desired utilization of the hash table used for prefix hashing.
Add all clipped views back, deallocate additional arrays, remove layoutChangeListener
ColumnFamilyHandle class to hold handles to underlying rocksdb ColumnFamily Pointers.
Config for rate limiter, which is used to control write rate of flush and compaction.
Does the actual merge of the (key, value) pair with the value stored in the database.
Forget about any libraries that are up-to-date already so we don't unpack them below.
If need a resize and the size is not yet set, wait until the layout pass provides one
If there are flexible children in the mix, they are going to fill the remaining space
If there's only one element, then it's bigger than the content and needs its own line
In that case, the backup will also include log files corresponding to live memtables.
Note that this must be called after getWidth()/getHeight() actually return something.
Notify react instance manager about new JS bundle version downloaded from the server.
Sets the correct password type, since numeric and text passwords have different types
Stops tracking a new coalescing key corresponding to the gesture with this down time.
TODO(7613736): Improve spring interpolator with friction and damping variable support
Tag is 0 because JSResponderHandler doesn't need one in order to clear the responder.
Text input type is numbered password, remove text password variation, add numeric one
The custom fonts will have to be located in the res/assets folder of the application.
We hack around that here by trying to detect that duplicate call and not dispatch it.
module2 and module3 will share same name, composite should return only the latter one
we currently don't have an onCreate callback so we call onResume for both transitions
@throws org.rocksdb.RocksDBException if iterator cannot be retrieved from native-side.
Animation is sub-optimal for perf, but scale transformation can't be use in this case.
Calls all timers that have expired since the last time this frame callback was called.
Class responsible for knowing how to create and update catalyst Views of a given type.
Custom Junit Runner to print also Test classes and executed methods to command prompt.
Enable the HMRClient so that the client will receive updates from the packager server.
If the current log file is larger than this size, a new info log file will be created.
If true, an error will be thrown during RocksDB.open() if the database already exists.
Instead it gets inflated using computed position and size values by CSSNode hierarchy.
Interface denoting that a class is the interface to a module with the same name in JS.
Invoke with no args to signal failure and to allow JS to clean up the callback handle.
It essentially limits the max number of cache lines each bloom filter check can touch.
It is possible for this to be called after finish() and should handle that gracefully.
Like the view removal, iteration direction is important to preserve the correct index.
NB: All native view management methods listed above must be called from the UI thread.
Native Modules Queue Thread: The thread and Looper that native modules are invoked on.
Starts tracking a new coalescing key corresponding to the gesture with this down time.
TODO(AR) consider throwing a checked exception, as if it's not direct this can SIGSEGV
TODO(t9055065): Fix custom fonts getting applied to text children with different style
The available operators are "put", "uint64add", "stringappend" and "stringappendtest".
The prominent case where we don't have a Context is barebones dalvikvm instantiations.
The remaining space between the parent dimensions+padding and child dimensions+margin.
Verify scheme is set, so that relative uri (used by static resources) are not handled.
note that calling value on a non-valid iterator from the Java API results in a SIGSEGV
number of iterators currently open Number of MultiGet calls, keys read, and bytes read
A method that can be called from JS synchronously on the JS thread and return a result.
Access to the data is provided by the subtype as it needs to handle the generic typing.
Adjust for the amount of time it took for native to receive the timer registration call
An optimized version of manageChildren that is used for initial setting of child views.
Base class for instrumentation tests that runs React based react application in UI mode
Get the current entry  The WriteEntry is only valid until the iterator is repositioned.
If dispose() function is not called, then comparator object will be GC'd automatically.
It is suited for keeping event log data with very low overhead (query log for example).
It will be executed on a node only when all the node's parent has already been updated.
JS module interface - main entry point for launching React application for a given key.
Listener which overrides default functionality to print class and method to system out.
Maximum number of bytes in all source files to be compacted in a single compaction run.
Override this method to provide extra native modules to be loaded before the app starts
ReactModalHostView is a view that sits in the view hierarchy representing a Modal view.
Sanitize content encoding header, supported only when request specify payload as string
Subclasses can override this method to install custom event emitters on the given View.
The second child that is added, is the navigationView, which gets panned from the side.
The spinner relies on a measure + layout pass happening after it calls requestLayout().
The toolbar relies on a measure + layout pass happening after it calls requestLayout().
The way it's implemented is that we store an additional array of children in view node.
This exception type is used to describe an internal error from the c++ rocksdb library.
This is the constant used in the support library for APIs that don't have Choreographer
This means that the returned x, y are relative to the origin x, y of the ancestor view.
This method should be used when you need to stub out creating NativeMaps in unit tests.
Whenever android requests focus (which it does for random reasons), it will be ignored.
While setting the Spans on the final text, we also check whether any of them are images
getCurrentSizeRange will return the min and max width and height that the window can be
A simple WriteBatch Handler which adds a record of each event that it receives to a list
CSSLayout with additional information about the conditions under which it was generated.
Determine which animation to use : if view is initially invisible, use create animation.
Enqueue it to UIThread not to block onMeasure waiting for the catalyst instance creation
Exception thrown when a native module method call receives unexpected arguments from JS.
If we are vertical the width value comes from min width and height comes from max height
It uses the event coordinates to traverse the view hierarchy and return a suitable view.
No background task to create react context is currently running, create and execute one.
Since react-native only supports API level 16+ we don't have to worry about other cases.
TODO: t6408636 verify if we should schedule a layout after a View does a requestLayout()
This class is used to verify that some JS integration tests have completed successfully.
This component is controlled, so we want it to get focused only when JS ask it to do so.
This listener will be set for child views when removeClippedSubview property is enabled.
This may happen when app has not been updated since the last time we fetched the bundle.
This will then cause the children of the Modal to layout as if they can fill the window.
Use this annotation to annotate properties of native views that should be exposed to JS.
We don't use DisplayMetricsHolder because it returns values that include the status bar.
We need to get layout information from css-layout to set the size of the rows correctly.
We only need to give a dimension for the text if we haven't got any for it computed yet.
Without this, certain calls (e.g. setLogo) only take effect after a second invalidation.
@return the instance of the specified module interface associated with this ReactContext.
@throws RocksDBException thrown if an error occurs within the native part of the library.
Additional data provided by this event: - position - index of page that has been selected
An exception caused by JS requesting the UI manager to perform an illegal view operation.
At this point, the directory may be empty or contain obsolete libraries, but that's okay.
Can be used to implement simple time-based animations as well as spring based animations.
Check if a dialog has been created while the host was paused, so that we can show it now.
Class providing children management API for view managers of classes extending ViewGroup.
Even if we don't know its exact size yet, we already know the padding, border and margin.
It is public because it is built by ReactInstanceManager which is in a different package.
Module that monitors and provides information about the connectivity state of the device.
NB: If a font family is used that does not have a style in a certain Android version (ie.
Otherwise it loads the Drawable from the Resources and directly returns it via a callback
Returns the initial size of the vector used by the memtable created based on this config.
Set the number of buckets in the fixed-size array used in the hash linked-list mem-table.
TODO(7247021): Replace updateExtraData with generic update props mechanism after D2086999
The ".js" suffix is kept to avoid ambiguities between "module-id:line" and "line:column".
Therefore we need to disable anti-alias, and after drawing is done, we will re-enable it.
This is so that developers cannot construct their own default Slice objects (at present).
This is useful for methods called via reflection that could appear as unused to Proguard.
This method should be used when you need to stub out creating NativeArrays in unit tests.
This method will be run on each node at most once every repetition of the animation loop.
Unpack library and its dependencies, returning the location of the unpacked library file.
Update layouts since the children of the node were offset by its x/y position previously.
don't do anything, no need to allocate ReactBackgroundDrawable for transparent background
A spec that allows a test to add additional NativeModules/JS modules to the ReactInstance.
Add this annotation to a class, method, or field to instruct Proguard to not strip it out.
Currently only a linear interpolation is supported on an input range of an arbitrary size.
Helper class for all things about the debug server running in the engineer's host machine.
If called from a separate thread, this will block until the thread can be quit and joined.
If it chooses to, it can just set visible to false on the Modal and the Modal will go away
If the view is layout only, no updateView call will be dispatched to the native hierarchy.
If we are horizontal the width value comes from max width and height comes from min height
It may happen that a NativeModule or or a ViewManager exists in two or more ReactPackages.
It will ensure that any calls you dispatch to the returned object will go to the right VM.
Larger value can lead to burstier writes while smaller value introduces more CPU overhead.
The number of partial merge operands to accumulate before partial merge will be performed.
This factor controls the probabilistic size ratio between adjacent links in the skip list.
This is an optimization for the access pattern including many seeks with consecutive keys.
This method will write to the output array up to the number of items from the input array.
We detect whether app runs on genymotion and replace js bundle server hostname accordingly
When the method returns, it will contain the eventCoords relative to the targetView found.
@return if true, an error is raised when the specified database already exists before open.
Base class for all Animated.js library node types that can be created on the "native" side.
Because react context is created asynchronously, we may have to wait until it is available.
Check if the parent of the view has to layout the view, or the child has to lay itself out.
Configure an animation to be used for the native layout changes, and native views creation.
Container and all of its children receive touch events (like pointerEvents is unspecified).
Creates the next JSON message to send to remote JS executor, with request ID pre-filled in.
Going high to low makes sure we remove the correct index when there are multiple to remove.
Hook for containers or fragments to get informed of the on touch events to perform actions.
If level-styled compaction is used, then this number determines the total number of levels.
Implementation of javascript callback function that use Bridge to schedule method execution
Marker interface to indicate a given animation type takes care of updating the view layout.
NB: moveFrom and removeFrom are both relative to the starting state of the View's children.
New pointer goes down, this can only happen after ACTION_DOWN is sent for the first pointer
Provides methods for generating touch events and dispatching them directly to a given view.
Puts are delayed 0-1 ms when any level has a compaction score that exceeds soft_rate_limit.
Returns true if react node responsible for the touch even is flattened into this ViewGroup.
TODO(prenaux): Correctly set the height of items with undefined (auto) crossAxis dimension.
The minimum number of write buffers that will be merged together before writing to storage.
This approach is easier than maintaining a list of tags for recently created/deleted views.
This is used by disposeInternal to avoid double-free issues with the underlying C++ object.
This means that during the next hierarchy traversal, new UI will be drawn if needed (good).
This method fetches the given URL *synchronously* and writes it to the specified temp file.
We should only hit this slow path when we receive events while the host activity is paused.
managerNo2 and managerNo3 will share same name, composite should return only the latter one
maxLines can only be set in master view (block), doesn't really make sense to set in a span
A FrameLayout that allows you to access the result of the last time its hierarchy was drawn.
After the text changes inside an EditText, TextView checks if a layout() has been requested.
An additional grant of patent rights can be found in the PATENTS file in the same directory.
An example of this would be installing custom functionality into the JavaScriptCore context.
As a result, this approach is inefficient because of layout passes occurring on every frame.
Because we are rethrowing the original exception, the original stacktrace will be preserved.
Calling functions on this interface will result in corresponding methods in JS being called.
Class responsible for default layout animation, i.e animation of view creation and deletion.
Contains all information necessary to collect statistics from one instance of DB statistics.
It is safe for concurrent access from multiple threads without any external synchronization.
Module that exposes interface for creating and managing animated nodes on the "native" side.
Once there is only one implementation of MessageQueueThread, this should move to that class.
Some of these queues *may* be the same but should be coded against as if they are different.
Store eventCoords in array so that they are modified to be relative to the targetView found.
Systrace stub that mostly does nothing but delegates to Trace for beginning/ending sections.
This is a recursive DFS since view the entire tree must be parsed until the target is found.
This is a sane limit to protect the user from the app storing too much data in the database.
This is a temporary optimization/hack that is mainly applicable to the large list of images.
Value at Spacing.ALL index used for rounded borders, whole array used by rectangular borders
WARNING: Java APIs do not let us distinguish directories from symbolic links to directories.
targetFileSizeMultiplier defines the size ratio between a level-(L+1) file and level-L file.
targetFileSizeMultiplier defines the size ratio between a level-L file and level-(L+1) file.
@param isNativeExopackageEnabled - whether native exopackage feature is enabled in the build.
A super simple Future-like class that can safely notify another Thread when a value is ready.
Casting to long is safe here since animationStopTimeMs is unix time and thus relatively small
Comparator should not be disposed before options instances using this comparator is disposed.
Don't apply background color to anchor TextView since it will be applied on the View directly
Executes JS remotely via the react nodejs server as a proxy to a browser on the host machine.
For consistency, we pretend in JS that the value is 0..1 but set the SeekBar value to 0..100.
If the app uses additional views or modules besides the default ones, add more packages here.
NB: It is possible on some devices to receive certain connection type changes multiple times.
NOTE: This getSize code is copied from DynamicDrawableSpan and modified to not use a Drawable
Note that the slider is _not_ a controlled component (setValue isn't called during dragging).
Note(prenaux): More than one line, we need to layout the crossAxis according to alignContent.
Returns the number of buckets that will be used in the memtable created based on this config.
TODO(9577825): This is a bad pattern, we should thread through an Environment object instead.
This listener should only be used for debug purposes and should not affect application state.
This variable is intentionally re-defined as the code is transpiled to a block scope language
Utilities for native Views that interpret native gestures (e.g. ScrollView, ViewPager, etc.).
@return whether the current Thread is also the Thread associated with this MessageQueueThread.
Disable simple stacking in the main axis for the current line as we found a non-trivial child.
If the C++ instance is referenced after this is called, a NullPointerException will be thrown.
Implementation of two javascript functions that can be used to resolve or reject a js promise.
In that case native modules could be in a bad state so we don't want to call anything on them.
It only makes sense to consider a child flexible if we have a computed dimension for the node.
Iterators created with this handle will all observe a stable snapshot of the current DB state.
Reset child margins before re-layout as they are added back in layoutNode and would be doubled
Since the two APIs don't share a common interface there's unfortunately some code duplication.
Spacing type that represents end direction e.g. right in left-to-right, left in right-to-left.
TODO(5195192) Investigate possible problems related to restarting all tasks at the same moment
The examples provided by Facebook are for non-commercial testing and evaluation purposes only.
The space between the beginning and the first element and the space between each two elements.
This is handled automatically in js by checking if there is a listener on the momentum events.
Use this method when the activity resumes to enable invoking the back button directly from JS.
When using js proxy, there is no need to fetch JS bundle as proxy executor will do that anyway
@return branching factor, the probabilistic size ratio between adjacent links in the skip list.
@return handle to the specified JS module for the CatalystInstance associated with this Context
Base class for slices which will receive direct ByteBuffer based access to the underlying data.
Convert SeekBar's native progress value (e.g. 0..100) to a value passed to JS (e.g. -1.0..2.5).
Disable simple stacking in the cross axis for the current line as we found a non-trivial child.
If the input array is longer than output the remaining part of the input will not be converted.
Intentionally casting mEventType because it is guaranteed to be small enough to fit into short.
It is required for each memtable to have one such sub-class to allow Java developers to use it.
It is written by RocksDB when BlockBasedTableOptions::checksum is something other than kCRC32c.
It will return records that were inserted into the database after the creation of the iterator.
Replaces the View specified by oldTag with the View specified by newTag within oldTag's parent.
Set the number of bits per key used by the internal bloom filter in the plain table sst format.
The application root element is wrapped in a helper view in order to be able to display modals.
This is so that developers cannot construct their own default DirectSlice objects (at present).
This is unsafe since we reuse the native memory so the underlying array/map is no longer valid.
Timing module needs to be created on the main thread so that it gets the correct Choreographer.
A CompactionFilter allows an application to modify/delete a key-value at the time of compaction.
CustomStyleSpan will try to load the fontFamily with the right style and weight from the assets.
Enum representing the different animation type that can be specified in layout animation config.
If KeyMayExist returns false, i.e. the key definitely does not exist, then the delete is a noop.
If the current log file is larger than `max_log_file_size`, a new info log file will be created.
If the key definitely does not exist in the database, then this method returns false, else true.
If true, all data read from underlying storage will be verified against corresponding checksums.
It's safe for those objects to be static as we update properties in a single thread sequentially
Native counterpart of style animated node (see AnimatedStyle class in AnimatedImplementation.js)
Provides the ability to listen for size changes so that a UI manager can re-layout its elements.
Spacing type that represents start direction e.g. left in left-to-right, right in right-to-left.
Store a private linked list of flexible children so that we can efficiently traverse them later.
TODO: T7538544 Rename ThemedReactContext to be in alignment with name of ReactApplicationContext
This is the main class that coordinates how native animated JS implementation drives UI changes.
To map animated node values to view properties there is a special type of a node: AnimatedProps.
What we might want to try to do instead is use a combined ScaleAnimation and TranslateAnimation.
@return a key used to determine which other events of this type this event can be coalesced with.
A JS to Java call that triggers a Java to JS call will also acquire these locks in the same order
By default targetFileSizeMultiplier is 1, meaning files in different levels have the same target.
Currently, RocksDB assigns low-pri to request from compaction and high-pri to request from flush.
Each instruction starts with a type (see PATH_TYPE_*) followed by arguments for that instruction.
Enum representing the different interpolators that can be used in layout animation configuration.
Find the shared libraries provided through the exopackage directory and supported on this system.
If fails, crash, since the app is potentially in a bad state and could cause a privacy violation.
It gets all child information forwarded from ReactModalHostView and uses that to create children.
It provides also a way to start activities using the viewContext to which RN native views belong.
It will basically allow any/all keyboard input whether from physical keyboard or from soft input.
Module that exposes the URL to the source code map (used for exception stack trace parsing) to JS
One can use 'debug_http_host' shared preferences key to provide a host name for the debug server.
TODO(7323049): Remove this workaround once we figure out a way to re-layout some views on request
TODO(7613721): Invoke success callback at the end of animation and when animation gets cancelled.
The default implementation uses the base context instead, so it couldn't be cast to ReactContext.
This can either happen when we're scrolling down or if the cached value has never been calculated
This is useful for native modules that need to do any setup before the JS bundle has been loaded.
Use of this source code is governed by a BSD-style license that can be found in the LICENSE file.
Use this annotation to annotate group of properties of native views that should be exposed to JS.
We're still not recovering from this well, but at least the error will be reported to the server.
@param success will be called when the animation completes, or when the animation get interrupted.
Animated node which takes two or more value node as an input and outputs a product of their values
Coalescing move events should probably append historical move data like MotionEvent batching does.
For the cross dim, we add both sides at the end because the value is aggregate via a max function.
If you're increasing this, also consider increasing number of threads in LOW priority thread pool.
It takes two or more value nodes as an input and outputs a sum of values outputted by those nodes.
Method which takes a container tag and then releases all subviews for that container upon receipt.
Puts are delayed 1ms at a time when any level has a compaction score that exceeds hard_rate_limit.
See the License for the specific language governing permissions and limitations under the License.
Set full scan mode, if true the whole file will be read one record by one without using the index.
Set the initial size of the vector that will be used by the memtable created based on this config.
Should not affect application logic and should only be used for debug/monitoring/testing purposes.
Static class that allows markers to be placed in React code and responded to in a configurable way
This number is equal to the maximum number of linear search required after hash and binary search.
We'll automatically check and adjust the size number to make sure it conforms to the restrictions.
@return boolean value indicating if the flush operation waits for termination of the flush process.
Blobs, puts, deletes, and merges will be encountered in the same order in thich they were inserted.
DB implements can export properties about their state via this method on a per column family level.
If the parent hasn't been attached to its parent yet, don't issue commands to the native hierarchy.
If true, writes will not first go to the write ahead log, and the write may got lost after a crash.
If you're increasing this, also consider increasing number of threads in HIGH priority thread pool.
Ordered list of sources to consult when trying to load a shared library or one of its dependencies.
Registers a root node with a given tag, size and ThemedReactContext and adds it to a node registry.
Return the directory into which we put our self-extracted native libraries and make sure it exists.
Some KeyListeners like DigitsKeyListener will display the keyboard but not accept all input from it
WARNING:** This method is *experimental* and should only be used when no other option is available.
- Modules that remove all persistent data (temp files, etc) when the catalyst instance is destroyed.
An Exception handler that posts the Exception to be thrown on the given delegate MessageQueueThread.
Android's elevation implementation requires this to be implemented to know where to draw the shadow.
By default target_file_size_multiplier is 1, meaning files in different levels have the same target.
Number of deletes records that were not required to be written to storage because key does not exist
Processes the shadow hierarchy to dispatch all necessary updateLayout calls to the native hierarchy.
Simplified version of constructManageChildrenErrorMessage that only deals with adding children views
Supply setters for base view layout properties such as width, height, flex properties, borders, etc.
Tests basic properties, events and switching between spinner modes (which changes the used manager).
The ratio between the total size of level-(L+1) files and the total size of level-L files for all L.
This code is duplicated in ReactTextInputManager  TODO: Factor into a common place they can both use
Android has a bug where onScrollChanged is called twice per frame with the same params during flings.
Bloom filter policy that uses a bloom filter with approximately the specified number of bits per key.
COMPACTION_KEY_DROP_* count the reasons for key drop during compaction There are 3 reasons currently.
Class responsible for animation layout changes, if a valid layout animation config has been supplied.
If there's a problem we'll face an UnsupportedLinkError when first using the feature instead of here.
Returns entries per bucket threshold before LinkedList is replaced by SkipList usage for that bucket.
The following `OnLayoutChangeListsner` is attached to the views stored in the adapter `mViews` array.
This will generally be constructed and filled in native code so you shouldn't construct one yourself.
This will handle dispatching the appropriate events to JS to make sure the gesture in JS is canceled.
node or animation not found TODO(5712813): cleanup callback in JS callbacks table in case of an error
@param logDistribution - boolean parameter indicating if number of entry distribution shall be logged.
Detour for System.currentTimeMillis and System.nanoTime calls so that they can be mocked out in tests.
Interface for a class that knows how to handle an Exception thrown by a native module invoked from JS.
Interface for a module that will be notified when JS executors have been unregistered from the bridge.
It also sets up connection between the instance and developers support functionality of the framework.
Options instance *should* not be disposed before all DBs using this options instance have been closed.
The implementation tries to allocate as few objects as possible depending on which properties are set.
This is done by adding node to the BFS queue only if all its "predecessors" have already been visited.
When it is time to draw, it will use the Fresco framework to get the right Drawable and let that draw.
in most of the cases there should never be more than a few active animations running at the same time.
Also we recommend to keep BackupEngine alive and not to recreate it every time you need to do a backup.
Also, a larger write buffer will result in a longer recovery time the next time the database is opened.
If not animation is available, layout change is applied immediately instead of performing an animation.
If user doesn't call options dispose explicitly, then this options instance will be GC'd automatically.
If we're in the middle of a batch, the change will automatically be dispatched at the end of the batch.
It will correctly find the right view to handle the touch and also dispatch the appropriate event to JS
Pre-fill cross axis dimensions when the child is using stretch before we call the recursive layout pass
TODO(yhchiang): use the following arguments: (Long)Flag.stats_interval (Integer)Flag.stats_per_interval
Therefore, we forward all view changes around addition and removal of views to the DialogRootViewGroup.
This is a temporary file - consider using CameraRollManager.saveImageWithTag to save it in the gallery.
This will ensure that there are never more than max_successive_merges merge operations in the memtable.
To display a view within a Dialog, that view must have its parent set to the window the Dialog creates.
We override this to allow developers to determine whether they need offscreen alpha compositing or not.
default rocksenv will always return zero for flush pool no matter what was set via setBackgroundThreads
@param shutdownTimeout Time in milli-seconds to wait for shutdown before killing the collection process.
@throws java.lang.IllegalArgumentException when there is not a ttl value per given column family handle.
Assuming no other views have been created, the root view will have tag 1, Text tag 2, and RawText tag 3.
Because of this, we can not use the ReactModalHostView since it sits in the normal React view hierarchy.
For a small helper like this, copying is simpler than adding a dependency on com.facebook.fresco.drawee.
Helper class that provides the same OkHttpClient instance that will be used for all networking requests.
If you implement RootView you need to call handleTouchEvent from onTouchEvent and onInterceptTouchEvent.
NOTE: Accessor method with default value will throw an exception when the key is not present in the map.
Partial merge will not be called if the list of values to merge is less than min_partial_merge_operands.
Set this flag to true if changing a particular property on the view requires a new Dialog to be created.
The root view always assumes any view that was tapped wants the touch and sends the event to JS as such.
required so that drawable callback is cleared before we add the drawable back as a part of LayerDrawable
DO NOT HOLD LONG-LIVED REFERENCES TO THE OBJECT RETURNED BY THIS METHOD, AS THIS WILL CAUSE MEMORY LEAKS.
Doing so will prevent log files from being copied to the backup directory (since flush will delete them).
Encapsulate Lollipop-specific calls into an independent class so we don't fail preverification downlevel.
Enum representing the different view properties that can be used when animating layout for view creation.
Event emitted by EditText native view when text editing ends, because of the user leaving the text input.
IMPORTANT: Note that only modules that needs to be accessible from the native code should be listed here.
If you want to control the thread and timing of the destructor, you should call resetNative() explicitly.
Number of times we had to reseek inside an iteration to skip over large number of keys with same userkey.
Set inJustDecodeBounds to true so we don't actually load the Bitmap, but only get its dimensions instead.
The removeNodeFromParent call will cause all the view's children to be detached from their native parent.
This should be called if configuration has changed or the developer has requested the app to be reloaded.
We use a staging data structure so that all UI events generated in a single frame are dispatched at once.
Without this, the widget never actually changes the selection and doesn't call the appropriate listeners.
only call reset context when the destroyed context matches the one that is currently set for this manager
value "0" is used as an initial color for a new node, using it in BFS may cause some nodes to be skipped.
/* This code is duplicated in ReactTextInputManager  /* TODO: Factor into a common place they can both use
Asynchronous task that cleans up cache dirs (internal and, if available, external) of cropped image files.
Called from JNI to construct a new Java DirectSlice without an underlying C++ object set at creation time.
Create an animation object for the current animation type, based on the view and final screen coordinates.
If not specified, each "table reader" object will pre-load index/filter block during table initialization.
It is use by touch event emitter for determining the react tag of the inner-view element that was touched.
Iterate over the array of animations and override ones that has finished, then resize `mActiveAnimations`.
Makes sure replaceExistingNonRootView by replacing a view with a new view that has a background color set.
NB: even though down time is a long, we cast as an int using the least significant bits as the identifier.
Pretend at least one op was done in case we are running a benchmark that does not call FinishedSingleOp().
Returns a map of config data passed to JS that defines eligible events that can be placed on native views.
The following Object arrays are used to prevent extra allocations from varargs when we call Method.invoke.
We do not support method overloading since js sees a function as an object regardless of number of params.
pageX,Y values are relative to the RootReactView the motionEvent already contains coordinates in that view
@param statsCollectionIntervalInMilliSeconds Statistics collection time period (specified in milliseconds).
A better way to do this would be to have JS explicitly signal to this module when a UI transaction is done.
Absolute positioned elements do not take part of the layout, so we don't use them to compute mainContentDim
An mutable reference to the value of the C++ pointer pointing to some underlying native RocksDB C++ object.
Given two events, coalesce them into a single event that will be sent to JS instead of two separate events.
If the flex share of remaining space doesn't meet min/max bounds, remove this child from flex calculations.
Is used for single-line, boring text when the width is either unknown or bigger than the width of the text.
Note that this function should be called only after all RocksDB instances referencing the slice are closed.
Screen metrics returns the metrics of the entire screen, is consistent with iOS and should be used instead.
See the notice.md file distributed with this work for additional information regarding copyright ownership.
This method should only be used by a subclass to support UIOperations not provided by UIViewOperationQueue.
We override the KeyListener so that all keys on the soft input keyboard as well as hardware keyboards work.
We selectively remove some of the views (detach) from it while still storing them in that additional array.
Creates  and starts a new MessageQueueThreadImpl encapsulating a new Thread with a new Looper running on it.
Don't use webView.getUrl() here, the URL isn't updated to the new value yet in callbacks like onPageFinished
Find the touch target child native view in  the supplied root view hierarchy, given a react target location.
If JS does not consume the event, mDefaultBackButtonImpl will be invoked at the end of the round trip to JS.
It will be submitted to the end of the event queue even if it is being submitted from the same queue Thread.
Note that this function should be called only after all RocksDB instances referencing the filter are closed.
This can return almost immediately if the location is cached or request an update, which might take a while.
This is because we need to use the metadata from those nodes to figure out the correct commands to dispatch.
Two events will only ever try to be coalesced if they have the same event name, view id, and coalescing key.
Types of data that should be cleaned: - Persistent data (disk) that may contain user information or content.
We can't easily verify if rounded corner was honored or not, this tests simply verifies we're not crashing..
default rocksenv will always return zero for compaction pool no matter what was set via setBackgroundThreads
if both message and items are set, Android will only show the message and ignore the items argument entirely
An immutable reference to the value of the C++ pointer pointing to some underlying native RocksDB C++ object.
It manages the properties that can be set on the drawer and contains some ReactNative-specific functionality.
Store a private linked list of absolutely positioned children so that we can efficiently traverse them later.
Store the current operation queues to dispatch and create new empty ones to continue receiving new operations
This will be the name used to reference this view manager from JavaScript in createReactNativeComponentClass.
All nonBatchedOperations should be executed before regular operations as regular operations may depend on them
Allows OS to incrementally sync files to disk while they are being written, asynchronously, in the background.
If the child is position absolute (without top/left) or relative, we put it at the current accumulated offset.
In order to support web workers, a module must be aware that it can be invoked from multiple different JS VMs.
Interface that represents a JavaScript Promise which can be passed to the native module as a method parameter.
NB: JavaScriptModule does not allow method name overloading because JS does not allow method name overloading.
Now that we placed the element, we need to update the variables We only need to do that for relative elements.
Once the bulk-loading is complete, please issue a sync to the OS to flush all dirty buffers to stable storage.
Use `post` otherwise the control won't start refreshing if refreshing is true when the component gets mounted.
Used by native animated module to bypass the process of updating the values through the shadow view hierarchy.
We do however want all of the layout magic to happen as if the DialogRootViewGroup were part of the hierarchy.
You will not be able to verify the operation of the functions below without having read the ELF specification.
Annotation indicating that a JS module should be made available to web workers spawned by the main JS executor.
Background task is currently running, queue up most recent init params to recreate context once task completes.
Currently, RocksDB does not enforce rate limit for anything other than flush and compaction, e.g. write to WAL.
Has support for borders, but since borders aren't common, lazy initializes most of the storage needed for them.
In that case there is no point in fetching the bundle from device as remote executor will have to do it anyway.
Open the database using the C++ BytewiseComparatorImpl and test the results against our Java BytewiseComparator
This is a direct port of various C++ tests from db/comparator_db_test.cc and some code to adapt it to RocksJava
This view will then be tracked by this manager and in case of catalyst instance restart it will be re-attached.
@param waitForFlush boolean value indicating if the flush operations waits for termination of the flush process.
@return Map where key of map is the key passed by user and value for map entry is the corresponding value in DB.
Currently ON_ERROR and ON_PROGRESS are not implemented, these can be added easily once support exists in fresco.
Exception thrown when a class tries to access a native view by a tag that has no native view associated with it.
Executing as multiple code blocks could allow the platform UI system to interrupt and render a partial UI state.
If you manually call dispose on the Java object, the native object will be deleted synchronously on that thread.
Longer term, onCatalystInstanceDestroy should probably be executed on the native modules thread as well instead.
Note that this function should be called only after all RocksDB instances referencing the comparator are closed.
Open the database using the Java BytewiseComparator and test the results against another Java BytewiseComparator
TODO(7728005): Attach/detach views in batch - once per frame in case when multiple children update their layout.
This is called from java code, so it won't be stripped anyway, but proguard will rename it, which this prevents.
All overrides of key handling defer to the underlying KeyListener which is shared by all ReactEditText instances.
Creates a new helper to work with either the FragmentManager or the legacy support FragmentManager transparently.
If all goes well, the success callback will be called with the file:// URI of the new image as the only argument.
If your app uses additional views or modules besides the default ones, you'll want to include more packages here.
Inline immutable values from the target node to avoid excessive method invocations during the layout calculation.
Keep in sync with ReactIOSTagHandles JS module - see that file for an explanation on why the increment here is 10
TouchEvent coalescing can happen for move events if two move events have the same target view and coalescing key.
re-open db and read from start to end integer keys should be in ascending order as defined by SimpleIntComparator
@param options map containing optional arguments: timeout (millis), maximumAge (millis) and highAccuracy (boolean)
Adds a child that the native view hierarchy will have at this index in the native view corresponding to this node.
By the current implementation, the catalyst instance is going to be immediately dropped, and all JS calls with it.
Eventually, if necessary, it could contain something like:  BEFORE_CREATE, CREATED, VIEW_CREATED, STARTED, RESUMED
For each animation frame JS provides a value from 0 to 1 that indicates a progress of the animation at that frame.
It's possible that both callbacks can fire on an error so make sure we only dispatch results once to our callback.
It's simpler than exposing synchronosition mechanism to notify listener than react context creation has completed.
No-op - override in order to still receive events to onInterceptTouchEvent even when some other view disallow that
Return -1 if the input string is not a valid numeric fontWeight (100, 200, ..., 900), otherwise return the weight.
Synchronize the contents of that directory with the library payload in our APK, deleting and extracting as needed.
This is a simplification of handleManagerChildren that only adds children in index order of the childrenTags array
Use GPU-accelerated animation, however we loose the ability to resume interrupted animation where it was left off.
Use the line loop to position children in the main axis for as long as they are using a simple stacking behaviour.
unfortunately Typeface.createFromAsset throws an exception instead of returning null if the typeface doesn't exist
Animation engine should call this method for every animation frame passing animation progress value as a parameter.
Annotates a method that should have restricted visibility but it's required to be public for use in test code only.
Holds an instance of the current DisplayMetrics so we don't have to thread it through all the classes that need it.
If you manually call resetNative() on the Java object, the C++ object will be deleted synchronously on that thread.
In practice, we will not be coalescing over a time range where the most significant bits of that time range matter.
Intersect the view with the parent's rectangle This will result in the overlap with coordinates in the parent space
Note that dispose() must be called before this instance become out-of-scope to release the allocated memory in c++.
Simple utility class for manipulating colors, based on Fresco's DrawableUtils (https://github.com/facebook/fresco).
The implementation accounts for the cases when next index is not necessarily a subsequent number of the cached one.
Use the specified object to interact with the environment, e.g. to read/write files, schedule background work, etc.
When increasing this number, we may also want to consider increasing number of threads in LOW priority thread pool.
ignore HTTP call response, this is just to open a debugger page and there is no reason to report failures from here
Amount of data to build up in memory (backed by an unsorted log on disk) before converting to a sorted on-disk file.
Computing momentum events is potentially expensive since we post a runnable on the UI thread to see when it is done.
Determines the location on screen, width, and height of the given view and returns the values via an async callback.
For multiple updates on the same key, each update will be returned as a separate entry, in the order of update time.
If set true, will hint the underlying file system that the file access pattern is random, when a sst file is opened.
If specified with non-zero value, log file will be rolled if it has been active longer than `log_file_time_to_roll`.
It works by storing all child views in an array within adapter and binding appropriate views to rows when requested.
Make a new ApkSoSource that extracts DSOs from our APK instead of relying on the system to do the extraction for us.
The wrapper stops the EditText from triggering *TextChanged events, in the case where JS has called this explicitly.
Therefore, we can't find the exact text tag that has been touched, and the correct tag to return is the default one.
Allows the user of this module to verify that asserts are actually being called from JS and that none of them failed.
Interface that represent javascript callback function which can be passed to the native module as a method parameter.
It therefore can't be used safely until *after* an image has loaded, and must be replaced when the image is replaced.
JS traces return the full path to the file here, while Java traces only return the file name (the path is not known).
Open the database using the C++ BytewiseComparatorImpl and test the results against our Java DirectBytewiseComparator
The cross dimension is the max of the elements dimension since there can only be one element in that cross dimension.
This ExecutorToken internally maps to a specific JS VM and can be used by the framework to route calls appropriately.
This interface should be implemented be native ViewGroup subclasses that can represent more than a single react node.
This is to work around a bug where CookieManager may fail to instantiate if CookieSyncManager has never been created.
This stops the Switch from changing its value multiple times, when those changes have not been processed by JS first.
This will allow the proper keyboard to be shown on screen but without the actual filtering done by other KeyListeners
All constants below are fixed by the ELF specification and are the offsets of fields within the elf.h data structures.
By default, this will return null and an empty object will be passed to your top level component as its initial props.
Creates a new MessageQueueThread for a background web worker owned by the JS thread with the given MessageQueueThread.
In many cases, a filter can cut down the number of disk seeks form a handful to a single disk seek per DB::Get() call.
This is less expensive than removing the text listeners and adding them back again after the text change is completed.
Views will not be automatically recycled but they will be detached from native view hierarchy when scrolled offscreen.
All the subsequent action types are expected to be called after ACTION_DOWN thus target is supposed to be set for them.
Class responsible for optimizing the native view hierarchy while still respecting the final UI product specified by JS.
If the search does not backtrack, it is possible to follow a branch that cannot be a target (because of pointerEvents).
If the uri indicates an icon to be somewhere remote (http/https) or on the local filesystem, it uses fresco to load it.
It is called by the manager once all properties are set because we need to know all of them before creating the Dialog.
Note that this function should be called only after all RocksDB instances referencing the compaction filter are closed.
Returns the maximum number of concurrent background compaction jobs, submitted to the default LOW priority thread pool.
So if you have a slow filesystem to backup (like HDFS) and you have a lot of backups then restoring can take some time.
The constants map contains the following predefined fields for 'customBubblingEventTypes' and 'customDirectEventTypes'.
Bytes written during flush Number of table's properties loaded directly from file, without creating table reader object.
Custom type may be used when additional processing of the value needs to be done in JS before sending it over the brige.
If it has, it will not scroll the text to the end of the new text inserted, but wait for the next layout() to be called.
If the user didn't specify a width or height, and it has not been set by the container, then we set it via the children.
If there is no currentActivity or we are launching to a different package we need to set the FLAG_ACTIVITY_NEW_TASK flag
It delegates handling touch events for itself and child views and sending those events to JS by using JSTouchDispatcher.
JS bundle will be read from assets directory in native code to save on passing large strings from java to native memory.
Sets whether this node only contributes to the layout of its children without doing any drawing or functionality itself.
Wait for collectStatistics runnable to finish so that disposal of statistics does not cause any exceptions to be thrown.
When set, fills the rest of the scrollview with a color to avoid setting a background and creating unnecessary overdraw.
@param sourceCompactionFactor the maximum number of bytes in all source files to be compacted in a single compaction run.
Custom type may be used when additional processing of the value needs to be done in JS before sending it over the bridge.
Helper class to get the appropriate Random class instance dependent on the current platform architecture (32bit vs 64bit)
Note that dispose() must be called before an Options instance become out-of-scope to release the allocated memory in c++.
Note: If your application doesn't use web workers, it will only have a single ExecutorToken per instance of React Native.
Returns whether the activity was started, as this might fail if this was called before the context is in the right state.
Same as fixed length prefix extractor, except that when slice is shorter than the fixed length, it will use the full key.
Specifies the maximum number of concurrent background compaction jobs, submitted to the default LOW priority thread pool.
This method gets called in the main animation loop with a frame time passed down from the android choreographer callback.
This option can be useful for backing up in-memory databases where log file are persisted, but table files are in memory.
Using a Choreographer callback (which runs immediately before traversals), we guarantee we run before the next traversal.
a slightly bigger write buffer than L0 file so that we can ensure manual flush always go before background flush happens.
NB: This call can only be called once for a given frame time range because it cleans up events it recorded for that frame.
The backup will always be consistent with the current state of the database regardless of the flushBeforeBackup parameter.
The non flexible children can overflow the container, in this case we should just assume that there is no space available.
Used to check for comparator mismatches (i.e., a DB created with one comparator is accessed using a different comparator).
We don't care about calling this is the view is not currently attached as it would be laid out once added to the recycler.
Creates a new column family with the name columnFamilyName and allocates a ColumnFamilyHandle within an internal structure.
The position is set by the parent, but we need to complete it with a delta composed of the margin and left/top/right/bottom
This can also be used to stub out existing native modules by adding another module with the same name as a built-in module.
Value x means that (1 - x) fraction of the page at "position" index is visible, and x fraction of the next page is visible.
as the scope of a static member equals to the scope of the problem, we let its c++ pointer to be disposed in its finalizer.
Open the database using the Java DirectBytewiseComparator and test the results against another Java DirectBytewiseComparator
This class will run all JNI call within separate android looper, thus you don't need to care about starting your own looper.
This is to work around a bug in DatePickerDialog where it doesn't display a title showing the date under certain conditions.
Whenever the value of the switch changes, we do not allow any other changes to that switch until JS sets a value explicitly.
find nodes with zero "incoming nodes", those can be either nodes from `mUpdatedNodes` or ones connected to active animations
verify that the layout doesn't get updated when we update style property not affecting the position (e.g., background-color)
In the case of removing a layout-only node, we need to instead recursively remove all its children from their native parents.
It is possible that the RootView can't be found because this view is no longer on the screen and has been removed by clipping
JavaScript executor that delegates JS calls processed by native code back to a java version of the native executor interface.
Now if we keep level 4 to be the base level, its target size needs to be 10.1MB, which doesn't satisfy the target size range.
Open the database using the C++ ReverseBytewiseComparatorImpl and test the results against our Java ReverseBytewiseComparator
The default is 2, so that when 1 write buffer is being flushed to storage, new writes can continue to the other write buffer.
This SoSource did not load the library, but verified that the system loader will load it if some other library depends on it.
This number specifies the number of keys (with the same userkey) that will be sequentially skipped before a reseek is issued.
This source code is licensed under the BSD-style license found in the LICENSE file in the root directory of this source tree.
We are currently not enabling translation GPU-accelerated animated, as it creates odd artifacts with native react scrollview.
We use a limited amount of data over and over again and ensure that it is larger than the compression window (32KB), and also
1) Sort the views to add and indices to remove by index 2) Iterate the indices being removed from high to low and remove them.
@throws IllegalArgumentException thrown if the size of passed keys is not equal to the amount of passed column family handles.
A simple wrapper around Choreographer that allows us to control the order certain callbacks are executed within a given frame.
Helper class that provides the necessary methods for creating the RequestBody from a file specification, such as a contentUri.
Number of bytes written to WAL Writes can be processed by requesting thread or by the thread at the head of the writers queue.
Open the database using the Java ReverseBytewiseComparator and test the results against another Java ReverseBytewiseComparator
Take care to ensure that we can detect incomplete copies and that the copied bytes make it to stable storage before returning.
The simplified version of get which returns a new byte array storing the value associated with the specified input key if any.
This also removes the nasty side effect that EditTexts have, which is that focus is always maintained on one of the EditTexts.
This class contains methods to retrieve the name and type of all methods and a way to set these properties without reflection.
Use a separate inner class to isolate the version-dependent call where it won't cause the whole class to fail preverification.
We want to support both android.app.Activity and the pre-Honeycomb FragmentActivity (for apps that use it for legacy reasons).
don't set keys that divide by this magical number, so that we can check that multiGet works, and returns null for missing keys
@throws java.lang.IllegalArgumentException thrown on 32-Bit platforms while overflowing the underlying platform specific value.
For example, if the host is already resumed at creation time, we wouldn't expect an onResume call until we get an onPause call.
Given an array of (key, value) pairs, this will merge the given values with the stored values of the given keys, if they exist.
I'm not sure how strict this format is for returned errors, or what other errors there can be, so this may end up being spammy.
If "property" is a valid property understood by this DB implementation, fills "*value" with its current value and returns true.
Module that records debug information during transitions (animated navigation events such as going from one screen to another).
ProGuard is surprisingly smart in this case and will keep a class if it detects a call to Class.forName() with a static string.
You might want to override this method if your view needs to emit events besides basic touch events to JS (e.g. scroll events).
Android's gesture recognizers check eventTime in order to figure out gesture speed, and therefore scroll vs fling is recognized.
Code is simplified version of getDetectedVersion() from cts/tests/tests/graphics/src/android/opengl/cts/OpenGlEsVersionTest.java
Instead onLayout will be invoked as normal and it is the View instance's responsibility to properly call layout on its children.
Notify view that clipping area may have changed and it should recalculate the list of children that should be attached/detached.
This method will directly update native views, which means that updates for layout-related propertied won't be handled properly.
This option can boost performance for in-memory workload but should use with care since it can cause higher false positive rate.
Also listing a native module here doesn't imply that the JS implementation of it will be automatically included in the JS bundle.
Since we override onLayout in our ViewGroups, a layout pass never happens after a call to requestLayout, so we simulate one here.
Therefore, it needs to be enabled explicitly in order to avoid regression in existing application written for iOS using this API.
copy listeners array to avoid ConcurrentModificationException if any of the listeners remove themselves in handleMemoryPressure()
If true, the implementation will do aggressive checking of the data it is processing and will stop early if it detects any errors.
NB: if there was one enqueued that actually finished, we'd have case 1), so effectively we just look for whether one was enqueued.
NOTE: The hash code is based on the string representation of the key, so it may not work correctly with exotic custom comparators.
ReactEditTexts have setFocusableInTouchMode set to false automatically because touches on the EditText are managed on the JS side.
Returns false for the default behavior of automatically laying out children without going through the ViewGroup's onLayout method.
If the path drawn previously is of the same color, there would be a slight white space between borders with anti-alias set to true.
This is to make sure that we execute all the JS operation coming from a single batch a single loop of the main (UI) android looper.
This method is frequently called from the "onScroll" handler of the "RecyclerView" with an index of first visible item of the view.
We already have the value cached, let's use it and only add heights of the items starting at the index we have the cached value for
We can reuse cached sum and calculate the new sum by subtracting heights of the elements between "mLastRequestPosition" and "index"
Also records the JS FPS, i.e. the frames per second with which either JS updated the UI or was idle and not trying to update the UI.
Call from a ScrollView in onScrollChanged, returns true if this onScrollChanged is legit (not a duplicate) and should be dispatched.
Destroys this catalyst instance, waiting for any other threads in ReactQueueConfiguration (besides the UI thread) to finish running.
It is guaranteed that for a given animation, only one of onFinished and onCancel will be called, and it will be called exactly once.
Make sure the span is removed from existing text, otherwise the spans we set will be ignored or it will cover text that has changed.
Otherwise, when view gets re-attached again, i.e when it re-enters the viewport after scroll, it won't be size and located properly.
Returns the offset within the native children owned by all layout-only nodes in the subtree rooted at this node for the given child.
Returns the touch target View of the event given, or null if neither the given View nor any of its descendants are the touch target.
TODO(5279396): Make JS UI library explicitly notify the native UI module of the end of a UI transaction using a standard native call
Trigger this by sending an intent to your activity with adb shell: am broadcast -a com.facebook.catalyst.ACTION_TRIM_MEMORY_MODERATE
Trying to override without returning true from this method is considered an error and will throw an exception during initialization.
Use `webView.loadUrl("about:blank")` to reliably reset the view state and release page resources (including any running JavaScript).
We can try saving on invalidate call here as the view that we remove is out of visible area therefore invalidation is not necessary.
We need to remove the mHostView from the parent It is possible we are dismissing this dialog and reattaching the hostView to another
When iterating over this WriteBatch, WriteBatch::Handler::LogData will be called with the contents of the blob as it is encountered.
Filters are stored in rocksdb and are consulted automatically by rocksdb to decide whether or not to read some information from disk.
If the file name of a stack frame is numeric (+ ".js"), we assume it's a lazily injected module coming from a "random access bundle".
Remove the content-type header because MultipartBuilder gets it explicitly as an argument and doesn't expect it in the headers array.
Returns whether this View type needs to handle laying out its own children instead of deferring to the standard css-layout algorithm.
This is mostly necessary to properly implement interactions and updates for properties like margin, marginLeft, and marginHorizontal.
This should never happen during normal operation, but if we're running in a non-Android environment, fall back to System.loadLibrary.
Create a temporary file in the cache directory on either internal or external storage, whichever is available and has more free space.
Set the number of levels for this database If level-styled compaction is used, then this number determines the total number of levels.
Since we only show the first JS error in a succession of JS errors, make sure we only update the error message for that error message.
This class relies on CookieManager to persist cookies to disk so cookies may be lost if the application is terminated before it syncs.
This fairness parameter grants low-pri requests permission by fairness chance even though high-pri requests exist to avoid starvation.
This is used privately by the layout engine as a more efficient way to fetch direction-aware values by avoid extra method invocations.
Base APK has not been updated since we donwloaded JS, but if app is using exopackage it may only be a single dex that has been updated.
Called when the EventDispatcher is done with an event, either because it was dispatched or because it was coalesced with another Event.
For ViewGroups, onLayout should be stubbed out to not recursively call layout on its children: React Native already handles doing that.
If one or more of the pairs cannot be inserted, this will return AsyncLocalStorageFailure, but all other pairs will have been inserted.
Loading large bitmaps efficiently: http://developer.android.com/training/displaying-bitmaps/load-bitmap.html Just decode the dimensions
Right now, though, this is how iOS does it, and we should probably update the JS and native code and make this change at the same time.
TODO(7135923): Pooling of operation objects TODO(5694019): Consider a better data structure for operations queue to save on allocations
Thus it is easier to just reuse that field instead of creating another (potentially much more expensive) mapping from view to React tag
We may be able to listen to animation interruption and set the layout manually in this case, so that next animation kicks off smoothly.
By default, all onBackPress() calls should not execute the default backpress handler and should instead propagate it to the JS instance.
Consequently, if the directory contains symbolic links to directories, we will attempt to delete the contents of pointed-to directories.
For example, when rate_bytes_per_sec is set to 10MB/s and refill_period_us is set to 100ms, then 1MB is refilled every 100ms internally.
Note that developers should call WriteOptions.dispose() to release the c++ side memory before a WriteOptions instance runs out of scope.
The factory constructor of RocksDB that opens a RocksDB instance given the path to the database using the specified options and db path.
This will trigger `layout` call on attached wrapper nodes and will let us update dimensions of them through overridden onMeasure method.
We do that to avoid passing large strings between java and native code and avoid allocating memory in java to fit whole JS bundle in it.
We need Intent.FLAG_ACTIVITY_NEW_TASK since getReactApplicationContext() returns the ApplicationContext instead of the Activity context.
We'll use this partial information, which represents the smallest possible size for the child, to compute the remaining available space.
All non-system dependencies of the given library will either be on LD_LIBRARY_PATH or will be in the same directory as the returned File.
Base class for comparators which will receive ByteBuffer based access via org.rocksdb.DirectSlice in their compare method implementation.
For a relative children, we're either using alignItems (parent) or alignSelf (child) in order to determine the position in the cross axis
For example, touch move events should only be coalesced within a single gesture so a coalescing key there would be the unique gesture id.
Implementation of this method takes advantage of that fact by caching the value for the last index that this method has been called with.
It's suppose to provide a default behavior since it would be triggered in the case when JS side doesn't want to handle back press events.
Note: even though calls can come from multiple JS VMs on multiple threads, calls to this module will still only occur on a single thread.
Practically, this means that all UI update code related to a single transaction must be executed as a single code block on the UI thread.
To work around this we have this class which just wraps another Drawable, but returns the correct dimensions in getIntrinsicWidth/Height.
locationX,Y values are relative to the target view To compute the values for the view, we subtract that views location from the event X,Y
/* This code was taken from the method setFontStyle of the class ReactTextShadowNode /* TODO: Factor into a common place they can both use
All spans will automatically extend to the right of the text, but not the left - except for spans that start at the beginning of the text.
Facebook is using an older version of the support lib internally that doesn't support setDrawerElevation so we invoke it using reflection.
Given an array of keys, this returns a map of (key, value) pairs for the keys found, and (key, null) for the keys that haven't been found.
It is also smart during updates if the changed properties can be applied directly to the Dialog or require the recreation of a new Dialog.
It's used to get layout information passed to that view from css-layout and to update its layout to be enclosed in the wrapper view group.
Pre-fill dimensions when using absolute position and both offsets for the axis are defined (either both left and right or top and bottom).
This view will only have one child that is managed by the `NativeViewHierarchyManager` and its position and dimensions are set separately.
/* This code was taken from the method setFontWeight of the class ReactTextShadowNode /* TODO: Factor into a common place they can both use
Also, note that all of the children of a view might be optimized away, so this could return the same value for multiple different children.
BFS over graph of nodes starting from ones from `mUpdatedNodes` and ones that are attached to active animations (from `mActiveAnimations)`.
For example, if the URL is "https://www.facebook.com", the system browser will be opened, or the "choose application" dialog will be shown.
MergeOperator holds an operator to be applied when compacting two merge operands held under the same key in order to obtain a single value.
TODO: Would be great to avoid adding this callback in case there are no active animations and no outstanding tasks on the operations queue.
We're holding on to the ViewParent that blocked native responders so that we can clear it when we change or clear the current JS responder.
The factory constructor of RocksDB that opens a RocksDB instance in Read-Only mode given the path to the database using the default options.
This method is called by the implementation of JS touchable interface (see Touchable.js for more details) at the moment of touch activation.
This provides an environment allowing the invocation of JavaScript methods and lets a set of Java APIs be invokable from JavaScript as well.
Called once all pending JS calls have resolved via an onBatchComplete call in the bridge and the requested native module calls have also run.
For example, if a JS application update changes the background of View A to blue and the width of View B to 100, both need to appear at once.
If you add new data to the DB and try creating a new backup now, the database will diverge from backups 4 and 5 and the new backup will fail.
It is also responsible for creating and updating CSSNode subclasses used for calculating position and size for the corresponding native view.
Such mem-table representation contains a fix-sized array of buckets, where each bucket points to a skiplist (or null if the bucket is empty).
To do that, we need to explicitly set the styleWidth and styleHeight on the LayoutShadowNode of the child of this node to be the window size.
When reopening the file, the name of the options.prefix_extractor given will be bitwise compared to the prefix extractors stored in the file.
All methods of this class could potentially throw RocksDBException, which indicates sth wrong at the RocksDB library side and the call failed.
Determines the location on screen, width, and height of the given view relative to the root view and returns the values via an async callback.
If the current timeout does not equal the passed in timeout, we need to clone the existing client and set the timeout explicitly on the clone.
In case the child is position absolute and has left/top being defined, we override the position to whatever the user said (and margin/border).
It helps to handle convertion from animation progress to the actual value as well as the quite common case when no starting value is provided.
Return true if you intend to override some other native module that was registered e.g. as part of a different package (such as the core one).
The reason that this is a function that returns "this" instead of a constructor is to enable chaining of multiple similar calls in the future.
Verifies removeSubviewsFromContainerWithID works by adding subviews, removing them, and checking that the final number of children is correct.
A simple subclass of ScrollView that doesn't dispatch measure and layout to its children and has a scroll listener to send scroll events to JS.
Also, an in-memory merge may result in writing lesser data to storage if there are duplicate records in each of these individual write buffers.
BackupEngine allows you to backup and restore the database  Be aware, that `new BackupEngine` takes time proportional to the amount of backups.
Basically, JS sends us a hierarchy of nodes that, while easy to reason about in JS, are very inefficient to translate directly to native views.
If it is non empty, the log files will be in the specified dir, and the db data dir's absolute path will be used as the log file name's prefix.
If the existing Dialog is currently up, we may need to redraw it or we may be able to update the property without having to recreate the dialog
It helps to handle convertion from animation progress to the actual values as well as the quite common case when no starting value is provided.
The ReactTextView that holds this ImageSpan is responsible for passing these methods on so that we can do proper lifetime management for Fresco
This callback then enqueues a runnable on the JS thread (if one is not already pending) that is responsible for actually dispatch events to JS.
To get layout to work properly, we need to layout all the elements within the Modal's inner content view as if they can fill the entire window.
A special RuntimeException that should be thrown by native code if it has reached an exceptional state due to a, or a sequence of, bad commands.
It is important to visit nodes in that order as they may often use values of their predecessors in order to calculate "next state" of their own.
This copies the original file from wherever it may be to the external storage pictures directory, so that it can be scanned by the MediaScanner.
This isolates us from the problems that may be caused by concurrent updates of animated graph while UI thread is "executing" the animation loop.
Because the postprocessor uses a modified bitmap, that would just get cropped in 'cover' mode, so we fall back to Fresco's normal implementation.
In some hash-based memtable representation such as HashLinkedList and HashSkipList, prefixes are used to partition the keys into several buckets.
In this case, initialReactTag corresponds to a virtual/layout-only View, and we already have a parent of that View in reactTag, so we can use it.
Keep in mind that all JS remote method calls and script load calls are asynchronous and you should not expect them to return results immediately.
This class is responsible for holding view manager property setters and is used in a process of updating views with the new properties set in JS.
We are using special source maps for these bundles, so that we can symbolicate stack traces for multiple injected files with a single source map.
A new name should be used whenever the comparator implementation changes in a way that will cause the relative ordering of any two keys to change.
Determines the location on screen, width, and height of the given view relative to the device screen and returns the values via an async callback.
For Callbacks, you don't have to do anything special -- the framework automatically tags them with the correct ExecutorToken when the are created.
If proper prefix-extractor is not set, then RocksDB will use the default memtable representation (SkipList) instead and post a warning in the LOG.
If the right font is not found in the assets folder CustomStyleSpan will fallback on the most appropriate default typeface depending on the style.
This class will redirect *TextChanged calls to the listeners only in the case where the text is changed by the user, and not explicitly set by JS.
We still want to trigger the debug listener since it allows instrumentation tests to end and check their assertions without waiting for a timeout.
If JS doesn't want to handle the back press itself, it shall call back into native to invoke this function which should execute the default handler
If some custom handling of this method apply for the view, it should be called after the listener returns and only in a case when it returns false.
Since while scrolling the queried index will usually increment or decrement by one it's optimize to return result in that common case very quickly.
This should return bubbling directly-dispatched event types and specify what names should be used to subscribe to either form (bubbling/capturing).
If true, the write will be flushed from the operating system buffer cache (by calling WritableFile::Sync()) before the write is considered complete.
Since onCatalystInstanceDestroy happens on the UI thread, we don't want to also execute this callback on the native modules thread at the same time.
Use the initial line loop to position children in the cross axis for as long as they are relatively positioned with alignment STRETCH or FLEX_START.
Class responsible for handling layout update animation, applied to view whenever a valid config was supplied for the layout animation of UPDATE type.
It implements a management interface for animated nodes graph as well as implements a graph traversal algorithm that is run for each animation frame.
It supports drawing background color and borders (including rounded borders) by providing a react friendly API (setter for each of those properties).
If your React Native application requires props set outside of JS, override this method to return the Android.os.Bundle of your desired initial props.
Implementation note re rounded corners:  Fresco's built-in rounded corners only work for 'cover' resize mode - this is a limitation in Android itself.
It should be used for modules that require special integration with other framework parts (e.g. with the list of packages to load view managers from).
Normally value will be from 0..1 range, but for spring animation it can slightly exceed that limit due to bounce effect at the start/end of animation.
(We shouldn't need to resolve dependencies for libraries loaded from system directories: the dynamic linker is smart enough to do it on its own there.)
An class that is used to receive React commands from JS and translate them into a shadow node hierarchy that is then mapped to a native view hierarchy.
Children is a view added from the adapter and always have a correct dimensions specified as they are calculated and set with NativeViewHierarchyManager
Explicitly override this to prevent accessibility events being passed down to children Those will be handled by the mHostView which lives in the dialog
If a view transitions from being layout-only to not (or vice-versa) this could result in some number of additional createView and manageChildren calls.
If the touch was intercepted by a child, we've already sent a cancel event to JS for this gesture, so we shouldn't send any more touches related to it.
NB: the assumption for calling this method is that all corresponding ReactShadowNodes have been updated **but tagsToDelete have NOT been deleted yet**.
The main difference is that we enforce this is accessed from the UI thread: this is because this ordering cannot be guaranteed across multiple threads.
when non-default Options is used, keeping an Options reference in RocksDB can prevent Java to GC during the life-time of the currently-created RocksDB.
For each animation frame we visit animated nodes that might've been updated as well as their children that may use parent's values to update themselves.
If any of the  writes to the database fails (Put, Delete, Merge, Write), the database will switch to read-only mode and fail all other Write operations.
We make the image take up 1 character in the span and put a corresponding character into the text so that the image doesn't run over any following text.
For TextInlineImageSpan we need to update the Span to know that the window is attached and the TextView that we will set as the callback on the Drawable.
Instead we use dimensions of the child view (dimensions has been set in layouting process) so that size of this view match the size of the view it wraps.
It is possible to get multiple broadcasts for the same connectivity change, so we only update and send an event when the connectivity has indeed changed.
The factory constructor of RocksDB that opens a RocksDB instance given the path to the database using the default options w/ createIfMissing set to true.
If that Looper was running on a different Thread than the current Thread, also waits for the last message being processed to finish and the Thread to die.
If the status bar is translucent hook into the window insets calculations and consume all the top insets so no padding will be added under the status bar.
The factory constructor of RocksDB that opens a RocksDB instance in Read-Only mode given the path to the database using the specified options and db path.
As all batches are executed as a single runnable on the event queue this should always be empty, but that calling architecture is an implementation detail.
If the application-supplied configuraiton does not specify an animation definition for this types, or if the animation definition is invalid, returns null.
In release builds, worker scripts need to be packaged with the app, but in dev mode we want to fetch/reload the worker script on the fly from the packager.
We allow ancestor view and measured view to be the same, in which case the position always will be (0, 0) and method will only measure the view dimensions.
Class responsible for handling layout view creation animation, applied to view whenever a valid config was supplied for the layout animation of CREATE type.
Create an animation object to be used to animate the view, based on the animation config supplied at initialization time and the new view position and size.
Exceptions thrown from native module calls end up wrapped in InvocationTargetException which just make traces harder to read and bump out useful information
SQL variable number limit, defined by SQLITE_LIMIT_VARIABLE_NUMBER: https://raw.githubusercontent.com/android/platform_external_sqlite/master/dist/sqlite3.c
Since those children will then add their native children to this view, we now have ranges of native children that correspond to single unoptimized children.
This must be used when another object takes over ownership of the native object or both will attempt to delete the underlying object when garbage collected.
This will be used in order to either set the dimensions of the node if none already exist, or to compute the remaining space left for the flexible children.
Update layout of given view, via immediate update or animation depending on the current batch layout animation configuration supplied during initialization.
Helper to allow this module to work with both the standard FragmentManager and the Support FragmentManager (for apps that need to use it for legacy reasons).
In case the child is absolutely positionned and has a top/left/bottom/right being set, we override all the previously computed positions to set it correctly.
That is because intercepted touch events are converted into CANCEL events and make all further events to be delivered to the view that intercepted the event.
The state right after pause and right before resume are the basically the same so this enum is in terms of the forward lifecycle progression (onResume, etc).
Can also record total and expected frame counts, though NB, since the expected frame rate is estimated, the expected frame count will lose accuracy over time.
We also take advantage of the fact that all active nodes are visited in the step above so that all the nodes properties `mActiveIncomingNodes` are set to zero
We have to use AsyncTask since this might trigger a NetworkOnMainThreadException, this is an open issue on OkHttp: https://github.com/square/okhttp/issues/869
changing the spinner mode in JS actually creates a new component on the native side, as there's no way to change the mode once you have constructed a Spinner.
Because React coordinates are relative to root container, and measure() operates on screen coordinates, we need to offset values using root container location.
Update layout to some values, this way we can verify it hasn't been updated, because the update process would normally reset it back to some non-negative value
we set the checked change listener to null and then restore it so that we don't fire an onChange event to JS when JS itself is updating the value of the switch
For instance, animation does since it affects Dialog creation through the theme but transparency does not since we can access the window to update the property.
In the case of the Toolbar, we don't have access to the widget's internal ImageView, which has width/height set to WRAP_CONTENT, which relies on intrinsic size.
Layout operations should also follow the native view hierarchy and go top to bottom for consistency with standard layout passes (some views may depend on this).
The main purpose of this class is to act as an intermediary between UI code generating events and JS, making sure we don't send more events than JS can process.
There is a race condition in the ProgressBar constructor that may cause crashes when two ProgressBars are constructed at the same time on two different threads.
Helper method that should be called when a native view starts a native gesture (e.g. a native ScrollView takes control of a gesture stream and starts scrolling).
Instantiating CookieManager in KitKat+ will load the Chromium task taking a 100ish ms so we do it lazily to make sure it's done on a background thread as needed.
NB: while onViewHierarchyUpdateFinished will always be called from the UI thread, there are no guarantees what thread onViewHierarchyUpdateEnqueued is called on.
No-op, terminate `requestLayout` here, UIManagerModule handles laying out children and `layout` is called on all RN-managed views by `NativeViewHierarchyManager`
It is able to take instructions from UIManagerModule and output instructions to the native view hierarchy that achieve the same displayed UI but with fewer views.
Unfortunately we need to use timeouts here in order to wait for scroll animation to happen there is no better way (yet) for waiting for scroll animation to finish
Animation progress should be within the range 0..1 (the exception here would be a spring animation engine which may slightly exceed start and end progress values).
We rely on NativeViewHierarchyManager to call `layout` on `RecyclerView` then, which will happen once all the children of `RecyclerView` have their layout updated.
Wrapper class around Fresco's GenericDraweeView, enabling persisting props across multiple view update and consistent processing of both static and network images.
we skipped an image because we couldn't get its details (e.g. width/height), so we decrement i in order to correctly reach the limit, if the cursor has enough rows
This is run when the catalyst instance is being destroyed (i.e. app is shutting down) and when the module is instantiated, to handle the case where the app crashed.
By not setting a JS module name, we force the bundle to be always loaded from assets, not the devserver, even if dev mode is enabled (such as when testing redboxes).
Implement this interface to be informed of selection changes in the ReactTextEdit This is used by the ReactTextInputManager to forward events from the EditText to JS
In case when there is no children interested in handling touch event, we return true from the root view in order to receive subsequent events related to that gesture
The purpose of this method is to return the index within the native children that corresponds to the **start** of the native children that belong to the given child.
We can take advantage on that and optimize the way we allocate property maps (we also know that updating view props doesn't retain a reference to the styles object).
If you want to override this method you should call super.onAfterUpdateTransaction from it as the parent class of the ViewManager may rely on callback being executed.
In case when property has been removed from the corresponding react component annotated setter will be called and default value will be provided as a value parameter.
On old versions of Android, Bionic doesn't add our library directory to its internal search path, and the system doesn't resolve dependencies between modules we ship.
A wrapper around the EditText that lets us better control what happens when an EditText gets focused or blurred, and when to display the soft keyboard and when not to.
Debug object that listens to bridge busy/idle events and UiManagerModule dispatches and uses it to calculate whether JS was able to update the UI during a given frame.
Method SoLoader.init is idempotent, so if you wish to use native exopackage, just call SoLoader.init with appropriate args before initializing ReactInstanceManagerImpl
@return Return true to steal motion event from the children and have the dispatched to this view, or return false to allow motion event to be delivered to children view
Creates a WriteBatchWithIndex where no bytes are reserved up-front, bytewise comparison is used for fallback key comparisons, and duplicate keys operations are retained
number of times bloom was checked before creating iterator on a file, and the number of times the check was useful in avoiding iterator creation (and thus likely IOPs).
Currently this class is only used to remove layout-only views, that is to say views that only affect the positions of their children but do not draw anything themselves.
If set to 1, then all write buffers are flushed to L0 as individual files and this increases read amplification because a get request has to check in all of these files.
Rearranging the text (i.e. changing between singleline and multiline attributes) can also trigger onTextChanged, call the event in JS only when the text actually changed
RocksIterator must hold a reference to the related parent instance to guarantee that while a GC cycle starts RocksIterator instances are freed prior to parent instances.
Also, note measure and layout need to be called *after* all View properties have been updated because of caching and calculation that may occur in onMeasure and onLayout.
Even though we have exact dimensions, we still call measure because some platform views (e.g. Switch) assume that method will always be called before onLayout and onDraw.
The factory constructor of RocksDB that opens a RocksDB instance given the path to the database using the specified options and db path and a list of column family names.
do *not* call super.onStop() on KitKat on lower, as that would erroneously call the OnDateSetListener when the dialog is dismissed, or call it twice when "OK" is pressed.
However, we do not perform a layout() after a requestLayout(), so we need to override isLayoutRequested to force EditText to scroll to the end of the new text immediately.
It accomplishes this by drawing its hierarchy into a software Canvas, saving the resulting Bitmap and then drawing that Bitmap to the actual Canvas provided by the system.
NB: for perf reasons this does not apply opacity, as that would mean creating a new canvas layer (which allocates an offscreen bitmap) and having it composited afterwards.
To achieve that we call `forceLayout()` on the view modified and on `RecyclerView` instance (which is accessible with `v.getParent().getParent()` if the view is attached).
Consume 'Enter' key events: TextView tries to give focus to the next TextInput, but it can't since we only allow JS to change focus, which in turn causes TextView to crash.
Determines how the method is exported in JavaScript: METHOD_TYPE_REMOTE for regular methods METHOD_TYPE_REMOTE_ASYNC for methods that return a promise object to the caller.
Given a "family" font family the files in the assets/fonts folder need to be family.ttf(.otf) family_bold.ttf(.otf) family_italic.ttf(.otf) and family_bold_italic.ttf(.otf)
Is used by unit test to setup mWasMeasured and mIsAttachedToWindow flags, that will let this view to be properly attached to catalyst instance by startReactApplication call
A good example is supporting "border", where we have 7 variations of that property ("borderLeft", "borderHorizontal", etc.) and very similar code for handling each of those.
Default is 4mb, which is reasonable to reduce random IO as well as prevent overallocation for mounts that preallocate large amounts of data (such as xfs's allocsize option).
Given a "family" font family the files in the assets/fonts folder need to be family.ttf(.otf) family_bold.ttf(.otf) family_italic.ttf(.otf) and family_bold_italic.ttf(.otf).
If it is empty, the log files will be in the same dir as data, dbname is used as the data dir by default If it is non empty, the log files will be in kept the specified dir.
In case of an error JS side expect to get a finish event first, and then get an error event Android WebView does it in the opposite way, so we need to simulate that behavior
The blob will NOT consume sequence number(s) and will NOT increase the count of the batch  Example application: add timestamps to the transaction log for use in replication.
This is unlike all other calls on this class where we assume all operations on the shadow hierarchy have already completed by the time a corresponding method here is called.
When extending JavaScriptModule and registering it with a CatalystInstance, all public methods are assumed to be implemented on a JS module with the same name as this class.
However, there might be virtual children that can receive pointer events, in which case we still want to return this View and dispatch a pointer event to the virtual element.
Since native methods are invoked from a message queue executed on a single thread, it is save to allocate only one arguments object per method that can be reused across calls
We expect that the output of the addition node will take the starting value of the second input node even though the node hasn't been connected to an active animation driver.
wrapper.getParent() points to the recycler if the view is currently attached (it could be in "scrape" state when it is attached to recyclable wrapper but not to the recycler)
2) The bridge ended the frame idle (meaning there were no JS nor native module calls still in flight) AND there was no UiManagerModule update enqueued that didn't also finish.
If react context is being created in the background, JS application will be started automatically when creation completes, as root view is part of the attached root view list.
In case when someone schedule 2 subsequent reloads it may happen that JS thread will start reading first reload output while the second reload starts writing to the same file.
This listener is called when the user presses KeyEvent.KEYCODE_BACK An event is then passed to JS which can either close or not close the Modal by setting the visible property
Those are objects (represented as a graph nodes too) that based on some criteria updates attached values every frame (we have few types of those, e.g., spring, timing, decay).
Warning : This method will be removed in future version of React Native, and layout animation will be enabled by default, so always check for its existence before invoking it.
Since these Exceptions are triggered by JS calls (and can be fixed in JS), a common way to handle one is to show a error dialog and allow the developer to change and reload JS.
Those pulses then propagate along the graph to the children nodes up to the special node type: AnimatedProps which then can be used to calculate property update map for a view.
frames are calculated at 60FPS, to get index by a given time offset from the start of the animation, we take the time diff in millisecond and divide it by 60 frames per 1000ms.
This also protects the database from filling up the disk cache and becoming malformed (endTransaction() calls will throw an exception, not rollback, and leave the db malformed).
We avoid expanding the lower level file set of a compaction if it would make the total compaction cover more than (expanded_compaction_factor * targetFileSizeLevel()) many bytes.
Each log message is checked against the set log level and if the log level is more verbose as the set log level, native allocations will be made and data structures are allocated.
NB: We write to a temp file instead of returning a String because, depending on the size of the worker script, allocating the full script string on the Java heap can cause an OOM.
TODO(7255985): Use TextureView and pass Surface from the view to draw on it asynchronously instead of passing the bitmap (which is inefficient especially in terms of memory usage)
Uses Java proxy objects to dispatch method calls on JavaScriptModules to the bridge using the corresponding module and method ids so the proper function is executed in JavaScript.
For START and END events send only index of the pointer that is associated with that event For MOVE and CANCEL events 'changedIndices' array should contain all the pointers indices
ColumnFamilyHandle must hold a reference to the related RocksDB instance to guarantee that while a GC cycle starts ColumnFamilyHandle instances are freed prior to RocksDB instances.
That means, depending on when we get updates from JS and what else is happening on the UI thread, we can sometimes try to post this runnable after ViewRootImpl has posted a barrier.
This may have unforeseen ramifications: for example, a corruption of one DB entry may cause a large number of entries to become unreadable or for the entire DB to become unopenable.
This value will be stored inside the SST file which will be used when reading from the file, which makes it possible for users to choose different encoding type when reopening a DB.
This function should only be called by Options.setMemTableConfig(), which will create a c++ shared-pointer to the c++ MemTableRepFactory that associated with the Java MemTableConfig.
if view parent is null, skip animation: view have been clipped, we don't want animation to resume when view is re-attached to parent, which is the standard android animation behavior.
This is not expected to happen very often as it would mean some child View has decided to intercept the touch stream and start a native gesture only upon receiving the UP/CANCEL event.
As developers cannot construct their own DirectSlice objects through this, they are not creating underlying C++ DirectSlice objects, and so there is nothing to free (dispose) from Java.
Note that since this mem-table representation relies on the key prefix, it is required to invoke one of the usePrefixExtractor functions to specify how to extract key prefix given a key.
All updateLayout calls are collected and dispatched at the end of a batch because updateLayout calls to layout-only nodes can necessitate multiple updateLayout calls for all its children.
Ideally, we don't need this and JS is fast enough to process all the events each frame, but bad things happen, including load on CPUs from the system, and we should handle this case well.
Now, if one of its ancestors sets requestDisallowInterceptTouchEvent to false, it unsets the setting for itself and all of its ancestors, which means that they can intercept events again.
This should only be called the first time the application is set up, which is enforced to keep developers from accidentally creating their application multiple times without realizing it.
We avoid picking too many files in the source level so that we do not exceed the total source bytes for compaction to exceed (source_compaction_factor * targetFileSizeLevel()) many bytes.
By default the method extracts the shared library for loading at java.io.tmpdir, however, you can override this temporary location by setting the environment variable ROCKSDB_SHAREDLIB_DIR.
NB: onTransitionToBridgeIdle and onTransitionToBridgeBusy may be called from different threads, and those threads may not be the same thread on which the listener was originally registered.
Note that this currently only applies to Nodes/FlatViewGroup as it's the only class that is both a ViewGroup and ReactCompoundView (ReactTextView is a ReactCompoundView but not a ViewGroup).
Specify to create a tailing iterator -- a special iterator that has a view of the complete database (i.e. it can also be used to read newly added data) and is optimized for sequential reads.
this runnable is used by onchange endpoint poller to delay subsequent requests in case of a failure, so that we don't flood network queue with frequent requests in case when dev server is down
Even if it's a bug in the framework/native code, it was triggered by JS and theoretically since we were able to set up the bridge, JS could change its logic, reload, and not trigger that crash.
TODO: Reuse propsMap and stylesDiffMap objects - note that in subsequent animation steps for a given node most of the time we will be creating the same set of props (just with different values).
The host IP we use when connecting to the JS bundle server from the emulator is not the same as the one needed to connect to the same server from the JavaScript proxy running on the host itself.
We need this because of clowniness in datepicker that causes it to throw an exception if minDate is greater than the internal timestamp that it generates from the y/m/d passed in the constructor.
That is after user starts the gesture from a touchable view with a given reactTag, or when user drag finger back into the press activation area of a touchable view that have been activated before.
The caller should include the animation stop time in ms (unix time) so that we know when the animation stopped from the JS perspective and we don't count time after as being part of the animation.
This optimization is important for view hierarchy depth (which can cause stack overflows during view traversal for complex apps), memory usage, amount of time spent during GCs, and time-to-display.
The config for hash linked list memtable representation Such memtable contains a fix-sized array of buckets, where each bucket points to a sorted singly-linked list (or null if the bucket is empty).
This means we previously had another child start handling this native gesture and now a different native parent of that child has decided to intercept the touch stream and handle the gesture itself.
To make a RocksDB to use a specific MemTable format, its associated MemTableConfig should be properly set and passed into Options via Options.setMemTableFactory() and open the db using that Options.
