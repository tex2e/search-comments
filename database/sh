Disable this feature.
Do each installation.
Make sure echo works.
Maybe even breaks it.
Preserve exit status.
Scour for shim files.
These must come last.
argument parsing loop
figure out the soname
location of libunwind
used as fallback echo
Names of this library.
Parameter description:
Seekrandomwhilewriting
autoconf 2.59 or newer
Aesthetically quote it.
Delete the old objects.
Name of the PIC object.
and its dependency_libs
endif ifdef __cplusplus
used for prog,scan pass
Maybe just do a dry run.
Nullify the symbol file.
This is a terrible hack.
ifdef FREEBSD_WORKAROUND
use dlname if we got it.
A standard non-PIC object
Can't find it, oh well...
Export the shlibpath_var.
Files to dlopen/dlpreopen
Generate the html report.
Gone through all deplibs.
Infer the operation mode.
Link against this library
No such image, so make it
Read the libtool library.
Some other compiler flag.
The name of this program:
We need an absolute path.
exit if any command fails
Add React Native copyright
Add the color to the diff.
Check clang-format-diff.py
Do the single finish_eval.
Get the absolute pathname.
Hardcode the library path.
Hardcode the library paths
Run from react-native root
Search the libtool library
Test 5: random range scans
The program doesn't exist.
endif if defined (S_IXGRP)
make sure that node exists
run tests and check output
"BG" stands for background.
Define a set of benchmarks.
Delete the generated files.
Delete the old output file.
Display what would be done.
Evaluate the configuration.
Fetch right version of gcov
Generate four random files.
It's actually not that bad.
Name of the non-PIC object.
write rate for readwhile...
A libtool-controlled object.
Be nice, post SIGTERM first.
Causes problems with __ctype
Create the object directory.
Create the old-style object.
Delete the old output files.
Determine the type of output
Diff against the old results
Figure out why this happens.
Link the convenience library
Link the executable and exit
Restore the value of output.
We handle these cases below.
make the tar for node's deps
push to csp branch on github
(optional) move to a new line
A libtool-controlled library.
Clean up the generated files.
Collect dlpreopened libraries
Preload the old-style object.
Remove this search path later
Set up the ranlib parameters.
Some other compiler argument.
There are three entry points:
This might be a little naive.
could be an import, or static
measure overwrite performance
npm command completion script
only static version available
switch based on node version.
Copyright (c) 2012 Google Inc.
Copyright 2009 The Go Authors.
Copyright 2012 The Go Authors.
Copyright 2013 The Go Authors.
Do in-place format adjustment.
Do the static libraries later.
Don't allow undefined symbols.
Don't check for shared/static.
Just move the object if needed
Now create the wrapper script.
Now hardcode the library paths
REMOVE after next semver-major
Transform arg to wrapped name.
We should set the runpath_var.
echo "Installing without make.
make the zip for windows users
note: grep -r is not portable.
relink executable if necessary
remove all the sub directories
try without the -e arg to sed.
A word about this shell script:
Check the format of last commit
Extract -R from dependency_libs
It'll also stub "node-pre-gyp".
Now create the libtool archive.
The generator is "mkerrors.sh".
The name of the static archive.
The name that we can dlopen(3).
We should set the shlibpath_var
fast_install is set to needless
not-installed libtool libraries
Accept any command-line options.
Calculate the version variables.
Can't use summarize_result here.
Do each of the archive commands.
This is the magic to use -rpath.
This shell script fills the gap.
Transform .lo files to .o files.
Warn if it was a shared library.
Write go tool cgo -godefs input.
libtool clean and uninstall mode
should download the headers file
Aesthetically quote the argument.
Again, writing regexps to a file.
CHECK ME:  I think I busted this.
Create links to the real library.
Handle -dlopen flags immediately.
Instead, add this to base_compile
Test 12: range scan while writing
Test 17: range scan while merging
Test 3: single-threaded overwrite
This runs with a vector memtable.
Add the arguments to base_compile.
Anything else should be a program.
Fast installation is not supported
Gather all diagnostic identifiers.
I would guess that would be a bug.
Install the old object if enabled.
Only for tests that do range scans
Test 11: random read while writing
Test 16: random read while merging
Test 6: random reverse range scans
func_extract_an_archive dir oldlib
By default we'll run all the tests.
Get the name of the library object.
I think this is a good way to load.
Just accumulate the unique libdirs.
Note the libdir as a future libdir.
Objects from convenience libraries.
Pull out the error names for later.
Relative path: add a thisdir entry.
Renaming some stuff in the cpp file
Restore saved environment variables
This is an annoying source of bugs.
dummy test just to compact the data
git clean -dfx git fetch git rebase
publish to npm and update dist tags
version is not provided, use latest
Delete any leftover library objects.
Eliminate all temporary directories.
Error occurred in the first compile.
Just use the default operation mode.
Make sure IFS has a sensible default
Now compile the dynamic symbol file.
Only check for convenience libraries
Prepare the list of exported symbols
Pull out the signal names for later.
Quote the link command for shipping.
See the names of the shared library.
Skip --install_dir and --fbcode_dir.
Use standard objects if they are pic
We need to hardcode the library path
arg is usually of the form 'gcc ...'
make sure we fail if the test failed
Exit here if they wanted silent mode.
Install (i.e. copy) a libtool object.
Libraries that this one depends upon.
Only an error if not doing a dry-run.
Only for *whilewriting, *whilemerging
These are relics of 0.2 npm installs.
Check the format of uncommitted lines,
Get the most recently committed files.
Maybe install the static library, too.
Quote the relink command for shipping.
Replace the output file specification.
also remove any symlinks to this file.
location of bzip headers and libraries
location of zlib headers and libraries
Building a libtool convenience library.
Do each command in the finish commands.
Extract subdirectory from the argument.
Now add the directory to shlibpath_var.
Parse the name list into a source file.
Parse the version information argument.
Pass these as arguments to this script.
The first argument is the command name.
Then .hhas files are included en-masse.
This is used for the "readwhile" tests.
Try sorting and uniquifying the output.
Try to get the absolute directory name.
fixup the dll searchpath if we need to.
func_extract_archives gentop oldlib ...
if defined (HAVE_DOS_BASED_FILE_SYSTEM)
measure readrandom with 6GB block cache
BEGIN LIBTOOL TAG CONFIG: disable-shared
Based on the Bash documentation example.
Do each command in the archive commands.
Export our shlibpath_var if we have one.
If it is, it will not operate correctly.
If this fails, it's not such a big deal.
Install the libtool object if requested.
Only create the output if not a dry run.
Possibly a libtool object, so verify it.
Restore the uninstalled library and exit
Running those commands is not automatic.
This library was specified with -dlopen.
do not add paths which are already there
location of gflags headers and libraries
location of snappy headers and libraries
platform is not provided, use latest gcc
./ldb needs to be avaible to be executed.
2048 is the max for non root users on Mac
If the PIC object exists, use it instead.
Make sure we have at least an empty file.
Now prepare to actually exec the command.
Possibly a libtool archive, so verify it.
Test 13: reverse range scan while writing
Test 18: reverse range scan while merging
We don't need to create a wrapper script.
but shell scripts are "executable" too...
fbconfig passes a couple --foo arguments.
install all required packages for rocksdb
measure readrandom with 100MB block cache
Assumes GNU versions of utilities in PATH.
Copyright (c) 2011-present, Facebook, Inc.
Copyright (c) 2015-present, Facebook, Inc.
Delete the libtool libraries and symlinks.
Discover the nlist of each of the dlfiles.
Recognize several different file suffixes.
Run the actual program with our arguments.
The library was specified with -dlpreopen.
always keep a non-empty value in "srcfile"
install mode needs the following variable:
look for old 0.x cruft, and get rid of it.
see symlink-check above in file_magic test
set java home so we can build rocksdb jars
Discard the --no-reexec flag, and continue.
Encode it into a variable for safe keeping.
Get the real and link names of the library.
Loop over the list of objects to be linked.
Setting up the proxy for remote repo access
Skip this library if it cannot be dlopened.
This library was specified with -dlpreopen.
We only need to search for static libraries
deplib doesn't seem to be a libtool library
measure readrandom with 8k data in memtable
place dlname in correct position for cygwin
report.txt provides a high level statistics
Add the "lib" prefix for modules if required
Check to see that each library is installed.
Do each command in the postinstall commands.
Follow Location: headers, and fail on errors
Hacky way of disabling fbmake's pre_command.
If mktemp works, use that first and foremost
Install the binary that we compiled earlier.
Should already be sitting in the npm folder.
The environment variables are also optional.
This is the part we're really interested in.
Unlock the critical section if it was locked
Whether the deplib will be linked statically
otherwise, try to find gmake, and then make.
running on devbox, just print out the values
Always ask for I/O statistics to be measured.
Append the command to create the export file.
Darwin ld doesn't like 0 for these options...
Deduce the name of the old-style object file.
Delete the old symlinks, and create new ones.
Find the directory that this script lives in.
Only set LANG and LC_ALL to C if already set.
Rhapsody C library is in the System framework
define lt_preloaded_symbols some_other_symbol
measure fillseq with bunch of column families
Add PIC object to the list of files to remove.
Allow the use of GNU shtool's install command.
Check the variables that should have been set.
Do a test to see if this is a libtool program.
Do each command in the postuninstall commands.
Do not bother doing anything if just a dry run
Exit if we aren't doing a library object file.
Only append if the libtool object file exists.
Strip any trailing slash from the destination.
The tests in step 1 are only run for 1 thread.
We need to display help for each of the modes.
Accept the current argument as the source file.
Add our own program objects to the symbol list.
Avoid inline document here, it may be left over
Change the help message to a mode-specific one.
End of Shell function definitions  Darwin sucks
FIXME: remove this flag sometime in the future.
Just add the directory containing the .lo file.
Make executables depend on our current version.
Make it easier to run only the compaction test.
Make sure dlprefiles contains only unique files
Path to react-native folder inside node_modules
Return value 0 means all regression tests pass.
Tune values for level and universal compaction.
use Intel SSE support for checksum calculations
A base image with build tools and a user account
Add the search paths of all dependency libraries
Add the symbol object into the linking commands.
Assume this is the tagged configuration we want.
Bundle React Native app's code and image assets.
Check that each of the things are valid numbers.
Get the compilation command and the source file.
Helper for running TestExt from an fbmake build.
If there's no bash, then don't even try to clean
It would break on at least Digital Unix and AIX.
Just implementing what was already the behavior.
Parse our command line options once, thoroughly.
Prepend the subdirectory the object is found in.
Substitute the hardcoded libdirs into the rpath.
Test 2c: same as 2a, but with WAL being enabled.
Test 2d: same as 2b, but with WAL being enabled.
The current "srcfile" will either be retained or
The only shell it won't ever work on is cmd.exe.
Transform the symbol file into the correct name.
Write the output to both stdout and report file.
Backslashes separate directories on plain windows
Check to see that the destination is a directory.
Define NVM_DIR and source the nvm.sh setup script
Do not include libc due to us having libc/libc_r.
If there is no directory component, then add one.
If we're not in dry-run mode, bomb out on failure
Make sure under any mode, we can read user input.
Now set the variables for building old libraries.
POSIX demands no paths to be encoded in archives.
Run C program to print error and syscall strings.
Sed substitution that helps us do robust quoting.
See if we need to build an old-fashioned archive.
Set up the nodenv node version manager if present
Start in website/ even if run from root directory
non-PIC code in shared libraries is not supported
Add non-PIC object to the list of files to remove.
Check if any of the arguments is a wrapper script.
Check to see that this really is a libtool object.
Do each command in the old_postuninstall commands.
Do not include libc_r directly, use -pthread flag.
Install the shared library and build the symlinks.
See types_darwin.c and types_linux.c for examples.
This assumes single-version convenience libraries.
paths that contain not-installed libtool libraries
the next one goes into the "base_compile" arg list
But we'll never go from static-only to shared-only.
Check to see that this really is a libtool archive.
Find all gcno files to generate the coverage report
I'm not sure if I'm treating the release correctly.
Make a new name for the extract_expsyms_cmds to use
Only execute mode is allowed to have -dlopen flags.
Quote arguments (to preserve shell metacharacters).
We cannot seem to hardcode it, guess we'll fake it.
Without this assignment, base_compile gets emptied.
Again, we only want to link against shared libraries
Check whether tagname contains only valid characters
Don't link with libc until the a.out ld.so is fixed.
Find the relevant object directory and library name.
If given, STRING is the basename for that directory.
If the previous option needs an argument, assign it.
Install the pseudo-library for information purposes.
On all known operating systems, these are identical.
See the GNU General Public License for more details.
The command line is too long to execute in one step.
The previous "srcfile" becomes the current argument.
test for cygwin because mv fails w/o .exe extensions
Allow error messages only from the first compilation.
Directory that this library needs to be installed in:
Do a test to see if this is really a libtool program.
If no command line arguments then run for 24 threads.
If the user specified any rpath flags, then add them.
Link the dlpreopened libraries before other libraries
Make sure the rpath contains only unique directories.
Mksyscall reads those comments to generate the stubs.
See if our shared archives depend on static archives.
Stick the inst_prefix_dir data into the link command.
The auto-generated files have names beginning with z.
This script is documentation more than anything else.
We need to accept at least all the BSD install flags.
Work around backward compatibility issue on IRIX 6.5.
calculate the name of the file, without its directory
Add in all the interfaces that we are compatible with.
Add libc to deplibs on all other systems if necessary.
Finalize command for both is simple: just hardcode it.
If the library has no export list, then create one now
Interval between checks if the process is still alive.
It uses the latest g++ compiler and also uses jemalloc
Make sure the xrpath contains only unique directories.
Otherwise, use the dlname, so that lt_dlopen finds it.
Parse the raw gcov report to more human readable form.
Strip out hex symbols and other extraneous differences
The effects of -static are defined in a previous loop.
The first file doesn't have a previous command to add.
We save the old values to restore during execute mode.
But we must not use pic_flag when linking with -static.
Follow symbolic links until we get to the real thisdir.
Go through the arguments, transforming them on the way.
In level-based compaction, it means number of L0 files.
Make a backup of the uninstalled library when relinking
Only actually do things if our run command is non-null.
Test 2b: sequential fill with the configured value size
These systems don't actually have a C library (as such)
This is valid on all known static and shared platforms.
whether we're linking any uninstalled libtool libraries
Building outside of a git repo, use system time instead.
Check to see if the archive will have undefined symbols.
Double-quote args containing other shell metacharacters.
If the previous option needed an argument, then skip it.
If there was a directory component, then change thisdir.
Preserve any variables that may affect compiler behavior
REQUIRE: db_bench binary exists in the current directory
Test again, we may have decided not to build it any more
This environment variable determines our operation mode.
Transform all the library objects into standard objects.
fill up the db for readrandom benchmark (1GB total size)
measure fillseq + fill up the DB for overwrite benchmark
prevent CircleCI from killing the process for inactivity
the above command should be used before it gets too long
we need to force mongo to use static library, not shared
Add the dll search path components to the executable PATH
Deduce the name of the destination old-style object file.
Don't error if the file doesn't exist and rm -f was used.
On Rhapsody replace the C library is the System framework
Only do commands if we really have different PIC objects.
Rhapsody C and math libraries are in the System framework
The Bash shell script executes a command with a time-out.
We might want to check whether the library exists or not.
now actually clean, but only if there's anything TO clean
Execute a set of benchmarks to cover variety of scenarios.
FIXME: should reinstall the best remaining shared library.
If readlink isn't available, then this is just too tricky.
Switch back when this issue with xctool has been resolved.
TODO: we also need to get the files of the latest commits.
This should be run from the parent of the tools directory.
func_win32_libid arg return the library type of file 'arg'
libraries that don't have pic variant will not be included
Add the libdir to current_libdirs if it is the destination.
Don't allow lazy linking, it breaks C++ global constructors
It is a libtool convenience library, so add in its objects.
Loop through the commands generated above and execute them.
Make sure lib_search_path contains only unique directories.
Now look for all potential identifiers in the source files.
Otherwise, we'll check format of the uncommitted code only.
This allows tests from steps 2, 3, 4 to be repeated faster.
Try looking first in the location we're being installed to.
We need to know -static, to get the right output filenames.
arg Now actually substitute the argument into the commands.
measure overwrite performance with bunch of column families
now remove the package modules, and the .npm folder itself.
script for creating a zip and tarball for inclusion in node
write rate for tests other than readwhile, 0 means no limit
Amend to last commit if user do the post-commit format check
Determine the prefix the user has applied to our future dir.
If -module or -export-dynamic was specified, set the dlname.
If libtool objects are unsupported, then we need to preload.
If the user specifies -o file.o, it is replaced with file.lo
Return a directory name, but don't create it in dry-run mode
This prevents here-documents from being left over by shells.
measure readrandom with 6GB block cache and tailing iterator
Append the name of the PIC object to the libtool object file.
Check argparse, a library that clang-format-diff.py requires.
First, .php files are included with their open tags stripped.
Make sure we don't pick an alternate name that also overlaps.
Only build a PIC object if we are building libtool libraries.
Remove version info from name if versioning should be avoided
Suppress compiler output if we already did a PIC compilation.
This uses the latest available iOS SDK, which is recommended.
Upon time-out expiration SIGTERM (15) is sent to the process.
We still want the files in our tree since they are checked in
note that we can only use strict sh-compatible patterns here.
Append the name of the non-PIC object the libtool object file.
Compiler inserts libc in the correct place for threads to work
If no make is found, then just execute the necessary commands.
Make sure we only generate libraries of the form `libNAME.la'.
This doesn't have to be quite as cross-platform as install.sh.
Update dependencies.sh file with the latest avaliable versions
XXX For some reason, make is building all the docs every time.
cmd/cgo doesn't support llvm-gcc-4.2, so we have to use clang.
now prefix is where npm would be rooted by default go hunting.
But, then there is irix which has an extra 1 added just for fun
Check if this script has already been added to pre-commit hook.
First, compute the expected output using regular HHVM execution
For more details on the changes see the blog post listed below.
However, greadlink is fine, so Solaris can join the party, too.
The linker will fail if global_symbol_pipe really was required.
These systems don't actually have a C or math library (as such)
Use a single thread to reduce the variability in the benchmark.
You can use this script if you want to use an external cdb lib.
make sure the library variables are pointing to the new library
the command line is too long to link in one step, link in parts
The main benefit behind disabling WAL is to make loading faster.
The problem exists in FreeBSD 2.2.6 and is fixed in FreeBSD 3.1.
This hand-written assembly file implements system call dispatch.
All the library-specific variables (install_libdir is set above).
Assumes old tracelogs are in *.log.old and new ones are in *.log.
Be Bourne compatible (taken from Autoconf:_AS_BOURNE_COMPATIBLE).
Figure out destination file name, if it wasn't already specified.
If this is too large then the non-writer threads can get starved.
Lots of our logic relies on knowing the shape of the token table.
Only build a position-dependent object if we build old libraries.
Print commands before executing them (useful for troubleshooting)
Replace all uninstalled libtool libraries with the installed ones
The command line is too long to link in one step, link piecewise.
Transform deplibs into only deplibs that can be linked in shared.
Usage: First do 'make -C ../src test' to generate the .out files.
Just move the object if needed, then go on to compile the next one
Print all diags that occur in the .td files but not in the source.
Typecheck, compile with the emitter and run the generated assembly
a race to see which make process will be the one to install marked
Read the .lo file If there is no directory component, then add one.
The 'exit 0' below will be executed if any preceding command fails.
This script should be run from the base of "nuclide-debugger-node".
Verify that the sample dump file is undumpable and then redumpable.
We have no uninstalled library dependencies, so finalize right now.
FIXME: these two pipelines are reading and writing to the same file.
If we cannot find lcov in this machine, we'll simply skip this step.
Remember objdir for removal later, being careful to avoid duplicates
v2.1 or older doesn't pass the debug build but OK with release build
Clear the version info if we defaulted, and they specified a release.
If we have no mode, but dlfiles were specified, then do execute mode.
Skip directories that are in the system default run-time search path.
This runs with a vector memtable and the WAL disabled to load faster.
This wrapper script should never be moved out of the build directory.
Unless otherwise specified, we'll not generate html report by default
Xcode project file for React Native apps is located in ios/ subfolder
measure memtable performance -- none of the data gets flushed to disk
If there are failures, their test filenames will be printed to stdout.
Make sure dlfiles contains only unique files that won't be dlpreopened
Make sure that fillrandom uses the same compaction options as compact.
No PIC object so indicate it doesn't exist in the libtool object file.
VAL_SIZE      - the length of the value in the key/value pairs loaded.
a race to see which make process will be the one to install marked-man
- This is done just by looking for those tokens and setting the "flag".
Highlight the insertion/deletion from the clang-format-diff.py's output
Make sure the variables and directories we expect to exist actually do.
Not a directory, so check to see that there is only one file specified.
On Cygwin there's no "real" PIC flag so we must build both object types
The constant "fillseq" which we pass to db_bench is the benchmark name.
The list of threads is optional and when not set is equivalent to "24".
The real first argument should be the name of the installation program.
This code stresses the "libraries are programs" paradigm to its limits.
If the signal is blocked, then the subsequent SIGKILL (9) terminates it.
install all required packages for rocksdb that are available through yum
measure readrandom after load with filluniquerandom with 6GB block cache
remove .exe since cygwin /usr/bin/install will append another one anyway
All subsequent reloadable object files will link in the last one created.
Handle the remaining objects by creating one last reloadable object file.
These modes are in order of execution frequency so that they run quickly.
Try to find a suitable make If the MAKE environment var is set, use that.
We keep going just in case the user didn't refer to lt_preloaded_symbols.
git add --all git commit -m "update website" git push cd ../relay/website
Last step: remove runtime libs from dependency_libs (they stay in deplibs)
Need to hardcode shared library paths or/and link against static libraries
Clear the reloadable object creation command queue and initialize k to one.
Set up a command to remove the reloadable object files after they are used.
com.facebook.soloader.MinElf uses these structures while parsing ELF files.
install gcc/g++ 4.8.2 via CERN (http://linux.web.cern.ch/linux/devtoolset/)
we do not want to link against static libs, but need to link against shared
NOTE: Changing this file will not affect anything until you rerun configure.
Then we can check whether they linked in statically or dynamically with ldd.
See what "npm_config_*" things there are in the env, and make them permanent.
remove any links into the .npm dir, or links to version-named shims/symlinks.
If there is no dlopen support or we're linking statically, we need to preload.
Set this to skip a set of tests which aren't critical for getting key metrics.
Tiny little helper to create the empty php7 versions of your regression tests.
fill up the db for readrandom benchmark with filluniquerandom (1GB total size)
measure readwhilewriting after load with filluniquerandom with 6GB block cache
Delay between posting the SIGTERM signal and destroying the process by SIGKILL.
Set environment variables so that we can compile rocksdb using fbcode settings.
If a disable-shared tag is given, we'll fallback to a static-only configuration.
Let's try to salvage the situation: Compile a separate program for each library.
One way to analyze the results is to run "grep real" on the resulting log files.
We compile a program, linking it against the deplibs as a proxy for the library.
An image on top of the base containing clones of repos we want to use for testing
NSECONDS      - number of seconds for which to run each test in steps 2, 3 and 4.
Use '-' rather than '.', since we only want one extension on DOS 8.3 filesystems.
For universal compaction, these level0_* options mean total sorted of runs in LSM.
Here we assume that one of hardcode_direct or hardcode_minus_L is not unsupported.
Calculate the filename of the output object if compiler does not support -o with -c
It backslashifies metacharacters that are still active within double-quoted strings.
Don't test for the "default" C tag, as we know, it's there, but not specially marked.
The compiler in the base compile command matches the one in the tagged configuration.
This should be used with the LevelDB fork listed here to use additional test options.
Will build using it and check DBs generated by all previous tags can be opened by it.
Will suggest user to add this script to pre-commit hook if their pre-commit is empty.
need to echo "" after, because Posix sed doesn't treat EOF as an implied end of line.
Use a potentially-scary awk script to split the single hphp.y parser into two outputs.
Usually no arguments are needed, but mkerrors.sh will pass its arguments on to godefs.
Prefer using a static library (so that no silly _DYNAMIC symbols are required to link).
Hello Chet, please find attached a "little easier"  :-)  to comprehend time-out example.
This script produces a list of all diagnostics that are defined but not used in sources.
A small script for comparing IR for unit tests from before and after a change to the JIT.
Break out early, otherwise skipped_export may be set to false by a later but shorter cmd.
Demonstrate that h2tp can handle file- and directory-name components that contain spaces.
I think release should show up in the -l (ie -lgmp5) so we don't want to add it in twice.
If there is no dlname, no dlopen support or we're linking statically, we need to preload.
It is still crash safe and the client can discover where to restart a load after a crash.
Print out the colored progress info so that it can be brainlessly distinguished by users.
win32 will think the script is a binary if it has a .exe suffix, so we strip it off here.
The following is split over four lines so Phabricator doesn't think this file is generated
We're trying link a shared library against a static one but the system doesn't support it.
If this variable is set in any of the actions, the command in it will be execed at the end.
Let the type of C char be signed to make the bare syscall API consistent between platforms.
Make sure that we'll have unique names for all the files so that data won't be overwritten.
RANGE_LIMIT   - the number of rows to read per range query for tests that do range queries.
The statement above tries to avoid entering an endless loop below, in case of cyclic links.
we can't check for "0.0" in archive_cmds due to quoting problems, so we reset it completely
An additional grant of patent rights can be found in the PATENTS file in the same directory.
Produces an ir-diffs.diff file that you can inspect for meaningful differences in JIT output.
This variable tells wrapper scripts just to set variables rather than running their programs.
Whenever we create different ones for PIC/non-PIC, this we'll have to duplicate the extraction.
for MKS sh The HP-UX ksh and POSIX shell print the target directory to stdout if CDPATH is set.
Create an invalid libtool object if no PIC, so that we don't accidentally link it into a program.
If it won't happen then empty output from grep when searching for "Sum" will cause syntax errors.
Only attempt this if the compiler in the base compile command doesn't match the default compiler.
This variable tells wrapper scripts just to set shlibpath_var rather than running their programs.
Use of this source code is governed by a BSD-style license that can be found in the LICENSE file.
Some PHP constructs modify whole-process state or are not well-suited to be tested in a webserver.
This machine-generated file defines the system's error numbers, error strings, and signal numbers.
the deb would depend on libgflags2, but the static lib is the only thing installed by make install
A shell script to verify DB generated by generate_random_db.sh cannot opened and read correct data.
Checkout and build your new hhvm, then: ./test/run -l -m jit ./test/quick ./test/tools/compare-ir.sh
Many Bourne shells cannot handle close brackets correctly in scan sets, so we specify it separately.
There may be an optional sh(1) argument at the beginning of install_prog (especially on Windows NT).
This script runs or (given -n) prints suggested commands to generate z files for the current system.
add this line back to normal code path when https://jira.mongodb.org/browse/SERVER-19123 is resolved
if the lib is a module then we can not link against it, someone is ignoring the new warnings I added
An image for each of the node versions we want to test with that version installed and the latest npm
Like Linux, but with the current version available in verstring for coding it into the library header
An image for each of the io.js versions we want to test with that version installed and the latest npm
This is a shared library Warn about portability, can't link against -module's on some systems (darwin)
report.txt provides a high level statistics This should be run from the parent of the tools directory.
Create a libtool object file (analogous to a ".la" file), but don't create it if we're doing a dry run.
This script generates Java structures that contain the offsets of fields in various ELF ABI structures.
WAL can be either disabled or enabled depending on the input parameter (1 for disabled, 0 for enabled).
Notes on test sequence: step 1) Setup database via sequential fill followed by overwrite to fragment it.
The syscall package provides access to the raw system call interface of the underlying operating system.
If clang_format_diff.py command is not specfied, we assume we are able to access directly without any path.
cdb-0.75 lacks support for installing header files and creating a  library which programs can link against.
Find all interdependent deplibs by searching for libraries that are linked more than once (e.g. -la -lb -la)
It'll download the relevant parts of "node-inspector" used by "nuclide-debugger-node", and its dependencies.
TODO: We use xcodebuild because xctool would stall when collecting info about the tests before running them.
Test 2a: sequential fill with large values to get peak ingest adjust NUM_KEYS given the use of larger values
- We make sure to still print things for the removed lines, to keep line numbers consistent to ease debugging.
Remove our outputs, but don't remove object files since they may have been created when compiling PIC objects.
Do a symbolic link so that the libtool archive can be found in LD_LIBRARY_PATH before the program is installed.
The TAGs below are defined such that we never get into a situation in which we disable both kinds of libraries.
Change the cli shebang to point at the specified node Useful for when the program is moved around after install.
If we put the line we're generating into this file, then the linter will think the generator itself is generated.
Lock this critical section if it is needed We use this script file to make the link, it avoids creating a new file
This may have to be revisited, in case too many convenience libraries get linked in and end up exceeding the spec.
A shell script to load some pre generated data file to a DB using ldb tool ./ldb needs to be avaible to be executed.
This will make the sha appear to change constantly, but without any insight into file state, it's the safest fallback
To select a specific SDK, run 'xcodebuild -showsdks' to see the available SDKs and replace iphoneos with one of them.
https://github.com/mdcallag/leveldb-1 http://smalldatum.blogspot.com/2015/04/comparing-leveldb-and-rocksdb-take-2.html
If the library was installed with an old release of libtool, it will not redefine variables installed, or shouldnotlink
The PATH hackery in wrapper scripts is required on Windows and Darwin in order for the loader to find any dlls it needs.
We prevent these files from being run in server mode by creating .noserver files if they contain one of the bad symbols.
FG_MBWRITEPERSEC - write rate limit in MB/second for tests like overwrite where stats are reported for the write threads.
Just print a warning and add the library to dependency_libs so that the program can be linked against the static library.
We also need to preload any dependent libraries so libltdl's deplib preloader doesn't bomb out in the load deplibs phase.
See this helpful document on writing portable shell scripts: http://www.gnu.org/s/hello/manual/autoconf/Portable-Shell.html
Were list-of-threads specified as "1 2 4" then the tests in steps 2, 3 and 4 above would be repeated for 1, 2 and 4 threads.
The native IRIX linker understands -LANG:*, -LIST:* and -LNO:* so, if we see these flags be careful not to treat them like -L
This source code is licensed under the BSD-style license found in the LICENSE file in the root directory of this source tree.
Unknown arguments in both finalize_command and compile_command need to be aesthetically quoted because they are evaled later.
arg 1 is the working directory to cd to arg 2 is the hhvm binary arg 3 is "-c" arg 4 is the ini file arg 5 is the test to run
move library search paths that coincide with paths to not yet installed libraries to the beginning of the library search list
We need to manually fork and exec (as opposed to using proc_open) because we have to close the listening socket before we exec.
Sadly it is an enum without introspection, so instead make it macros so we can control its shape on re-requires of the .hpp file
This fallback is for the cmake build, which won't have an FBCODE_DIR environment variable, and runs this from the runtime subdir.
Blanks in the command may have been stripped by the calling shell, but not from the CC environment variable when configure was run.
This script is supposed to be invoked as part of Xcode build process and relies on environment variables (including PWD) set by Xcode
Doing this in parallel is racy, but the absolute worst that can happen is we'll end up with some garbled text inside a .noserver file.
Getting valid data requires a number of iterations and having an ability to run the test separately from rest of the benchmarks helps.
Note that this function assumes that the benchmark executes long enough so that "Compaction Stats" is written to stdout at least once.
Some compilers have problems with a `.al' extension so convenience libraries should have the same extension an archive normally would.
If the file is missing, and there is a .exe on the end, strip it because it is most likely a libtool script we actually want to install
func_infer_tag arg Infer tagged configuration to use if any are available and if one wasn't chosen via the "--tag" command line option.
undef DEBUG if defined DEBUGWRAPPER define DEBUG(format, ...) fprintf(stderr, format, __VA_ARGS__) else define DEBUG(format, ...) endif
Given that compact benchmark doesn't output regular statistics then we'll just use the time command to measure how long this step takes.
We don't want to rely on the grammar to have a fixed start and end token, so lets parse the file and make two macros for the min and max
If you compile php using --with-cdb the internal functions will be used and no  external library is used so that this script is not necessary.
There are some bash-isms, because maintaining *two* fully-portable posix/bourne sh scripts is too much for one project with a sane maintainer.
The variables are: NKEYS         - number of key/value pairs to load NWRITESPERSEC - the writes/second rate limit for the *whilewriting* tests.
On the production build servers, set data and stat files/directories not in /tmp or else the tempdir cleaning scripts will make you very unhappy.
We used to do the same as -all-static on platforms that didn't have a PIC flag, but the assumption that the effects would be equivalent was wrong.
borrows from https://github.com/rvagg/dnt/ Simple setup function for a container: setup_container(image id, base image, commands to run to set up)
Porting Go to a new architecture/operating system combination requires some manual effort, though there are tools that automate much of the process.
This is necessary because there is no way to change the working directory in hhvm before we exec (chdir only changes a var in the execution context).
Don't allow the user to place us outside of our expected location b/c this prevents finding dependent libraries that are installed to the same prefix.
If there's no uncommitted changes, we assume user are doing post-commit format check, in which case we'll check the modified lines from latest commit.
compiling the symbol table file with pic_flag works around a FreeBSD bug that causes programs to crash when -lm is linked before any other PIC object.
TODO(kailiu) following work is not complete since we still need to figure out how to add the modified files done pre-commit hook to git's commit index.
There are really only two kinds -- those that use the current revision as the major version and those that subtract age and use age as a minor version.
convert absolute version numbers to libtool ages this retains compatibility with .la files and attempts to make the code below a bit more comprehensible
For now, we need to specify -no-undefined on the libtool link line when we can be certain that all symbols are satisfied, otherwise we get a static library.
Speed up build times by skipping the creation of the offline package for debug builds on the simulator since the packager is supposed to be running anyways.
This hand-written Go file implements system calls that need special handling and lists "//sys" comments giving prototypes for ones that can be auto-generated.
Since it's a grep and append that *might* actually be safe (whether the extra lines show up might not affect the output) but someone should look at this again.
Also used by the default 'make install' in node to point npm at the newly installed node, rather than the first one in the PATH, which would be the default otherwise.
If you find it suitable, feel free to include anywhere: the very same logic as in the original examples/scripts, a little more transparent implementation to my taste.
we should really use a build-platform specific compiler here, but OTOH, the wrappers (shell script and this C one) are only useful if you want to execute the "real" binary.
Run tests inside each of the versioned containers, copy cwd into npm's copy of node-gyp so it'll be invoked by npm when a compile is needed run_tests(version, test-commands)
There are currently 15 tests in those steps and they are repeated for each entry in list-of-threads so this variable lets you control the total duration to finish the benchmark.
It must work everywhere, including on systems that lack a /bin/bash, map 'sh' to ksh, ksh97, bash, ash, or zsh, and potentially have either a posix shell or bourne shell living at /bin/sh.
If we have whole_archive_flag_spec, we want to use save_libobjs as it was before whole_archive_flag_spec was expanded, because we can't assume the linker understands whole_archive_flag_spec.
NKEYS         - number of key/value pairs to load BG_MBWRITEPERSEC - write rate limit in MB/second for tests in which there is one thread doing writes and stats are reported for read threads.
This is particularly important on AIX, because we don't support having both static and shared libraries enabled at the same time on that platform, so we default to a shared-only configuration.
We need to change the working directory because php5 xdebug only accepts filenames relative the working directory and so line breakpoint tests would fail if not run from the root test directory.
